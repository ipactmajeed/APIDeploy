[System: 192.168.1.57] DEBUG | 06-26-2025 17:11:23.532 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:11:23.563 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:11:31.006 | General Service|:: CompanyIndex:301 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:11:31.006 | General Service|:: CompanyIndex:301 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAxLDEiLCJuYmYiOjE3NTA5MTQxMDEsImV4cCI6MTc1MDk0MjkwMSwiaWF0IjoxNzUwOTE0MTAxfQ.sjRmCR-dJmw3i8w7UyHtWzu22miacp2tJBQKXsQDLT0'''
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:12:10.068 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:12:10.068 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:12:30.963 | General Service|:: CompanyIndex:301 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.76] DEBUG | 06-26-2025 17:12:30.963 | General Service|:: CompanyIndex:301 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAxLDEiLCJuYmYiOjE3NTA5MTQxMDEsImV4cCI6MTc1MDk0MjkwMSwiaWF0IjoxNzUwOTE0MTAxfQ.sjRmCR-dJmw3i8w7UyHtWzu22miacp2tJBQKXsQDLT0'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:12:31.181 | General Service|:: CompanyIndex:301 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:12:31.181 | General Service|:: CompanyIndex:301 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAxLDEiLCJuYmYiOjE3NTA5MTQxMDEsImV4cCI6MTc1MDk0MjkwMSwiaWF0IjoxNzUwOTE0MTAxfQ.sjRmCR-dJmw3i8w7UyHtWzu22miacp2tJBQKXsQDLT0'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:12:59.490 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:12:59.490 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM3NjAwLCJleHAiOjE3NTA5NjY0MDAsImlhdCI6MTc1MDkzNzYwMH0.6h8sa0n8ox3T3l-AIEZ3YytIgC5FTyn9OWVVxslgMmQ'''
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:13:10.066 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:13:10.066 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:13:24.059 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-26-2025 17:13:24.106 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM3NjAwLCJleHAiOjE3NTA5NjY0MDAsImlhdCI6MTc1MDkzNzYwMH0.6h8sa0n8ox3T3l-AIEZ3YytIgC5FTyn9OWVVxslgMmQ'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:13:31.090 | General Service|:: CompanyIndex:301 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:13:31.105 | General Service|:: CompanyIndex:301 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAxLDEiLCJuYmYiOjE3NTA5MTQxMDEsImV4cCI6MTc1MDk0MjkwMSwiaWF0IjoxNzUwOTE0MTAxfQ.sjRmCR-dJmw3i8w7UyHtWzu22miacp2tJBQKXsQDLT0'''
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:14:10.057 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:14:10.057 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:14:31.006 | General Service|:: CompanyIndex:301 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:14:31.006 | General Service|:: CompanyIndex:301 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAxLDEiLCJuYmYiOjE3NTA5MTQxMDEsImV4cCI6MTc1MDk0MjkwMSwiaWF0IjoxNzUwOTE0MTAxfQ.sjRmCR-dJmw3i8w7UyHtWzu22miacp2tJBQKXsQDLT0'''
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:14:49.534 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''47584b14-02d9-4ce8-b393-b9649bb4515c''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.57] DEBUG | 06-26-2025 17:14:49.534 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:14:59.253 | General Service|:: CompanyIndex:68 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.57] DEBUG | 06-26-2025 17:14:59.878 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:15:11.216 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:15:11.216 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:15:31.010 | General Service|:: CompanyIndex:301 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:15:31.026 | General Service|:: CompanyIndex:301 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAxLDEiLCJuYmYiOjE3NTA5MTQxMDEsImV4cCI6MTc1MDk0MjkwMSwiaWF0IjoxNzUwOTE0MTAxfQ.sjRmCR-dJmw3i8w7UyHtWzu22miacp2tJBQKXsQDLT0'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:15:35.389 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:15:35.405 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM3NjAwLCJleHAiOjE3NTA5NjY0MDAsImlhdCI6MTc1MDkzNzYwMH0.6h8sa0n8ox3T3l-AIEZ3YytIgC5FTyn9OWVVxslgMmQ'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:15:35.546 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:15:35.546 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM3NjAwLCJleHAiOjE3NTA5NjY0MDAsImlhdCI6MTc1MDkzNzYwMH0.6h8sa0n8ox3T3l-AIEZ3YytIgC5FTyn9OWVVxslgMmQ'''
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:16:10.057 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:16:10.057 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:22.658 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:22.783 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:25.832 | General Service|:: CompanyIndex:7 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'25.9.8'
 ,0
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:25.957 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,7
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:25.988 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,7
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:26.003 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:26.003 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:26.066 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''763fb2a0-fd58-4b42-9a41-ba77d2f8e754''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.56'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,7,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:26.066 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:26.206 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:26.206 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:27.948 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:27.948 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:28.245 | General Service|:: CompanyIndex:7 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:28.245 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:28.517 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:28.533 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:28.548 | General Service|:: CompanyIndex:7 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:28.548 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:28.564 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:28.580 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:28.626 | General Service|:: CompanyIndex:7 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:28.642 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:28.751 | General Service|:: CompanyIndex:7 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:28.751 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:28.908 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:28.908 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:28.970 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:28.970 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:29.001 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''26 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:29.001 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:29.017 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:29.017 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:29.158 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:29.158 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:29.439 | General Service|:: CompanyIndex:7 SpName: spADM_GetDashBoard 
 1
 ,39
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:29.454 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:29.564 | General Service|:: CompanyIndex:7 SpName: spCOM_GetFavorites 
 'VIEW'
 ,25495
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:29.564 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:16:31.017 | General Service|:: CompanyIndex:301 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:16:31.017 | General Service|:: CompanyIndex:301 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAxLDEiLCJuYmYiOjE3NTA5MTQxMDEsImV4cCI6MTc1MDk0MjkwMSwiaWF0IjoxNzUwOTE0MTAxfQ.sjRmCR-dJmw3i8w7UyHtWzu22miacp2tJBQKXsQDLT0'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:32.361 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterGridViewList 
 49
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:32.361 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:32.424 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 500041
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'26-Jun-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:32.424 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:34.258 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterQuickViewDefn 
 49
 ,'104'
 ,49
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:34.258 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:34.445 | General Service|:: CompanyIndex:7 SpName: spADM_BulkEditDetails 
 6
 ,104
 ,0
 ,''
 ,''
 ,''
 ,''
 ,'admin'
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:34.445 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:34.461 | General Service|:: CompanyIndex:7 SpName: spADM_BulkEditDetails 
 2
 ,0
 ,2
 ,''
 ,''
 ,''
 ,''
 ,'admin'
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:34.477 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:34.492 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=90871'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:34.492 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:34.508 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReport 
 0
 ,90871
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:34.508 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:34.539 | General Service|:: CompanyIndex:7 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,90871
 ,2
 ,4
 ,'View~98cab7ee-e70b-42d5-b339-b5ed4057d2e2'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:34.539 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:34.758 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:34.758 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:34.820 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReportFields 
 2
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:34.820 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:34.851 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReportFields 
 110
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:34.851 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:34.898 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterGridViewList 
 2
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:34.898 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:34.976 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 126
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'26-Jun-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:34.992 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:35.039 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterGridViewList 
 50002
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:35.039 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:35.055 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 60
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'26-Jun-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:35.070 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:35.148 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 126
 ,1000
 ,1000
 ,''
 ,''
 ,''
 ,1995
 ,'26-Jun-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:35.164 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:35.226 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 126
 ,2000
 ,1000
 ,''
 ,''
 ,''
 ,3995
 ,'26-Jun-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:35.226 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:37.290 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT T0.AccountCode [Cf665c288a864411cb105e83cadc1c28e],T0.AccountID AS [Cf665c288a864411cb105e83cadc1c28e_ID],T0.AccountName [Ccfb5cce170c1490caf71a7a05df316c6],T1.AccountType [C8688bd8c5c0d40959cd37ce7849160dd],T2.UserName [C50eb98dd8d4b4c21b1951b3aefd3d51e],T3.Status [C3d3a4b438be34b90aa3245136d8d8f20]
 FROM ACC_Accounts T0 with(nolock) left join ACC_AccountTypes T1 with(nolock) on T0.AccountTypeID=T1.AccountTypeID left join ADM_Users T2 with(nolock) on T0.CreatedBy=T2.Username left join COM_Status T3 with(nolock) on T0.StatusID=T3.StatusID
 WHERE T3.Status=''Unapproved'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:16:37.306 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:17:10.052 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:17:10.068 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:30.869 | General Service|:: CompanyIndex:301 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:30.869 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''84b96e39-62cf-4c37-9b63-0709a4a79698''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:30.885 | General Service|:: CompanyIndex:301 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAxLDEiLCJuYmYiOjE3NTA5MTQxMDEsImV4cCI6MTc1MDk0MjkwMSwiaWF0IjoxNzUwOTE0MTAxfQ.sjRmCR-dJmw3i8w7UyHtWzu22miacp2tJBQKXsQDLT0'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:30.885 | General Service|:: CompanyIndex:301 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAxLDEiLCJuYmYiOjE3NTA5MTQxMDEsImV4cCI6MTc1MDk0MjkwMSwiaWF0IjoxNzUwOTE0MTAxfQ.sjRmCR-dJmw3i8w7UyHtWzu22miacp2tJBQKXsQDLT0'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:31.244 | General Service|:: CompanyIndex:301 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:31.244 | General Service|:: CompanyIndex:301 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAxLDEiLCJuYmYiOjE3NTA5MTQxMDEsImV4cCI6MTc1MDk0MjkwMSwiaWF0IjoxNzUwOTE0MTAxfQ.sjRmCR-dJmw3i8w7UyHtWzu22miacp2tJBQKXsQDLT0'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:40.297 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:40.359 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.76'
 ,'192.168.1.76'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:42.813 | General Service|:: CompanyIndex:1 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'25.9.3'
 ,0
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:42.844 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,1
 ,'192.168.1.76'
 ,'192.168.1.76'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:42.860 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:42.875 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:42.875 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:42.875 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:17:42.875 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:17:42.875 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:17:42.875 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:42.922 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''fd213a63-6ea4-415e-966b-7df14cc02dd6''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.76'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,1,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:42.922 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:42.922 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:17:42.922 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:17:42.922 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:17:42.922 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:42.985 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:43.000 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:43.000 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:17:43.000 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:17:43.000 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:17:43.000 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:43.047 | General Service|:: CompanyIndex:1 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:43.063 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:43.063 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:17:43.063 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:17:43.063 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:17:43.063 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:44.429 | General Service|:: CompanyIndex:1 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:44.429 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:44.429 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:17:44.429 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:17:44.429 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:17:44.429 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:44.679 | General Service|:: CompanyIndex:1 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:44.679 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:44.679 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:17:44.679 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:17:44.679 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:17:44.679 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:44.726 | General Service|:: CompanyIndex:1 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:44.726 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:44.726 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:17:44.726 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:17:44.726 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:17:44.726 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:44.757 | General Service|:: CompanyIndex:1 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:44.757 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:44.757 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:17:44.757 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:17:44.757 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:17:44.757 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:44.976 | General Service|:: CompanyIndex:1 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:44.976 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:44.976 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:17:44.976 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:17:44.976 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:17:44.976 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:45.054 | General Service|:: CompanyIndex:1 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:45.054 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:45.054 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:17:45.054 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:17:45.054 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:17:45.054 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:45.148 | General Service|:: CompanyIndex:1 SpName: spCOM_GetFavorites 
 'GETLIST1'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:45.148 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:45.148 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:17:45.148 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:17:45.148 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:17:45.148 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:45.210 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:45.226 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:45.226 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:17:45.226 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:17:45.226 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:17:45.226 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:45.273 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
 message=Invalid object name 'PAY_PayrollPreferences'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:45.273 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:17:45.273 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:17:45.273 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:17:45.273 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1|Invalid object name 'PAY_PayrollPreferences'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:45.273 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:45.273 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:17:45.273 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:17:45.273 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:17:45.273 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:45.460 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''26 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:45.460 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:45.460 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:17:45.460 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:17:45.460 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:17:45.460 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:45.788 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:45.788 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:45.788 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:17:45.788 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:17:45.788 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:17:45.788 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:45.820 | General Service|:: CompanyIndex:1 SpName: spCOM_GetFavorites 
 'GETLIST1'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:45.835 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:45.835 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:17:45.835 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:17:45.835 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:17:45.835 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:45.866 | General Service|:: CompanyIndex:1 SpName: spCOM_GetFavorites 
 'VIEW'
 ,1
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:45.866 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:17:45.866 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:17:45.866 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:17:45.866 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:17:45.866 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.57] DEBUG | 06-26-2025 17:18:10.061 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:18:10.076 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:18:45.955 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:18:45.955 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:18:45.955 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:18:45.955 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:18:45.955 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:18:45.955 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.57] DEBUG | 06-26-2025 17:19:10.065 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:19:10.065 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:19:46.053 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:19:46.069 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:19:46.069 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:19:46.069 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:19:46.069 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:19:46.069 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.57] DEBUG | 06-26-2025 17:19:58.319 | General Service|:: CompanyIndex:68 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.57] DEBUG | 06-26-2025 17:19:58.319 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:20:10.052 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:20:10.067 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:20:45.937 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:20:45.937 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:20:45.937 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:20:45.937 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:20:45.937 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:20:45.937 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.57] DEBUG | 06-26-2025 17:21:10.052 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:21:10.067 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:12.614 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:12.614 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Mzg1LCJleHAiOjE3NTA5NjcxODUsImlhdCI6MTc1MDkzODM4NX0.gez8cuZWYevLdzas4WIiyDTswfBZU_8yYtE1raB63Eo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:15.427 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:15.520 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:17.884 | General Service|:: CompanyIndex:7 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'25.9.8'
 ,0
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:17.994 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,7
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:18.009 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,7
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:18.025 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:18.025 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:18.056 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''79e09c20-2265-4aa4-8672-8820ecad9e4c''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.56'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,7,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:18.072 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:18.103 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:18.103 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:19.946 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:19.962 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:20.228 | General Service|:: CompanyIndex:7 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:20.228 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:20.480 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:20.496 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:20.511 | General Service|:: CompanyIndex:7 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:20.511 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:20.543 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:20.543 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:20.605 | General Service|:: CompanyIndex:7 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:20.621 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:20.746 | General Service|:: CompanyIndex:7 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:20.746 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:20.902 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:20.902 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:20.949 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:20.949 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:20.996 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''26 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:20.996 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:21.011 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:21.011 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:21.136 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:21.136 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:21.449 | General Service|:: CompanyIndex:7 SpName: spADM_GetDashBoard 
 1
 ,39
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:21.449 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:21.558 | General Service|:: CompanyIndex:7 SpName: spCOM_GetFavorites 
 'VIEW'
 ,25495
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:21.558 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:24.530 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterGridViewList 
 49
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:24.530 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:24.562 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 500041
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'26-Jun-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:24.577 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:25.936 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterQuickViewDefn 
 49
 ,'104'
 ,49
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:25.936 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:26.233 | General Service|:: CompanyIndex:7 SpName: spADM_BulkEditDetails 
 6
 ,104
 ,0
 ,''
 ,''
 ,''
 ,''
 ,'admin'
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:26.249 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:26.264 | General Service|:: CompanyIndex:7 SpName: spADM_BulkEditDetails 
 2
 ,0
 ,2
 ,''
 ,''
 ,''
 ,''
 ,'admin'
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:26.280 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:26.296 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=90871'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:26.311 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:26.327 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReport 
 0
 ,90871
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:26.342 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:26.389 | General Service|:: CompanyIndex:7 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,90871
 ,2
 ,4
 ,'View~98cab7ee-e70b-42d5-b339-b5ed4057d2e2'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:26.846 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:26.970 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:26.970 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:27.033 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReportFields 
 2
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:27.033 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:27.064 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReportFields 
 110
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:27.064 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:27.095 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterGridViewList 
 2
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:27.095 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:27.189 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 126
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'26-Jun-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:27.189 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:27.252 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterGridViewList 
 50002
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:27.267 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:27.283 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 60
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'26-Jun-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:27.298 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:27.377 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 126
 ,1000
 ,1000
 ,''
 ,''
 ,''
 ,1995
 ,'26-Jun-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:27.392 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:27.470 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 126
 ,2000
 ,1000
 ,''
 ,''
 ,''
 ,3995
 ,'26-Jun-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:27.470 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:29.780 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT T0.AccountCode [Cf665c288a864411cb105e83cadc1c28e],T0.AccountID AS [Cf665c288a864411cb105e83cadc1c28e_ID],T0.AccountName [Ccfb5cce170c1490caf71a7a05df316c6],T1.AccountType [C8688bd8c5c0d40959cd37ce7849160dd],T2.UserName [C50eb98dd8d4b4c21b1951b3aefd3d51e],T3.Status [C3d3a4b438be34b90aa3245136d8d8f20]
 FROM ACC_Accounts T0 with(nolock) left join ACC_AccountTypes T1 with(nolock) on T0.AccountTypeID=T1.AccountTypeID left join ADM_Users T2 with(nolock) on T0.CreatedBy=T2.Username left join COM_Status T3 with(nolock) on T0.StatusID=T3.StatusID
 WHERE T3.Status=''Unapproved'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:21:29.780 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:21:45.923 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:21:45.923 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:21:45.923 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:21:45.923 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:21:45.923 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:21:45.923 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.57] DEBUG | 06-26-2025 17:22:10.055 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:22:10.055 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:22:21.224 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:22:21.224 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:22:43.922 | General Service|:: CompanyIndex:1 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.76] DEBUG | 06-26-2025 17:22:43.922 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:22:43.922 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:22:43.922 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:22:43.922 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:22:43.922 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:22:45.937 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:22:45.937 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:22:45.937 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:22:45.937 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:22:45.937 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:22:45.937 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.57] DEBUG | 06-26-2025 17:23:10.061 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:23:10.061 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:23:21.133 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:23:21.149 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4Njc3LCJleHAiOjE3NTA5Njc0NzcsImlhdCI6MTc1MDkzODY3N30.F5UxLoCUnE2jYcKgL96UWLgmglALJORbh56fU17jHrI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:40.666 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:40.713 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:23:45.935 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:23:45.935 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:23:45.935 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:23:45.935 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:23:45.935 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:23:45.935 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:46.435 | General Service|:: CompanyIndex:53 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'25.9.9'
 ,0
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:46.498 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,53
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:46.513 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,53
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:46.529 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:46.545 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:46.576 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''53b83e61-3eca-495a-b86f-394a9af1f25c''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.99'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,53,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:46.591 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:46.623 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:46.623 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:46.654 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:46.654 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:46.888 | General Service|:: CompanyIndex:53 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:46.888 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:47.123 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:47.123 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:47.154 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:47.154 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:47.216 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:47.216 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:47.279 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:47.279 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:47.294 | General Service|:: CompanyIndex:53 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:47.326 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:47.357 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:47.357 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:47.529 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:47.529 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:47.576 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:47.576 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:47.669 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''26 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:47.669 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.185 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 1
 ,41
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.185 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.216 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.216 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.216 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.216 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.232 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.232 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.232 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.232 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.232 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.232 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.232 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.232 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.247 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.247 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.247 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.247 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.247 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.247 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.247 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.247 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.247 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.263 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.263 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.263 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.263 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.263 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.263 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.263 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.263 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.263 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.279 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.279 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.279 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.279 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.294 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.294 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.294 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.294 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.310 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.310 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.310 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.325 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.325 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.325 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.341 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.341 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.341 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.357 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.357 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.357 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.451 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.466 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.638 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.638 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.685 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.685 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.716 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.716 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.716 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.732 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.732 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.747 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.747 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.747 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.747 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.747 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.763 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.763 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.763 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.778 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.778 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.778 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.794 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.794 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.810 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.810 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.841 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.841 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.841 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.857 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.857 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.857 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.872 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:48.872 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:49.091 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:49.091 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:49.122 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:49.122 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:49.122 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:49.122 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:49.138 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:49.138 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:49.138 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:49.153 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:49.169 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:49.169 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:49.185 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:49.185 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:49.247 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:23:49.247 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:23:58.819 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 06-26-2025 17:23:58.897 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:00.928 | General Service|:: CompanyIndex:7 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'25.9.8'
 ,0
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:01.022 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,7
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:01.022 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,7
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:01.037 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:01.037 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:01.084 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''4b2ec229-5bd1-4d6b-aa68-08c208d6afb9''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.56'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,7,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:01.084 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:01.147 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:01.147 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:02.891 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 6
 ,'53b83e61-3eca-495a-b86f-394a9af1f25c'
 ,''
 ,''
 ,''
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:02.907 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:02.922 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:02.922 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:03.016 | General Service|:: CompanyIndex:53 SpName: sp_SetTokenHistory 
 0
 ,'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'
 ,''
 ,NULL
 ,1
 ,1
 message=Saved Succesfully
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:03.157 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODgyNiwiZXhwIjoxNzUwOTY3NjI2LCJpYXQiOjE3NTA5Mzg4MjZ9.PIMgAKsm3juLjooZfbjBXYKFYJgvMcvUbYzRjlRHLYY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:03.219 | General Service|:: CompanyIndex:7 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:03.297 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:04.576 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:04.592 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:04.608 | General Service|:: CompanyIndex:7 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:04.608 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:04.639 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:04.639 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:04.701 | General Service|:: CompanyIndex:7 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:04.717 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:04.826 | General Service|:: CompanyIndex:7 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:04.826 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:04.967 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:04.967 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:05.029 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:05.029 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:05.076 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''26 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:05.076 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:05.092 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:05.107 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:05.233 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:05.233 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:05.529 | General Service|:: CompanyIndex:7 SpName: spADM_GetDashBoard 
 1
 ,39
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:05.529 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:05.639 | General Service|:: CompanyIndex:7 SpName: spCOM_GetFavorites 
 'VIEW'
 ,25495
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:05.654 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:08.314 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterGridViewList 
 49
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:08.314 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:08.345 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 500041
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'26-Jun-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:08.361 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:09.434 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:09.481 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:09.777 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterQuickViewDefn 
 49
 ,'104'
 ,49
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:09.777 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:09.949 | General Service|:: CompanyIndex:7 SpName: spADM_BulkEditDetails 
 6
 ,104
 ,0
 ,''
 ,''
 ,''
 ,''
 ,'admin'
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:09.949 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:09.980 | General Service|:: CompanyIndex:7 SpName: spADM_BulkEditDetails 
 2
 ,0
 ,2
 ,''
 ,''
 ,''
 ,''
 ,'admin'
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:09.980 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:09.996 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=90871'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:10.012 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:10.027 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReport 
 0
 ,90871
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:10.027 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:10.043 | General Service|:: CompanyIndex:7 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,90871
 ,2
 ,4
 ,'View~98cab7ee-e70b-42d5-b339-b5ed4057d2e2'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:10.059 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:24:10.059 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:24:10.059 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:10.168 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:10.168 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:10.340 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReportFields 
 2
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:10.340 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:10.371 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReportFields 
 110
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:10.371 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:10.418 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterGridViewList 
 2
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:10.433 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:10.527 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 126
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'26-Jun-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:10.527 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:10.590 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterGridViewList 
 50002
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:10.590 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:10.621 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 60
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'26-Jun-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:10.621 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:10.715 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 126
 ,1000
 ,1000
 ,''
 ,''
 ,''
 ,1995
 ,'26-Jun-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:10.730 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:10.793 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 126
 ,2000
 ,1000
 ,''
 ,''
 ,''
 ,3995
 ,'26-Jun-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:10.793 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:13.149 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT T0.AccountCode [Cf665c288a864411cb105e83cadc1c28e],T0.AccountID AS [Cf665c288a864411cb105e83cadc1c28e_ID],T0.AccountName [Ccfb5cce170c1490caf71a7a05df316c6],T1.AccountType [C8688bd8c5c0d40959cd37ce7849160dd],T2.UserName [C50eb98dd8d4b4c21b1951b3aefd3d51e],T3.Status [C3d3a4b438be34b90aa3245136d8d8f20]
 FROM ACC_Accounts T0 with(nolock) left join ACC_AccountTypes T1 with(nolock) on T0.AccountTypeID=T1.AccountTypeID left join ADM_Users T2 with(nolock) on T0.CreatedBy=T2.Username left join COM_Status T3 with(nolock) on T0.StatusID=T3.StatusID
 WHERE T3.Status=''Unapproved'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:24:13.149 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:18.574 | General Service|:: CompanyIndex:51 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'25.9.9'
 ,0
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:18.636 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,51
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:18.636 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,51
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:18.683 | General Service|:: CompanyIndex:51 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:18.730 | General Service|:: CompanyIndex:51 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTEsMSIsIm5iZiI6MTc1MDkzODg1OCwiZXhwIjoxNzUwOTY3NjU4LCJpYXQiOjE3NTA5Mzg4NTh9.I1SSsiamIRR0lCx1nBBQjIZDsSc6pMdGyEc3qSh_8H0'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:18.761 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''d75bd6bd-e857-4fb2-a3c2-bcf1f4434f34''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.99'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,51,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:18.761 | General Service|:: CompanyIndex:51 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTEsMSIsIm5iZiI6MTc1MDkzODg1OCwiZXhwIjoxNzUwOTY3NjU4LCJpYXQiOjE3NTA5Mzg4NTh9.I1SSsiamIRR0lCx1nBBQjIZDsSc6pMdGyEc3qSh_8H0'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:18.949 | General Service|:: CompanyIndex:51 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:18.949 | General Service|:: CompanyIndex:51 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTEsMSIsIm5iZiI6MTc1MDkzODg1OCwiZXhwIjoxNzUwOTY3NjU4LCJpYXQiOjE3NTA5Mzg4NTh9.I1SSsiamIRR0lCx1nBBQjIZDsSc6pMdGyEc3qSh_8H0'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:21.123 | General Service|:: CompanyIndex:51 SpName: spCOM_GetDivisions 
 0
 ,1
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:21.123 | General Service|:: CompanyIndex:51 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTEsMSIsIm5iZiI6MTc1MDkzODg1OCwiZXhwIjoxNzUwOTY3NjU4LCJpYXQiOjE3NTA5Mzg4NTh9.I1SSsiamIRR0lCx1nBBQjIZDsSc6pMdGyEc3qSh_8H0'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:21.389 | General Service|:: CompanyIndex:51 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:21.389 | General Service|:: CompanyIndex:51 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTEsMSIsIm5iZiI6MTc1MDkzODg1OCwiZXhwIjoxNzUwOTY3NjU4LCJpYXQiOjE3NTA5Mzg4NTh9.I1SSsiamIRR0lCx1nBBQjIZDsSc6pMdGyEc3qSh_8H0'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:24.392 | General Service|:: CompanyIndex:51 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:24.392 | General Service|:: CompanyIndex:51 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTEsMSIsIm5iZiI6MTc1MDkzODg1OCwiZXhwIjoxNzUwOTY3NjU4LCJpYXQiOjE3NTA5Mzg4NTh9.I1SSsiamIRR0lCx1nBBQjIZDsSc6pMdGyEc3qSh_8H0'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:24.564 | General Service|:: CompanyIndex:51 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:24.564 | General Service|:: CompanyIndex:51 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTEsMSIsIm5iZiI6MTc1MDkzODg1OCwiZXhwIjoxNzUwOTY3NjU4LCJpYXQiOjE3NTA5Mzg4NTh9.I1SSsiamIRR0lCx1nBBQjIZDsSc6pMdGyEc3qSh_8H0'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:24.595 | General Service|:: CompanyIndex:51 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:24.595 | General Service|:: CompanyIndex:51 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTEsMSIsIm5iZiI6MTc1MDkzODg1OCwiZXhwIjoxNzUwOTY3NjU4LCJpYXQiOjE3NTA5Mzg4NTh9.I1SSsiamIRR0lCx1nBBQjIZDsSc6pMdGyEc3qSh_8H0'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:25.892 | General Service|:: CompanyIndex:51 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:25.892 | General Service|:: CompanyIndex:51 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTEsMSIsIm5iZiI6MTc1MDkzODg1OCwiZXhwIjoxNzUwOTY3NjU4LCJpYXQiOjE3NTA5Mzg4NTh9.I1SSsiamIRR0lCx1nBBQjIZDsSc6pMdGyEc3qSh_8H0'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:25.985 | General Service|:: CompanyIndex:51 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:25.985 | General Service|:: CompanyIndex:51 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTEsMSIsIm5iZiI6MTc1MDkzODg1OCwiZXhwIjoxNzUwOTY3NjU4LCJpYXQiOjE3NTA5Mzg4NTh9.I1SSsiamIRR0lCx1nBBQjIZDsSc6pMdGyEc3qSh_8H0'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:26.485 | General Service|:: CompanyIndex:51 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:26.668 | General Service|:: CompanyIndex:51 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTEsMSIsIm5iZiI6MTc1MDkzODg1OCwiZXhwIjoxNzUwOTY3NjU4LCJpYXQiOjE3NTA5Mzg4NTh9.I1SSsiamIRR0lCx1nBBQjIZDsSc6pMdGyEc3qSh_8H0'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:26.746 | General Service|:: CompanyIndex:51 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:26.746 | General Service|:: CompanyIndex:51 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTEsMSIsIm5iZiI6MTc1MDkzODg1OCwiZXhwIjoxNzUwOTY3NjU4LCJpYXQiOjE3NTA5Mzg4NTh9.I1SSsiamIRR0lCx1nBBQjIZDsSc6pMdGyEc3qSh_8H0'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:28.781 | General Service|:: CompanyIndex:51 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''26 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:28.796 | General Service|:: CompanyIndex:51 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTEsMSIsIm5iZiI6MTc1MDkzODg1OCwiZXhwIjoxNzUwOTY3NjU4LCJpYXQiOjE3NTA5Mzg4NTh9.I1SSsiamIRR0lCx1nBBQjIZDsSc6pMdGyEc3qSh_8H0'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:29.140 | General Service|:: CompanyIndex:51 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
 message=Could not find stored procedure 'fnGet_GetAssignedDims'.
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:29.140 | General Service|:: CompanyIndex:51 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 06-26-2025 17:24:29.140 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 06-26-2025 17:24:29.140 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 06-26-2025 17:24:29.140 | General Service|:: CompanyIndex:51 SpName: spADM_GetDataSetParameters :
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1|Could not find stored procedure 'fnGet_GetAssignedDims'.
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:29.155 | General Service|:: CompanyIndex:51 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTEsMSIsIm5iZiI6MTc1MDkzODg1OCwiZXhwIjoxNzUwOTY3NjU4LCJpYXQiOjE3NTA5Mzg4NTh9.I1SSsiamIRR0lCx1nBBQjIZDsSc6pMdGyEc3qSh_8H0'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:33.171 | General Service|:: CompanyIndex:51 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:33.171 | General Service|:: CompanyIndex:51 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTEsMSIsIm5iZiI6MTc1MDkzODg1OCwiZXhwIjoxNzUwOTY3NjU4LCJpYXQiOjE3NTA5Mzg4NTh9.I1SSsiamIRR0lCx1nBBQjIZDsSc6pMdGyEc3qSh_8H0'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:34.615 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 6
 ,'d75bd6bd-e857-4fb2-a3c2-bcf1f4434f34'
 ,''
 ,''
 ,''
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:34.615 | General Service|:: CompanyIndex:51 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTEsMSIsIm5iZiI6MTc1MDkzODg1OCwiZXhwIjoxNzUwOTY3NjU4LCJpYXQiOjE3NTA5Mzg4NTh9.I1SSsiamIRR0lCx1nBBQjIZDsSc6pMdGyEc3qSh_8H0'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:35.465 | General Service|:: CompanyIndex:51 SpName: sp_SetTokenHistory 
 0
 ,'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTEsMSIsIm5iZiI6MTc1MDkzODg1OCwiZXhwIjoxNzUwOTY3NjU4LCJpYXQiOjE3NTA5Mzg4NTh9.I1SSsiamIRR0lCx1nBBQjIZDsSc6pMdGyEc3qSh_8H0'
 ,''
 ,NULL
 ,1
 ,1
 message=Saved Succesfully
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:35.559 | General Service|:: CompanyIndex:51 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTEsMSIsIm5iZiI6MTc1MDkzODg1OCwiZXhwIjoxNzUwOTY3NjU4LCJpYXQiOjE3NTA5Mzg4NTh9.I1SSsiamIRR0lCx1nBBQjIZDsSc6pMdGyEc3qSh_8H0'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:39.831 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:39.878 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:44.653 | General Service|:: CompanyIndex:53 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'25.9.9'
 ,0
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:44.715 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,53
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:44.731 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,53
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:44.731 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:44.747 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:44.778 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''179a50f6-55a2-47cf-828b-63044b7a9003''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.99'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,53,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:44.778 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:44.794 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:44.809 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:44.825 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:44.825 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.028 | General Service|:: CompanyIndex:53 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.028 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.231 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.231 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.247 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.247 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.278 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.278 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.325 | General Service|:: CompanyIndex:53 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.325 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.325 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.340 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.418 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.418 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.528 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.528 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.575 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.575 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.590 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''26 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.590 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.793 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.793 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.965 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 1
 ,41
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:24:45.965 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.965 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:24:45.965 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:24:45.965 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:24:45.965 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:24:45.965 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:24:45.965 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.996 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.996 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.996 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:45.996 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.012 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.012 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.012 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.012 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.012 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.012 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.012 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.012 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.012 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.028 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.028 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.028 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.028 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.028 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.028 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.028 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.028 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.028 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.028 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.028 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.043 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.043 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.043 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.043 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.043 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.043 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.059 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.059 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.059 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.059 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.074 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.074 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.090 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.090 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.090 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.090 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.106 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.106 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.106 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.121 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.121 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.121 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.137 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.137 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.231 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.231 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.371 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.387 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.419 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.419 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.435 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.450 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.450 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.450 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.466 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.481 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.481 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.481 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.481 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.481 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.497 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.497 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.497 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.497 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.513 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.513 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.513 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.513 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.544 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.544 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.575 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.575 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.575 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.575 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.575 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.591 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.606 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.606 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.622 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.622 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.638 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.638 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.763 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.778 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.810 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.810 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.841 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.856 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.872 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.872 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.888 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.888 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.950 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:24:46.966 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:24:58.312 | General Service|:: CompanyIndex:68 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.57] DEBUG | 06-26-2025 17:24:58.328 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:25:10.075 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:25:10.075 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:25:25.859 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:25:25.875 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:25:40.618 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 6
 ,'179a50f6-55a2-47cf-828b-63044b7a9003'
 ,''
 ,''
 ,''
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 06-26-2025 17:25:40.618 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:25:40.649 | General Service|:: CompanyIndex:53 SpName: sp_SetTokenHistory 
 0
 ,'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'
 ,''
 ,NULL
 ,1
 ,1
 message=Saved Succesfully
[System: 192.168.1.99] DEBUG | 06-26-2025 17:25:40.649 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzODg4NCwiZXhwIjoxNzUwOTY3Njg0LCJpYXQiOjE3NTA5Mzg4ODR9.Dv2xxqO7c-VKbhWNhfIVnPykEQYwRmUYAOuBedy1tlI'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:25:46.943 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:25:46.943 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:25:46.943 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:25:46.943 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:25:46.943 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:25:46.943 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.57] DEBUG | 06-26-2025 17:26:10.062 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:26:10.062 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:26:47.939 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:26:47.955 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:26:47.955 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:26:47.955 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:26:47.955 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:26:47.955 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.57] DEBUG | 06-26-2025 17:27:10.064 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:27:10.064 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:27:43.912 | General Service|:: CompanyIndex:1 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.76] DEBUG | 06-26-2025 17:27:43.928 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:27:43.928 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:27:43.928 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:27:43.928 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:27:43.928 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:27:48.940 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:27:48.956 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:27:48.956 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:27:48.956 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:27:48.956 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:27:48.956 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.57] DEBUG | 06-26-2025 17:28:10.070 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:28:10.070 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:35.567 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:35.567 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM4ODQwLCJleHAiOjE3NTA5Njc2NDAsImlhdCI6MTc1MDkzODg0MH0.5j-02cg7vWg12s-ZhH9uIEMl6H7k8P_VmKL3_a-oolw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:39.519 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:39.706 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:42.565 | General Service|:: CompanyIndex:7 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'25.9.8'
 ,0
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:42.659 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,7
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:42.675 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,7
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:42.675 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:42.675 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:42.722 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''467637bf-90c4-4061-8187-cf3b41843353''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.56'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,7,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:42.722 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:42.784 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:42.784 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:45.424 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:45.440 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:45.721 | General Service|:: CompanyIndex:7 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:45.721 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:45.987 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:45.987 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:46.002 | General Service|:: CompanyIndex:7 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:46.002 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:46.049 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:46.049 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:46.112 | General Service|:: CompanyIndex:7 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:46.112 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:46.237 | General Service|:: CompanyIndex:7 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:46.237 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:46.393 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:46.643 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:46.705 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:46.721 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:46.752 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''26 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:46.752 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:46.768 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:46.768 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:46.909 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:46.909 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:47.174 | General Service|:: CompanyIndex:7 SpName: spADM_GetDashBoard 
 1
 ,39
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:47.174 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:47.284 | General Service|:: CompanyIndex:7 SpName: spCOM_GetFavorites 
 'VIEW'
 ,25495
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:47.284 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:28:49.973 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:28:49.973 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:28:49.973 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:28:49.973 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:28:49.973 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:28:49.973 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:52.739 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterGridViewList 
 49
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:52.739 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:52.771 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 500041
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'26-Jun-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:52.771 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:54.961 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterQuickViewDefn 
 49
 ,'104'
 ,49
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:54.961 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:55.685 | General Service|:: CompanyIndex:7 SpName: spADM_BulkEditDetails 
 6
 ,104
 ,0
 ,''
 ,''
 ,''
 ,''
 ,'admin'
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:55.700 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:55.716 | General Service|:: CompanyIndex:7 SpName: spADM_BulkEditDetails 
 2
 ,0
 ,2
 ,''
 ,''
 ,''
 ,''
 ,'admin'
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:55.732 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:55.763 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=90871'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:55.763 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:55.794 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReport 
 0
 ,90871
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:55.794 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:55.810 | General Service|:: CompanyIndex:7 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,90871
 ,2
 ,4
 ,'View~98cab7ee-e70b-42d5-b339-b5ed4057d2e2'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:55.825 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:55.935 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:55.950 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:56.013 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReportFields 
 2
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:56.013 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:56.044 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReportFields 
 110
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:56.044 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:56.091 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterGridViewList 
 2
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:56.091 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:56.185 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 126
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'26-Jun-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:56.200 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:56.247 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterGridViewList 
 50002
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:56.263 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:56.294 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 60
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'26-Jun-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:56.294 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:56.388 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 126
 ,1000
 ,1000
 ,''
 ,''
 ,''
 ,1995
 ,'26-Jun-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:56.388 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:56.466 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 126
 ,2000
 ,1000
 ,''
 ,''
 ,''
 ,3995
 ,'26-Jun-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:56.466 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:59.701 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT T0.AccountCode [Cf665c288a864411cb105e83cadc1c28e],T0.AccountID AS [Cf665c288a864411cb105e83cadc1c28e_ID],T0.AccountName [Ccfb5cce170c1490caf71a7a05df316c6],T1.AccountType [C8688bd8c5c0d40959cd37ce7849160dd],T2.UserName [C50eb98dd8d4b4c21b1951b3aefd3d51e],T3.Status [C3d3a4b438be34b90aa3245136d8d8f20]
 FROM ACC_Accounts T0 with(nolock) left join ACC_AccountTypes T1 with(nolock) on T0.AccountTypeID=T1.AccountTypeID left join ADM_Users T2 with(nolock) on T0.CreatedBy=T2.Username left join COM_Status T3 with(nolock) on T0.StatusID=T3.StatusID
 WHERE T3.Status=''Unapproved'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:28:59.701 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:29:10.064 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:29:10.064 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:29:12.452 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT T0.AccountCode [Cf665c288a864411cb105e83cadc1c28e],T0.AccountID AS [Cf665c288a864411cb105e83cadc1c28e_ID],T0.AccountName [Ccfb5cce170c1490caf71a7a05df316c6],T1.AccountType [C8688bd8c5c0d40959cd37ce7849160dd],T2.UserName [C50eb98dd8d4b4c21b1951b3aefd3d51e],T3.Status [C3d3a4b438be34b90aa3245136d8d8f20]
 FROM ACC_Accounts T0 with(nolock) left join ACC_AccountTypes T1 with(nolock) on T0.AccountTypeID=T1.AccountTypeID left join ADM_Users T2 with(nolock) on T0.CreatedBy=T2.Username left join COM_Status T3 with(nolock) on T0.StatusID=T3.StatusID
 WHERE T3.Status=''Unapproved'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:29:12.468 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:29:49.508 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''47584b14-02d9-4ce8-b393-b9649bb4515c''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.57] DEBUG | 06-26-2025 17:29:49.508 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:29:50.961 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:29:50.961 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:29:50.961 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:29:50.961 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:29:50.961 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:29:50.961 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.57] DEBUG | 06-26-2025 17:29:58.330 | General Service|:: CompanyIndex:68 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.57] DEBUG | 06-26-2025 17:29:58.330 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:30:10.070 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:30:10.070 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:30:51.951 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:30:51.951 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:30:51.951 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:30:51.951 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:30:51.951 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:30:51.951 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.57] DEBUG | 06-26-2025 17:31:10.077 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:31:10.093 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:13.060 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:13.060 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MTIyLCJleHAiOjE3NTA5Njc5MjIsImlhdCI6MTc1MDkzOTEyMn0.qmtr6mlYFeDg3hKDjuALV_CqV_Y4V03iJD5IxToQLwk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:17.552 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:17.645 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:20.350 | General Service|:: CompanyIndex:7 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'25.9.8'
 ,0
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:20.475 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,7
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:20.490 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,7
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:20.506 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:20.506 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:20.615 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''0c505e21-6cf5-4982-b1e3-83dc1343a31b''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.56'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,7,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:20.615 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:20.662 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:20.662 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:24.692 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:24.692 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:24.957 | General Service|:: CompanyIndex:7 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:24.957 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:25.239 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:25.239 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:25.254 | General Service|:: CompanyIndex:7 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:25.254 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:25.286 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:25.286 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:25.348 | General Service|:: CompanyIndex:7 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:25.348 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:25.457 | General Service|:: CompanyIndex:7 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:25.473 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:25.614 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:25.614 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:25.676 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:25.676 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:25.707 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''26 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:25.723 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:25.739 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:25.739 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:25.864 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:25.864 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:26.176 | General Service|:: CompanyIndex:7 SpName: spADM_GetDashBoard 
 1
 ,39
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:26.176 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:26.285 | General Service|:: CompanyIndex:7 SpName: spCOM_GetFavorites 
 'VIEW'
 ,25495
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:31:26.285 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:31:52.950 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:31:52.965 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:31:52.965 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:31:52.965 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:31:52.965 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:31:52.965 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.57] DEBUG | 06-26-2025 17:32:10.065 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:32:10.081 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:32:31.681 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:32:31.681 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:37.272 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:37.319 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:42.779 | General Service|:: CompanyIndex:53 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'25.9.9'
 ,0
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:42.857 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,53
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:42.873 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,53
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:42.888 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:42.888 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:42.920 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''43b26db4-d67e-46a7-af43-8086619f4846''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.99'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,53,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:42.920 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:42.951 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:42.951 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:42.966 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:42.982 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:43.185 | General Service|:: CompanyIndex:53 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:43.185 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:43.368 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:43.383 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:43.383 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:43.383 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:43.399 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:43.399 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:43.430 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:43.430 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:43.430 | General Service|:: CompanyIndex:53 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:43.430 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:43.508 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:43.508 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:43.618 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:43.618 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:43.664 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:43.680 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:43.696 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''26 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:43.711 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:43.758 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:43.774 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:32:43.949 | General Service|:: CompanyIndex:1 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.76] DEBUG | 06-26-2025 17:32:43.965 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:32:43.965 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:32:43.965 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:32:43.965 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:32:43.965 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:32:43.965 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''fd213a63-6ea4-415e-966b-7df14cc02dd6''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.76] DEBUG | 06-26-2025 17:32:43.980 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:32:43.980 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:32:43.980 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:32:43.980 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:32:43.980 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.090 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 1
 ,41
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.090 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.121 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.121 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.121 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.121 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.121 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.121 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.121 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.121 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.121 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.137 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.137 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.137 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.137 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.137 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.152 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.152 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.152 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.152 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.152 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.152 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.152 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.152 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.152 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.152 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.152 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.152 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.152 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.152 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.168 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.168 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.168 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.183 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.183 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.183 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.199 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.199 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.199 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.199 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.215 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.215 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.215 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.230 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.230 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.230 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.246 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.246 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.246 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.246 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.355 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.355 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.527 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.527 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.574 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.574 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.590 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.590 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.605 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.605 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.621 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.621 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.621 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.621 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.637 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.637 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.637 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.652 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.652 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.652 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.652 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.668 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.668 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.684 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.684 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.699 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.715 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.715 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.715 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.730 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.730 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.730 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.746 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.746 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.762 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.762 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.762 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.762 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.777 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.793 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.809 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.809 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.918 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.918 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.980 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:44.980 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:45.199 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:45.215 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:45.277 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:32:45.293 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTM2MiwiZXhwIjoxNzUwOTY4MTYyLCJpYXQiOjE3NTA5MzkzNjJ9.nR_4zXjTDS2Zw_0HSDyzkW1_6nH_gHFPDKqwhf8Y-zg'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:32:53.945 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:32:53.961 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:32:53.961 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:32:53.961 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:32:53.961 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:32:53.961 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.57] DEBUG | 06-26-2025 17:33:10.071 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:33:10.071 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:33:25.869 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:33:25.869 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:31.170 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:31.217 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.55'
 ,'192.168.1.55'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:33:41.597 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterGridViewList 
 49
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:33:41.612 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:33:41.737 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 500041
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'26-Jun-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:33:41.737 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:44.832 | General Service|:: CompanyIndex:42 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'25.9.9'
 ,0
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:44.863 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,42
 ,'192.168.1.55'
 ,'192.168.1.55'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:44.879 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,42
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:44.941 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:44.957 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:45.004 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''d08662f0-94ca-4f04-892f-d5aa2b3dea2d''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.55'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,42,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:45.004 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:45.191 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:45.191 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:45.238 | General Service|:: CompanyIndex:42 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:45.254 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:46.425 | General Service|:: CompanyIndex:42 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:46.425 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:46.660 | General Service|:: CompanyIndex:42 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:46.675 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:46.785 | General Service|:: CompanyIndex:42 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:46.785 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:46.816 | General Service|:: CompanyIndex:42 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:46.816 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:47.153 | General Service|:: CompanyIndex:42 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:47.153 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:47.574 | General Service|:: CompanyIndex:42 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:47.590 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:47.684 | General Service|:: CompanyIndex:42 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:47.684 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:48.387 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:48.387 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:48.449 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:48.449 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:49.090 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''26 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:49.090 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:49.606 | General Service|:: CompanyIndex:42 SpName: spADM_GetDashBoard 
 1
 ,6
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:49.606 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:49.699 | General Service|:: CompanyIndex:42 SpName: spRPT_GetReport 
 0
 ,20437
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:49.715 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:49.715 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:49.715 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:49.731 | General Service|:: CompanyIndex:42 SpName: spRPT_GetReport 
 0
 ,10348
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:49.731 | General Service|:: CompanyIndex:42 SpName: spRPT_GetReport 
 0
 ,10430
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:49.746 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:49.746 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:49.746 | General Service|:: CompanyIndex:42 SpName: spRPT_GetReport 
 0
 ,10431
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:49.746 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:49.840 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=10430'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:49.856 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:52.324 | General Service|:: CompanyIndex:42 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:52.324 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:52.449 | General Service|:: CompanyIndex:42 SpName: spRPT_GetReportFields 
 400
 ,0
 ,'1'
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:52.449 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:52.511 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=20437'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:52.511 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:52.527 | General Service|:: CompanyIndex:42 SpName: spRPT_GetReportFields 
 2
 ,0
 ,'1'
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:52.542 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:52.574 | General Service|:: CompanyIndex:42 SpName: spRPT_GetReportFields 
 110
 ,0
 ,'1'
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:52.574 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:52.605 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'USE PACT2C SELECT DBIndex,Name FROM ADM_Company WITH(NOLOCK) WHERE DBIndex<> 42  ORDER BY Name'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:52.605 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:52.652 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'SELECT AF.FEATUREID FEATUREID,CL.ResourceData NAME FROM ADM_FEATURES AF WITH(NOLOCK),COM_LANGUAGERESOURCES CL WITH(NOLOCK) WHERE AF.RESOURCEID=CL.RESOURCEID AND  AF.FEATUREID>50000 and AF.ISEnabled=1 AND CL.LANGUAGEID=1'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:52.652 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:52.683 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'SELECT CurrencyID,Name,ExchangeRate FROM COM_Currency WITH(NOLOCK)'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:52.699 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:52.730 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'SELECT AccountID FROM ADM_FinancialYears WITH(NOLOCK) 
WHERE FromDate<convert(float,convert(datetime,''04 Jun 2015'')) group by AccountID'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:52.730 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:52.745 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'SELECT convert(datetime,max(ToDate)) CloseDate FROM ADM_FinancialYears with(nolock) where InvClose=1 and ToDate<convert(int,convert(datetime,''04/Jun/2015''))'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:52.745 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:52.761 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

SELECT Count(Property) NoOfProperty,Count(UnitType) UnitType,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

--GROUP BY Property,UnitType'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:52.761 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:53.120 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'DECLARE @From FLOAT,@To FLOAT
SET @From=CONVERT(FLOAT,CONVERT(DATETIME,''04 Jun 2015''))
SET @To=CONVERT(FLOAT,CONVERT(DATETIME,''26 Jun 2025''))
DECLARE @YrStart FLOAT
SET @YrStart=CONVERT(FLOAT,CONVERT(DATETIME,''01 Jan 2015''))
        SELECT A1.AccountCode,A1.AccountName,OP_Dr,OP_Cr,TR_Dr,TR_Cr,A1.AccountID,PeriodOpDr,PeriodOpCr,A1.IsGroup,A1.lft,A1.rgt,A1.AccountTypeID,A1.Depth,A1.ParentID,A1.TB_INT IsSummary
FROM (
SELECT AccountID,SUM(OP_Dr) OP_Dr,SUM(OP_Cr) OP_Cr,SUM(TR_Dr) TR_Dr,SUM(TR_Cr) TR_Cr,SUM(PeriodOpDr) PeriodOpDr,SUM(PeriodOpCr) PeriodOpCr
FROM(
SELECT T1.AccountID,VoucherNo,CASE WHEN SUM(OP_Dr)-SUM(OP_Cr)>0 THEN SUM(OP_Dr)-SUM(OP_Cr) ELSE 0 END OP_Dr,
CASE WHEN SUM(OP_Dr)-SUM(OP_Cr)<0 THEN SUM(OP_Cr)-SUM(OP_Dr) ELSE 0 END OP_Cr,
CASE WHEN SUM(TR_Dr)-SUM(TR_Cr)>0 THEN SUM(TR_Dr)-SUM(TR_Cr) ELSE 0 END TR_Dr,
CASE WHEN SUM(TR_Dr)-SUM(TR_Cr)<0 THEN SUM(TR_Cr)-SUM(TR_Dr) ELSE 0 END TR_Cr,CASE WHEN SUM(PeriodOpDr)-SUM(PeriodOpCr)>0 THEN SUM(PeriodOpDr)-SUM(PeriodOpCr) ELSE 0 END PeriodOpDr,
CASE WHEN SUM(PeriodOpDr)-SUM(PeriodOpCr)<0 THEN SUM(PeriodOpCr)-SUM(PeriodOpDr) ELSE 0 END PeriodOpCr
FROM (
--Opening Dr
SELECT DebitAccount AccountID,VoucherNo,sum(ACC.Amount) OP_Dr,0 OP_Cr,0 TR_Dr,0 TR_Cr,sum(case when ACC.DocDate>=@YrStart and ACC.DocDate<@From then ACC.Amount else 0 end) PeriodOpDr,0 PeriodOpCr
FROM ACC_DocDetails ACC WITH(NOLOCK)
WHERE ((ACC.DocumentType=16 AND (ACC.StatusID=369 or ACC.StatusID=429)) OR (DocDate<@From AND ((ACC.StatusID=370 OR ACC.StatusID=439 OR ACC.StatusID=452) OR (ACC.DocumentType!=14 AND ACC.DocumentType!=19 AND (ACC.StatusID=369 or ACC.StatusID=429)))))
group by DebitAccount,VoucherNo
UNION ALL--Opening Cr
SELECT CreditAccount AccountID,VoucherNo,0 OP_Dr,sum(ACC.Amount) OP_Cr,0 TR_Dr, 0 TR_Cr,0,sum(case when ACC.DocDate>=@YrStart and ACC.DocDate<@From then ACC.Amount else 0 end)
FROM ACC_DocDetails ACC WITH(NOLOCK)
WHERE ((ACC.DocumentType=16 AND (ACC.StatusID=369 or ACC.StatusID=429)) OR (DocDate<@From AND ((ACC.StatusID=370 OR ACC.StatusID=439 OR ACC.StatusID=452) OR (ACC.DocumentType!=14 AND ACC.DocumentType!=19 AND (ACC.StatusID=369 or ACC.StatusID=429)))))
group by CreditAccount,VoucherNo
UNION ALL--Transaction Dr
SELECT DebitAccount AccountID,VoucherNo,0 OP_Dr,0 OP_Cr,sum(Amount) TR_Dr,0 TR_Cr,0.0,0.0
FROM ACC_DocDetails ACC WITH(NOLOCK)
WHERE (DocDate BETWEEN @From AND @To) AND ACC.DocumentType!=16 AND ((ACC.StatusID=370 OR ACC.StatusID=439 OR ACC.StatusID=452) OR (ACC.DocumentType!=14 AND ACC.DocumentType!=19 AND (ACC.StatusID=369 or ACC.StatusID=429)))
group by DebitAccount,VoucherNo
UNION ALL--Transaction Cr
SELECT CreditAccount AccountID,VoucherNo,0 OP_Dr,0 OP_Cr,0 TR_Dr,sum(Amount) TR_Cr,0.0,0.0
FROM ACC_DocDetails ACC  WITH(NOLOCK)
WHERE (DocDate BETWEEN @From AND @To) AND ACC.DocumentType!=16 AND ((ACC.StatusID=370 OR ACC.StatusID=439 OR ACC.StatusID=452) OR (ACC.DocumentType!=14 AND ACC.DocumentType!=19 AND (ACC.StatusID=369 or ACC.StatusID=429))) 
group by CreditAccount,VoucherNo
) AS T1  GROUP BY T1.AccountID,VoucherNo
) AS T2 GROUP BY AccountID
) AS ACC RIGHT JOIN ACC_Accounts A1 WITH(NOLOCK) ON A1.AccountID=ACC.AccountID
,(select T.AccountID GTID from ACC_Accounts T with(nolock),ACC_Accounts GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.AccountID IN (45423,45414,45415,45438,45446) group by T.AccountID) AS GTP 
WHERE A1.AccountID>1 AND A1.AccountID=GTP.GTID AND A1.IsGroup=0 Order By A1.AccountName select AccountID,AccountCode,AccountName,AccountTypeID,TB_INT TB,lft,Depth,ParentID from acc_accounts with(nolock) where IsGroup=1 Order By Depth'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:53.120 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:53.136 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=10431'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:53.136 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:33:53.167 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterQuickViewDefn 
 49
 ,'104'
 ,49
 ,1
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:53.167 | General Service|:: CompanyIndex:42 SpName: spRPT_GetReportFields 
 400
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:33:53.167 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:53.167 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:53.198 | General Service|:: CompanyIndex:42 SpName: spRPT_GetReportFields 
 95
 ,0
 ,'1'
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:53.198 | General Service|:: CompanyIndex:42 SpName: spRPT_OpenCompanyData 
 4
 ,'01/Jan/2015'
 ,'26/Jun/2025'
 ,0
 ,''
 ,True
 ,''
 ,True
 ,True
 ,''
 ,0
 ,0
 ,0
 ,'1'
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:53.198 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:53.214 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:53.245 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=10348'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:53.245 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:53.261 | General Service|:: CompanyIndex:42 SpName: spRPT_GetReportFields 
 400
 ,0
 ,'1'
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:53.277 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:53.308 | General Service|:: CompanyIndex:42 SpName: spRPT_GetReportFields 
 40001
 ,0
 ,'1'
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:53.308 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:53.339 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'SELECT AccountID FROM ADM_FinancialYears WITH(NOLOCK) 
WHERE FromDate<convert(float,convert(datetime,''01 Jan 2025'')) group by AccountID'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:53.355 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:53.402 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'SELECT A1.AccountID,A1.AccountTypeID,A1.AccountName FROM ACC_Accounts A1 with(nolock),(select T.AccountID GTID from ACC_Accounts T with(nolock),ACC_Accounts GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.AccountID IN (45447,35399,33502,33500) group by T.AccountID) AS GTP  WHERE A1.IsGroup=0 and A1.AccountID>1  AND A1.AccountID=GTP.GTID AND A1.AccountID IN (SELECT CreditAccount FROM ACC_DocDetails AS Cr with(nolock) UNION SELECT DebitAccount FROM ACC_DocDetails AS Dr with(nolock)) Order By A1.AccountName'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:53.402 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:53.605 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1),UnitID BIGINT,Building NVARCHAR(500),UnitNo NVARCHAR(500),UnitType NVARCHAR(500),UnitArea NVARCHAR(400),UnitRate FLOAT,CurrentRent FLOAT,EstimatedRent FLOAT,Status NVARCHAR(10),unitstatus nvarchar(100)
,NoofDays INT,VacantSince DATETIME)

INSERT INTO @TAB (UnitID,Building,UnitNo,UnitType,UnitArea,UnitRate,EstimatedRent,unitstatus)
SELECT RU.UnitID,RP.NAME Building,RU.NAME UnitNo,C18.NAME UnitType,
RU.RentableArea UnitArea,
RU.RentPerSQFT UnitRate,
RU.AnnualRent EstimatedRent,
RU.UnitStatus
FROM REN_Units RU WITH(NOLOCK) 
LEFT JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
left join COM_Lookup LK with(nolock) on RU.UnitStatus=lk.NodeID
WHERE RU.UnitID>1 AND RP.Name <> RU.Name AND RU.IsGroup=0 AND RU.Status=424  and ru.UnitStatus=306 

SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=CONTRACTID,@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,''26 Jun 2025'') ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,''26 Jun 2025'') ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,''26 Jun 2025'') ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE UNITID=@UnitID ORDER BY StartDate DESC
	
	SELECT @TotalAmount=SUM(RentAmount) FROM REN_ContractParticulars WITH(NOLOCK) WHERE ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM dbo.REN_Quotation WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,''26 Jun 2025'') BETWEEN CONVERT(DATETIME,DATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince WHERE ID=@I
	END

	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM dbo.REN_Quotation WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,''26 Jun 2025'') BETWEEN CONVERT(DATETIME,DATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince WHERE ID=@I
	END
	
	set @I=@I+1
	
END

SELECT * FROM @TAB WHERE Status=''Vacant'' OR Status=''Reserved''
'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:53.620 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:53.901 | General Service|:: CompanyIndex:42 SpName: spRPT_GLSummary 
 ''
 ,'145988,145983,145984,145991,145998,145980,146014,146015,145995,145996,145904,145867,145981,145993,145990,145892,145992,145989,145849,145903,145999,146000,146001'
 ,'01/Jan/2025 12:00:00 AM'
 ,'01/Jan/2025 12:00:00 AM'
 ,'26/Jun/2025 12:00:00 AM'
 ,''
 ,True
 ,False
 ,True
 ,50009
 ,'COM_CC50009'
 ,False
 ,''
 ,1
 ,0
 ,0
 ,',T1.Name AS [Cb71df0ec3e8d4b88a5bf053435639129]'
 ,' LEFT JOIN COM_CC50034 AS T1 with(nolock) ON T1.NodeID=DCC.dcCCNID34'
 ,',Cb71df0ec3e8d4b88a5bf053435639129'
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:33:53.901 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:33:54.058 | General Service|:: CompanyIndex:7 SpName: spADM_BulkEditDetails 
 6
 ,104
 ,0
 ,''
 ,''
 ,''
 ,''
 ,'admin'
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:33:54.073 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:33:54.104 | General Service|:: CompanyIndex:7 SpName: spADM_BulkEditDetails 
 2
 ,0
 ,2
 ,''
 ,''
 ,''
 ,''
 ,'admin'
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:33:54.120 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:33:54.954 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:33:54.970 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:33:54.970 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:33:54.970 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:33:54.970 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:33:54.970 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.56] DEBUG | 06-26-2025 17:33:56.298 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=90871'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:33:56.298 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:33:56.329 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReport 
 0
 ,90871
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:33:56.329 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:33:56.360 | General Service|:: CompanyIndex:7 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,90871
 ,2
 ,4
 ,'View~98cab7ee-e70b-42d5-b339-b5ed4057d2e2'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:33:56.360 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:33:57.657 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:33:57.657 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:33:58.679 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReportFields 
 2
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:33:58.695 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:33:59.039 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReportFields 
 110
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:33:59.039 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:33:59.750 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterGridViewList 
 2
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:33:59.750 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:34:00.440 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 126
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'26-Jun-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:34:00.440 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:34:02.932 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterGridViewList 
 50002
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:34:02.932 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:34:03.046 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 60
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'26-Jun-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:34:03.061 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:34:03.171 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 126
 ,1000
 ,1000
 ,''
 ,''
 ,''
 ,1995
 ,'26-Jun-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:34:03.171 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:34:03.327 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 126
 ,2000
 ,1000
 ,''
 ,''
 ,''
 ,3995
 ,'26-Jun-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:34:03.327 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:08.586 | General Service|:: CompanyIndex:42 SpName: spADM_GetDashBoard 
 1
 ,4
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:08.586 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:08.883 | General Service|:: CompanyIndex:42 SpName: spRPT_GetReport 
 0
 ,50466
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:08.899 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:34:09.383 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT T0.AccountCode [Cf665c288a864411cb105e83cadc1c28e],T0.AccountID AS [Cf665c288a864411cb105e83cadc1c28e_ID],T0.AccountName [Ccfb5cce170c1490caf71a7a05df316c6],T1.AccountType [C8688bd8c5c0d40959cd37ce7849160dd],T2.UserName [C50eb98dd8d4b4c21b1951b3aefd3d51e],T3.Status [C3d3a4b438be34b90aa3245136d8d8f20]
 FROM ACC_Accounts T0 with(nolock) left join ACC_AccountTypes T1 with(nolock) on T0.AccountTypeID=T1.AccountTypeID left join ADM_Users T2 with(nolock) on T0.CreatedBy=T2.Username left join COM_Status T3 with(nolock) on T0.StatusID=T3.StatusID
 WHERE T3.Status=''Unapproved'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:34:09.383 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:09.820 | General Service|:: CompanyIndex:42 SpName: spADM_Widgets 
 1
 ,8
 ,''
 ,0
 ,1
 ,False
 ,NULL
 ,NULL
 ,'admin'
 ,'1'
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:09.820 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:09.851 | General Service|:: CompanyIndex:42 SpName: spADM_Widgets 
 1
 ,7
 ,''
 ,0
 ,1
 ,False
 ,NULL
 ,NULL
 ,'admin'
 ,'1'
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:09.851 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:09.867 | General Service|:: CompanyIndex:42 SpName: spADM_Widgets 
 1
 ,1000
 ,''
 ,0
 ,1
 ,False
 ,NULL
 ,NULL
 ,'admin'
 ,'1'
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:09.867 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:09.867 | General Service|:: CompanyIndex:42 SpName: spADM_Widgets 
 1
 ,3
 ,''
 ,0
 ,1
 ,False
 ,NULL
 ,NULL
 ,'admin'
 ,'1'
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:09.883 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:09.883 | General Service|:: CompanyIndex:42 SpName: spADM_Widgets 
 1
 ,4
 ,''
 ,0
 ,1
 ,False
 ,NULL
 ,NULL
 ,'admin'
 ,'1'
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:09.898 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:09.898 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=50466'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:09.914 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:09.914 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'declare @Fr float,@To float,@EMPID bigint set @Fr=convert(float,convert(datetime,''26 Jun 2025'')) set @To=@Fr set @EMPID=0
select sum(Dr)-sum(Cr) Balance from(
select sum(Amount) Dr,0 Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.DebitAccount=A.AccountID join ACC_Accounts GT on A.lft BETWEEN GT.lft AND GT.rgt
where GT.AccountID=33500 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429)
union all
select 0 Dr,sum(Amount) Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.CreditAccount=A.AccountID join ACC_Accounts GT on A.lft BETWEEN GT.lft AND GT.rgt
where GT.AccountID=33500 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429))AS T'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:09.914 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:09.930 | General Service|:: CompanyIndex:42 SpName: spRPT_GetReportFields 
 400
 ,0
 ,'1'
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:09.945 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'declare @Fr float,@To float,@EMPID bigint set @Fr=convert(float,convert(datetime,''26 Jun 2025'')) set @To=@Fr set @EMPID=0
select sum(Dr)-sum(Cr) Balance from(
select sum(Amount) Dr,0 Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.DebitAccount=A.AccountID join ACC_Accounts GT on A.lft BETWEEN GT.lft AND GT.rgt
where GT.AccountID=35059 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429)
union all
select 0 Dr,sum(Amount) Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.CreditAccount=A.AccountID join ACC_Accounts GT on A.lft BETWEEN GT.lft AND GT.rgt
where GT.AccountID=35059 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429))AS T'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:09.945 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:09.945 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:09.945 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'declare @Fr float,@To float,@EMPID bigint set @Fr=convert(float,convert(datetime,''26 Jun 2025'')) set @To=@Fr set @EMPID=0
select sum(Dr)-sum(Cr) Balance from(
select sum(Amount) Dr,0 Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.DebitAccount=A.AccountID
where A.AccountID IN (145747,145972) and D.DocDate<=@To AND D.DocumentType NOT IN (14,19) AND (D.StatusID=369 or D.StatusID=429)
union all
select 0 Dr,sum(Amount) Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.CreditAccount=A.AccountID
where A.AccountID IN (145747,145972) and D.DocDate<=@To AND D.DocumentType NOT IN (14,19) AND (D.StatusID=369 or D.StatusID=429))AS T'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:09.961 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:09.977 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'declare @Fr float,@To float,@EMPID bigint set @Fr=convert(float,convert(datetime,''26 Jun 2025'')) set @To=@Fr set @EMPID=0
select sum(Dr)-sum(Cr) Balance from(
select sum(Amount) Dr,0 Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.DebitAccount=A.AccountID
where A.AccountID=145810 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429)
union all
select 0 Dr,sum(Amount) Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.CreditAccount=A.AccountID
where A.AccountID=145810 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429))AS T'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:09.977 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.039 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'declare @Fr float,@To float,@EMPID bigint set @Fr=0 set @To=convert(float,convert(datetime,''26 Jun 2025'')) set @EMPID=0
select sum(Dr)-sum(Cr) Balance from(
select sum(Amount) Dr,0 Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.DebitAccount=A.AccountID
where A.AccountID IN (145747,145972) and D.DocDate<=@To AND D.DocumentType NOT IN (14,19) AND (D.StatusID=369 or D.StatusID=429)
union all
select 0 Dr,sum(Amount) Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.CreditAccount=A.AccountID
where A.AccountID IN (145747,145972) and D.DocDate<=@To AND D.DocumentType NOT IN (14,19) AND (D.StatusID=369 or D.StatusID=429))AS T'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.039 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.039 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'declare @Fr float,@To float,@EMPID bigint set @Fr=convert(float,convert(datetime,''01 Jul 2025'')) set @To=convert(float,convert(datetime,''26 Jun 2025'')) set @EMPID=0
select sum(Dr)-sum(Cr) Balance from(
select sum(Amount) Dr,0 Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.DebitAccount=A.AccountID
where A.AccountID IN (145747,145972) and D.DocDate<=@To AND D.DocumentType NOT IN (14,19) AND (D.StatusID=369 or D.StatusID=429)
union all
select 0 Dr,sum(Amount) Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.CreditAccount=A.AccountID
where A.AccountID IN (145747,145972) and D.DocDate<=@To AND D.DocumentType NOT IN (14,19) AND (D.StatusID=369 or D.StatusID=429))AS T'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.039 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.055 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'declare @Fr float,@To float,@EMPID bigint set @Fr=convert(float,convert(datetime,''26 Jun 2025'')) set @To=@Fr set @EMPID=0
select sum(Dr)-sum(Cr) Balance from(
select sum(Amount) Dr,0 Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.DebitAccount=A.AccountID
where A.AccountID=145973 and D.DocDate<=@To AND D.DocumentType NOT IN (14,19) AND (D.StatusID=369 or D.StatusID=429)
union all
select 0 Dr,sum(Amount) Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.CreditAccount=A.AccountID
where A.AccountID=145973 and D.DocDate<=@To AND D.DocumentType NOT IN (14,19) AND (D.StatusID=369 or D.StatusID=429))AS T'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.055 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.070 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'declare @Fr float,@To float,@EMPID bigint set @Fr=convert(float,convert(datetime,''01 Jan 2025'')) set @To=convert(float,convert(datetime,''26 Jun 2025'')) set @EMPID=0
select sum(Dr)-sum(Cr) Balance from(
select sum(Amount) Dr,0 Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.DebitAccount=A.AccountID
where A.AccountID IN (145747,145972) and D.DocDate<=@To AND D.DocumentType NOT IN (14,19) AND (D.StatusID=369 or D.StatusID=429)
union all
select 0 Dr,sum(Amount) Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.CreditAccount=A.AccountID
where A.AccountID IN (145747,145972) and D.DocDate<=@To AND D.DocumentType NOT IN (14,19) AND (D.StatusID=369 or D.StatusID=429))AS T'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.070 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'declare @Fr float,@To float,@EMPID bigint set @Fr=convert(float,convert(datetime,''01 Jun 2025'')) set @To=convert(float,convert(datetime,''26 Jun 2025'')) set @EMPID=0
select sum(Dr)-sum(Cr) Balance from(
select sum(Amount) Dr,0 Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.DebitAccount=A.AccountID
where A.AccountID IN (145747,145972) and D.DocDate<=@To AND D.DocumentType NOT IN (14,19) AND (D.StatusID=369 or D.StatusID=429)
union all
select 0 Dr,sum(Amount) Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.CreditAccount=A.AccountID
where A.AccountID IN (145747,145972) and D.DocDate<=@To AND D.DocumentType NOT IN (14,19) AND (D.StatusID=369 or D.StatusID=429))AS T'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.070 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.070 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.086 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'declare @Fr float,@To float,@EMPID bigint set @Fr=convert(float,convert(datetime,''01 Jul 2025'')) set @To=convert(float,convert(datetime,''26 Jun 2025'')) set @EMPID=0
select sum(Dr)-sum(Cr) Balance from(
select sum(Amount) Dr,0 Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.DebitAccount=A.AccountID
where A.AccountID=145810 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429)
union all
select 0 Dr,sum(Amount) Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.CreditAccount=A.AccountID
where A.AccountID=145810 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429))AS T'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.102 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:34:10.102 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:34:10.117 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.117 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'declare @Fr float,@To float,@EMPID bigint set @Fr=convert(float,convert(datetime,''01 Jun 2025'')) set @To=convert(float,convert(datetime,''26 Jun 2025'')) set @EMPID=0
select sum(Dr)-sum(Cr) Balance from(
select sum(Amount) Dr,0 Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.DebitAccount=A.AccountID
where A.AccountID=145810 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429)
union all
select 0 Dr,sum(Amount) Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.CreditAccount=A.AccountID
where A.AccountID=145810 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429))AS T'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.133 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.133 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'declare @Fr float,@To float,@EMPID bigint set @Fr=0 set @To=convert(float,convert(datetime,''26 Jun 2025'')) set @EMPID=0
select sum(Dr)-sum(Cr) Balance from(
select sum(Amount) Dr,0 Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.DebitAccount=A.AccountID
where A.AccountID=145810 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429)
union all
select 0 Dr,sum(Amount) Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.CreditAccount=A.AccountID
where A.AccountID=145810 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429))AS T'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.133 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'declare @Fr float,@To float,@EMPID bigint set @Fr=convert(float,convert(datetime,''01 Jun 2025'')) set @To=convert(float,convert(datetime,''26 Jun 2025'')) set @EMPID=0
select sum(Dr)-sum(Cr) Balance from(
select sum(Amount) Dr,0 Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.DebitAccount=A.AccountID join ACC_Accounts GT on A.lft BETWEEN GT.lft AND GT.rgt
where GT.AccountID=33500 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429)
union all
select 0 Dr,sum(Amount) Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.CreditAccount=A.AccountID join ACC_Accounts GT on A.lft BETWEEN GT.lft AND GT.rgt
where GT.AccountID=33500 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429))AS T'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.133 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.133 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.148 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'declare @Fr float,@To float,@EMPID bigint set @Fr=convert(float,convert(datetime,''01 Jan 2025'')) set @To=convert(float,convert(datetime,''26 Jun 2025'')) set @EMPID=0
select sum(Dr)-sum(Cr) Balance from(
select sum(Amount) Dr,0 Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.DebitAccount=A.AccountID
where A.AccountID=145810 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429)
union all
select 0 Dr,sum(Amount) Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.CreditAccount=A.AccountID
where A.AccountID=145810 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429))AS T'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.148 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.164 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'declare @Fr float,@To float,@EMPID bigint set @Fr=0 set @To=convert(float,convert(datetime,''26 Jun 2025'')) set @EMPID=0
select sum(Dr)-sum(Cr) Balance from(
select sum(Amount) Dr,0 Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.DebitAccount=A.AccountID join ACC_Accounts GT on A.lft BETWEEN GT.lft AND GT.rgt
where GT.AccountID=33500 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429)
union all
select 0 Dr,sum(Amount) Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.CreditAccount=A.AccountID join ACC_Accounts GT on A.lft BETWEEN GT.lft AND GT.rgt
where GT.AccountID=33500 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429))AS T'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.180 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'declare @Fr float,@To float,@EMPID bigint set @Fr=convert(float,convert(datetime,''01 Jul 2025'')) set @To=convert(float,convert(datetime,''26 Jun 2025'')) set @EMPID=0
select sum(Dr)-sum(Cr) Balance from(
select sum(Amount) Dr,0 Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.DebitAccount=A.AccountID join ACC_Accounts GT on A.lft BETWEEN GT.lft AND GT.rgt
where GT.AccountID=33500 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429)
union all
select 0 Dr,sum(Amount) Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.CreditAccount=A.AccountID join ACC_Accounts GT on A.lft BETWEEN GT.lft AND GT.rgt
where GT.AccountID=33500 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429))AS T'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.180 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.180 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'declare @Fr float,@To float,@EMPID bigint set @Fr=convert(float,convert(datetime,''01 Jan 2025'')) set @To=convert(float,convert(datetime,''26 Jun 2025'')) set @EMPID=0
select sum(Dr)-sum(Cr) Balance from(
select sum(Amount) Dr,0 Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.DebitAccount=A.AccountID join ACC_Accounts GT on A.lft BETWEEN GT.lft AND GT.rgt
where GT.AccountID=33500 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429)
union all
select 0 Dr,sum(Amount) Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.CreditAccount=A.AccountID join ACC_Accounts GT on A.lft BETWEEN GT.lft AND GT.rgt
where GT.AccountID=33500 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429))AS T'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.195 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.195 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'declare @Fr float,@To float,@EMPID bigint set @Fr=0 set @To=convert(float,convert(datetime,''26 Jun 2025'')) set @EMPID=0
select sum(Dr)-sum(Cr) Balance from(
select sum(Amount) Dr,0 Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.DebitAccount=A.AccountID join ACC_Accounts GT on A.lft BETWEEN GT.lft AND GT.rgt
where GT.AccountID=35059 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429)
union all
select 0 Dr,sum(Amount) Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.CreditAccount=A.AccountID join ACC_Accounts GT on A.lft BETWEEN GT.lft AND GT.rgt
where GT.AccountID=35059 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429))AS T'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.195 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.195 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.211 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'declare @Fr float,@To float,@EMPID bigint set @Fr=0 set @To=convert(float,convert(datetime,''26 Jun 2025'')) set @EMPID=0
select sum(Dr)-sum(Cr) Balance from(
select sum(Amount) Dr,0 Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.DebitAccount=A.AccountID
where A.AccountID=145973 and D.DocDate<=@To AND D.DocumentType NOT IN (14,19) AND (D.StatusID=369 or D.StatusID=429)
union all
select 0 Dr,sum(Amount) Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.CreditAccount=A.AccountID
where A.AccountID=145973 and D.DocDate<=@To AND D.DocumentType NOT IN (14,19) AND (D.StatusID=369 or D.StatusID=429))AS T'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.211 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'declare @Fr float,@To float,@EMPID bigint set @Fr=convert(float,convert(datetime,''01 Jun 2025'')) set @To=convert(float,convert(datetime,''26 Jun 2025'')) set @EMPID=0
select sum(Dr)-sum(Cr) Balance from(
select sum(Amount) Dr,0 Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.DebitAccount=A.AccountID
where A.AccountID=145973 and D.DocDate<=@To AND D.DocumentType NOT IN (14,19) AND (D.StatusID=369 or D.StatusID=429)
union all
select 0 Dr,sum(Amount) Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.CreditAccount=A.AccountID
where A.AccountID=145973 and D.DocDate<=@To AND D.DocumentType NOT IN (14,19) AND (D.StatusID=369 or D.StatusID=429))AS T'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.211 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.211 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.226 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'declare @Fr float,@To float,@EMPID bigint set @Fr=convert(float,convert(datetime,''01 Jul 2025'')) set @To=convert(float,convert(datetime,''26 Jun 2025'')) set @EMPID=0
select sum(Dr)-sum(Cr) Balance from(
select sum(Amount) Dr,0 Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.DebitAccount=A.AccountID join ACC_Accounts GT on A.lft BETWEEN GT.lft AND GT.rgt
where GT.AccountID=35059 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429)
union all
select 0 Dr,sum(Amount) Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.CreditAccount=A.AccountID join ACC_Accounts GT on A.lft BETWEEN GT.lft AND GT.rgt
where GT.AccountID=35059 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429))AS T'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.226 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.242 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'declare @Fr float,@To float,@EMPID bigint set @Fr=convert(float,convert(datetime,''01 Jul 2025'')) set @To=convert(float,convert(datetime,''26 Jun 2025'')) set @EMPID=0
select sum(Dr)-sum(Cr) Balance from(
select sum(Amount) Dr,0 Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.DebitAccount=A.AccountID
where A.AccountID=145973 and D.DocDate<=@To AND D.DocumentType NOT IN (14,19) AND (D.StatusID=369 or D.StatusID=429)
union all
select 0 Dr,sum(Amount) Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.CreditAccount=A.AccountID
where A.AccountID=145973 and D.DocDate<=@To AND D.DocumentType NOT IN (14,19) AND (D.StatusID=369 or D.StatusID=429))AS T'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.242 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.242 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'declare @Fr float,@To float,@EMPID bigint set @Fr=convert(float,convert(datetime,''01 Jan 2025'')) set @To=convert(float,convert(datetime,''26 Jun 2025'')) set @EMPID=0
select sum(Dr)-sum(Cr) Balance from(
select sum(Amount) Dr,0 Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.DebitAccount=A.AccountID
where A.AccountID=145973 and D.DocDate<=@To AND D.DocumentType NOT IN (14,19) AND (D.StatusID=369 or D.StatusID=429)
union all
select 0 Dr,sum(Amount) Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.CreditAccount=A.AccountID
where A.AccountID=145973 and D.DocDate<=@To AND D.DocumentType NOT IN (14,19) AND (D.StatusID=369 or D.StatusID=429))AS T'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.242 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.258 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'declare @Fr float,@To float,@EMPID bigint set @Fr=convert(float,convert(datetime,''01 Jun 2025'')) set @To=convert(float,convert(datetime,''26 Jun 2025'')) set @EMPID=0
select sum(Dr)-sum(Cr) Balance from(
select sum(Amount) Dr,0 Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.DebitAccount=A.AccountID join ACC_Accounts GT on A.lft BETWEEN GT.lft AND GT.rgt
where GT.AccountID=35059 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429)
union all
select 0 Dr,sum(Amount) Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.CreditAccount=A.AccountID join ACC_Accounts GT on A.lft BETWEEN GT.lft AND GT.rgt
where GT.AccountID=35059 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429))AS T'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.258 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.258 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'declare @Fr float,@To float,@EMPID bigint set @Fr=convert(float,convert(datetime,''01 Jan 2025'')) set @To=convert(float,convert(datetime,''26 Jun 2025'')) set @EMPID=0
select sum(Dr)-sum(Cr) Balance from(
select sum(Amount) Dr,0 Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.DebitAccount=A.AccountID join ACC_Accounts GT on A.lft BETWEEN GT.lft AND GT.rgt
where GT.AccountID=35059 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429)
union all
select 0 Dr,sum(Amount) Cr from Acc_DocDetails D with(nolock)
join ACC_Accounts A with(nolock) on D.CreditAccount=A.AccountID join ACC_Accounts GT on A.lft BETWEEN GT.lft AND GT.rgt
where GT.AccountID=35059 and D.DocDate between @Fr and @To AND D.DocumentType NOT IN (16,14,19) AND (D.StatusID=369 or D.StatusID=429))AS T'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.273 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.461 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'SELECT CONVERT(DATETIME,ACC.ChequeMaturityDate) [Cacc5eceeb0804b349d302c86c82d2da2],ACC.VoucherNo [Ce68d5c20ad8d4108892b7037f2636a03],ACC.VersionNo [Ce68d5c20ad8d4108892b7037f2636a03Ver],T2.Name [C051ac1c4dc49410baec85d4eddeeaca6],T3.Name [C8acf5e711a9742fc9505ed5fd99e10fc],T4.Name [C72dc98bbcb894bf19fe0ccb5aaffe0ba],ACC.ChequeNumber [C99d4f258091143bb96ea6d4d72f514d9],ACC.Amount [Cce7fa7fcfaad4464ae455e6f7cc694f1], (SELECT ISNULL(SUM(abs(AdjAmount)),0) FROM COM_ChequeReturn CB WITH(NOLOCK) WHERE IsNewReference=0 AND ((CB.RefDocNo=ACC.VoucherNo and ACC.DocSeqNo=CB.RefDocSeqNo))) [C920d1c2d3f514745af5fb9de60856258],dbo.fnRPT_GetChequeRetunAdjustedDocNos(ACC.VoucherNo) [C12cc1a65020c4ee78a26580a74e7de65],dbo.fnRPT_GetChequeRetunAdjustedDocDate(ACC.VoucherNo) [C1455f85324644e5a8f819da53e880830],T5.Name [C6c116ba29b984843a6abe8b884d01871],T6.Name [C98094a38f5494c9492e79a00efc5cc9f],CONVERT(DATETIME,ACC.BillDate) [Cf8a7facc9f3d4fb5830e2005fdb3be6a],T7.Status [Cd0ee4f36c2724d95b04d0bc425089db3],ACC.LineNarration [C117c3aacfbbc4519a9bee952978b2e8c],ACC.BillNo [C75a200c01208445eaed7f25b52aaa164]
 FROM ACC_DocDetails ACC with(nolock) left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_CC50011 T2 with(nolock) on TDCC.dcCCNID11=T2.NodeID left join COM_CC50009 T3 with(nolock) on TDCC.dcCCNID9=T3.NodeID left join COM_CC50010 T4 with(nolock) on TDCC.dcCCNID10=T4.NodeID left join COM_CC50041 T5 with(nolock) on TDCC.dcCCNID41=T5.NodeID left join COM_CC50038 T6 with(nolock) on TDCC.dcCCNID38=T6.NodeID left join COM_Status T7 with(nolock) on ACC.StatusID=T7.StatusID
 WHERE (ACC.CostCenterID=41014) AND T7.Status LIKE ''%Bounced%'' AND CONVERT(DATETIME,ACC.DocDate) BETWEEN ''04 Jun 2015'' AND ''26 Jun 2025'' AND ACC.LinkedAccDocDetailsID is null
 UNION ALL 
SELECT CONVERT(DATETIME,ACC.ChequeMaturityDate),ACC.VoucherNo,ACC.VersionNo,T2.Name,T3.Name,T4.Name,ACC.ChequeNumber,ACC.Amount, (SELECT ISNULL(SUM(abs(AdjAmount)),0) FROM COM_ChequeReturn CB WITH(NOLOCK) WHERE IsNewReference=0 AND ((CB.RefDocNo=ACC.VoucherNo and ACC.DocSeqNo=CB.RefDocSeqNo))),dbo.fnRPT_GetChequeRetunAdjustedDocNos(ACC.VoucherNo),dbo.fnRPT_GetChequeRetunAdjustedDocDate(ACC.VoucherNo),T5.Name,T6.Name,CONVERT(DATETIME,ACC.BillDate),T7.Status,ACC.LineNarration,ACC.BillNo
 FROM ACC_DocDetails ACC with(nolock) left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_CC50011 T2 with(nolock) on TDCC.dcCCNID11=T2.NodeID left join COM_CC50009 T3 with(nolock) on TDCC.dcCCNID9=T3.NodeID left join COM_CC50010 T4 with(nolock) on TDCC.dcCCNID10=T4.NodeID left join COM_CC50041 T5 with(nolock) on TDCC.dcCCNID41=T5.NodeID left join COM_CC50038 T6 with(nolock) on TDCC.dcCCNID38=T6.NodeID left join COM_Status T7 with(nolock) on ACC.StatusID=T7.StatusID
 WHERE (ACC.CostCenterID=41034) AND T7.Status LIKE ''%Bounced%'' AND CONVERT(DATETIME,ACC.DocDate) BETWEEN ''04 Jun 2015'' AND ''26 Jun 2025'' AND ACC.LinkedAccDocDetailsID is null
 UNION ALL 
SELECT CONVERT(DATETIME,ACC.ChequeMaturityDate),ACC.VoucherNo,ACC.VersionNo,T2.Name,T3.Name,T4.Name,ACC.ChequeNumber,ACC.Amount, (SELECT ISNULL(SUM(abs(AdjAmount)),0) FROM COM_ChequeReturn CB WITH(NOLOCK) WHERE IsNewReference=0 AND ((CB.RefDocNo=ACC.VoucherNo and ACC.DocSeqNo=CB.RefDocSeqNo))),dbo.fnRPT_GetChequeRetunAdjustedDocNos(ACC.VoucherNo),dbo.fnRPT_GetChequeRetunAdjustedDocDate(ACC.VoucherNo),T5.Name,T6.Name,CONVERT(DATETIME,ACC.BillDate),T7.Status,ACC.LineNarration,ACC.BillNo
 FROM ACC_DocDetails ACC with(nolock) left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_CC50011 T2 with(nolock) on TDCC.dcCCNID11=T2.NodeID left join COM_CC50009 T3 with(nolock) on TDCC.dcCCNID9=T3.NodeID left join COM_CC50010 T4 with(nolock) on TDCC.dcCCNID10=T4.NodeID left join COM_CC50041 T5 with(nolock) on TDCC.dcCCNID41=T5.NodeID left join COM_CC50038 T6 with(nolock) on TDCC.dcCCNID38=T6.NodeID left join COM_Status T7 with(nolock) on ACC.StatusID=T7.StatusID
 WHERE (ACC.CostCenterID=40019) AND T7.Status LIKE ''%Bounced%'' AND CONVERT(DATETIME,ACC.DocDate) BETWEEN ''04 Jun 2015'' AND ''26 Jun 2025'' AND ACC.LinkedAccDocDetailsID is null'
 ,1
 ,1
[System: 192.168.1.55] DEBUG | 06-26-2025 17:34:10.461 | General Service|:: CompanyIndex:42 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNDIsMSIsIm5iZiI6MTc1MDkzOTQyNCwiZXhwIjoxNzUwOTY4MjI0LCJpYXQiOjE3NTA5Mzk0MjR9.tXU8xPrWz3kvvKEgU92CF-ff1lKTLqzZiDGlTz5jRG4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:34:18.622 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT T0.AccountCode [Cf665c288a864411cb105e83cadc1c28e],T0.AccountID AS [Cf665c288a864411cb105e83cadc1c28e_ID],T0.AccountName [Ccfb5cce170c1490caf71a7a05df316c6],T1.AccountType [C8688bd8c5c0d40959cd37ce7849160dd],T2.UserName [C50eb98dd8d4b4c21b1951b3aefd3d51e],T3.Status [C3d3a4b438be34b90aa3245136d8d8f20]
 FROM ACC_Accounts T0 with(nolock) left join ACC_AccountTypes T1 with(nolock) on T0.AccountTypeID=T1.AccountTypeID left join ADM_Users T2 with(nolock) on T0.CreatedBy=T2.Username left join COM_Status T3 with(nolock) on T0.StatusID=T3.StatusID
 WHERE T3.Status=''Unapproved'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:34:18.637 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:34:25.863 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:34:25.878 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:30.233 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:30.280 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:35.200 | General Service|:: CompanyIndex:53 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'25.9.9'
 ,0
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:35.263 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,53
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:35.278 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,53
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:35.294 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:35.294 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:35.325 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''fa38c1a5-c888-4673-8928-92479be9cf28''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.99'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,53,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:35.325 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:35.341 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:35.357 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:35.357 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:35.372 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:35.575 | General Service|:: CompanyIndex:53 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:35.575 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:35.810 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:35.810 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:35.825 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:35.825 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:35.841 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:35.856 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:35.888 | General Service|:: CompanyIndex:53 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:35.903 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:35.903 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:35.903 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:35.997 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.013 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.138 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.138 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.184 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.184 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.216 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''26 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.216 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.278 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.309 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.731 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 1
 ,41
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.731 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.747 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.747 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.762 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.762 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.762 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.762 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.762 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.762 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.762 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.778 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.778 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.778 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.778 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.778 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.778 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.778 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.778 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.778 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.778 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.778 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.794 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.794 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.794 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.794 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.794 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.794 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.794 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.794 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.809 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.809 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.809 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.809 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.825 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.825 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.841 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.841 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.841 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.841 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.856 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.856 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.856 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.872 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.872 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.872 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.888 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.888 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.888 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.888 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.997 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:36.997 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.153 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.153 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.200 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.200 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.215 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.231 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.231 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.231 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.247 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.247 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.247 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.262 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.262 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.262 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.262 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.262 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.262 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.278 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.278 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.294 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.294 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.294 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.325 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.325 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.356 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.356 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.356 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.372 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.372 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.372 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.387 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.387 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.387 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.387 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.403 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.419 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.419 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.434 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.450 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.450 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.669 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.669 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.716 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.716 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.934 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:37.950 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:38.012 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:34:38.012 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:34:55.959 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:34:55.959 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:34:55.959 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:34:55.959 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:34:55.959 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:34:55.959 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.57] DEBUG | 06-26-2025 17:34:58.320 | General Service|:: CompanyIndex:68 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.57] DEBUG | 06-26-2025 17:34:58.335 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:35:10.057 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:35:10.072 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:35:36.293 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:35:36.293 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:35:56.963 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:35:56.963 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:35:56.963 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:35:56.963 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:35:56.963 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:35:56.963 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.57] DEBUG | 06-26-2025 17:36:10.055 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:36:10.070 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:36:30.781 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:36:30.797 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-26-2025 17:36:30.953 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-26-2025 17:36:30.953 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwOTM5MjgwLCJleHAiOjE3NTA5NjgwODAsImlhdCI6MTc1MDkzOTI4MH0.jwQOrppjQbG96qGRfqz1RSHyx1NEu34J3_4emMOssvk'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:36:36.418 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:36:36.418 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:36:57.959 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:36:57.974 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:36:57.974 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:36:57.974 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:36:57.974 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:36:57.974 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.57] DEBUG | 06-26-2025 17:37:10.063 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:37:10.063 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:37:36.276 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:37:36.276 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:37:43.923 | General Service|:: CompanyIndex:1 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.76] DEBUG | 06-26-2025 17:37:43.923 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:37:43.923 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:37:43.923 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:37:43.923 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:37:43.923 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:37:58.971 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:37:58.971 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:37:58.971 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:37:58.971 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:37:58.971 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:37:58.971 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.57] DEBUG | 06-26-2025 17:38:10.055 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:38:10.055 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:38:36.261 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:38:36.277 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:38:59.977 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:38:59.977 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:38:59.977 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:38:59.977 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:38:59.977 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:38:59.977 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.57] DEBUG | 06-26-2025 17:39:10.059 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:39:10.059 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:39:35.647 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 06-26-2025 17:39:35.647 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:39:36.663 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 06-26-2025 17:39:36.663 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDkzOTQ3NSwiZXhwIjoxNzUwOTY4Mjc1LCJpYXQiOjE3NTA5Mzk0NzV9.7AuhULWaPbddylB43kkORQdeBNMNa8-VykOgfuuggz8'''
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:39:58.325 | General Service|:: CompanyIndex:68 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.57] DEBUG | 06-26-2025 17:39:58.325 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:40:00.988 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 06-26-2025 17:40:00.988 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 06-26-2025 17:40:00.988 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.76] INFO | 06-26-2025 17:40:00.988 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.76] INFO | 06-26-2025 17:40:00.988 | OnStartup: Application Starting...
[System: 192.168.1.76] ERROR | 06-26-2025 17:40:00.988 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUwOTM4NDYyLCJleHAiOjE3NTA5NjcyNjIsImlhdCI6MTc1MDkzODQ2Mn0.mVt-jCCJdpBB2PudpU2voXwYYAM1rNr8mzOkSsslt6E'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.57] DEBUG | 06-26-2025 17:40:10.068 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.57] DEBUG | 06-26-2025 17:40:10.068 | General Service|:: CompanyIndex:68 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNjgsMSIsIm5iZiI6MTc1MDkyMDI4OSwiZXhwIjoxNzUwOTQ5MDg5LCJpYXQiOjE3NTA5MjAyODl9.fPaRiabioy8K9PiESPnnicfc7K4lGmSOf5R__MKrPYA'''
 ,1
 ,1
