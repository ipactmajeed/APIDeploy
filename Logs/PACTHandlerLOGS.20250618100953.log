[System: 192.168.1.56] DEBUG | 06-18-2025 10:09:58.499 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'Admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 10:09:58.671 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'Admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:02.877 | General Service|:: CompanyIndex:175 SpName: spADM_GetClientUserDetails 
 'Admin'
 ,1
 ,'25.9.2'
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:03.049 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'Admin'
 ,175
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:03.190 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,175
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:03.206 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:03.221 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:03.253 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''6a9264c9-bb35-4095-8f0c-159e465f3236''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.56'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,175,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:03.253 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:03.409 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:03.424 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:06.003 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:06.003 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:06.206 | General Service|:: CompanyIndex:175 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:06.221 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:06.425 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:06.425 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:06.472 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:06.472 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:06.487 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:06.503 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:06.565 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:06.565 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:06.581 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:06.581 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:06.674 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:06.674 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:06.784 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:06.784 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:06.831 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:06.831 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:06.924 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''18 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:06.924 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:06.940 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:06.940 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:07.212 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:07.212 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:07.320 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:07.320 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:07.351 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'VIEW'
 ,1
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:10:07.351 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:11:31.502 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:11:31.502 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.73] ERROR | 06-18-2025 10:11:34.177 | General Service|:: CompanyIndex:0 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MDE2MTExMywiZXhwIjoxNzUwMTg5OTEzLCJpYXQiOjE3NTAxNjExMTN9.UAZ_tRuHprmqpweUl7fXBEQU3v6aWmui6YF-3G7u8Oo'''
 ,1
 ,1|Could not find stored procedure 'spADM_GetDataSet'.
[System: 192.168.1.56] DEBUG | 06-18-2025 10:12:18.398 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:12:18.398 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:13:23.291 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:13:23.291 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:21:33.017 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 10:21:33.017 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:21:33.033 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:21:33.033 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:22:07.019 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:22:07.019 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:18.750 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:18.766 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:26.871 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,26
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:26.871 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:26.902 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60634
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:26.917 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60654
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:26.917 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60642
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:26.917 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60645
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:26.917 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:26.917 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60648
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:26.917 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:26.917 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:26.917 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:26.917 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:26.933 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60479
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:26.933 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:26.933 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60639
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:26.933 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.027 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60634'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.042 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.199 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.199 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.324 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60654'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.324 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.371 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 93
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.371 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.449 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60642'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.449 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.496 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60639'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.511 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.558 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60645'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.558 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.605 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60648'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.620 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.683 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60479'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.683 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.730 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.730 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.792 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT T1.Status [C79eebe0c82e645b8b5cb15cf118fdbda],T2.Name [Cb65d125f6f8e4b2e872ecac79384e70c],T0.Code [C34128223803245bfb7e19666e9cf1fb1],T3.Name [C5abb5da777704276a594261c08a3fceb],case when T0.UnitStatus is not null and isnumeric(T0.UnitStatus)=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID=T0.UnitStatus) else '''' end [Cf07e1f52867b47ba9962da1105760d12]
 FROM REN_Units T0 with(nolock) left join COM_Status T1 with(nolock) on T0.Status=T1.StatusID left join REN_Property T2 with(nolock) on T0.PropertyID=T2.NodeID left join COM_Location T3 with(nolock) on T0.LocationID=T3.NodeID
 WHERE T3.NodeID IN (1,22,10,11,25,26,27,28,29,30,31) AND T1.Status=''In Active'' ORDER BY [C79eebe0c82e645b8b5cb15cf118fdbda] '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.792 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.855 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.855 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.902 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.902 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE
select * ,convert(decimal(18,2), (convert(float,Vacant)/convert(float,NoOfUnits))) *100 [Vacant%]
from (

SELECT Property,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0 AND RU.Status=424 
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

GROUP BY Property
) a order by Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.902 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.902 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.917 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 

'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.917 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.917 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424  AND RU.ContractID=0 AND RU.IsGroup=0 
AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:27.933 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:37.995 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60643
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:38.011 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:38.042 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60643
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:38.042 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:38.245 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID,SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied''
Group By Property,Property_ID
Order By Property'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:24:38.245 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:25:04.138 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''6a9264c9-bb35-4095-8f0c-159e465f3236''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 10:25:04.154 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:25:06.114 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 10:25:06.114 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:25:07.286 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:25:07.286 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.76] ERROR | 06-18-2025 10:31:14.535 | General Service|:: CompanyIndex:0 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwMTU5NzkyLCJleHAiOjE3NTAxODg1OTIsImlhdCI6MTc1MDE1OTc5Mn0.jwS_tsjwArfE3xkqh89aGJJNugpDhDKyTW9VrN1IjYY'''
 ,1
 ,1|Could not find stored procedure 'spADM_GetDataSet'.
[System: 192.168.1.76] ERROR | 06-18-2025 10:32:15.520 | General Service|:: CompanyIndex:0 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwMTU5NzkyLCJleHAiOjE3NTAxODg1OTIsImlhdCI6MTc1MDE1OTc5Mn0.jwS_tsjwArfE3xkqh89aGJJNugpDhDKyTW9VrN1IjYY'''
 ,1
 ,1|Could not find stored procedure 'spADM_GetDataSet'.
[System: 192.168.1.76] ERROR | 06-18-2025 10:33:16.507 | General Service|:: CompanyIndex:0 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwMTU5NzkyLCJleHAiOjE3NTAxODg1OTIsImlhdCI6MTc1MDE1OTc5Mn0.jwS_tsjwArfE3xkqh89aGJJNugpDhDKyTW9VrN1IjYY'''
 ,1
 ,1|Could not find stored procedure 'spADM_GetDataSet'.
[System: 192.168.1.56] DEBUG | 06-18-2025 10:33:38.842 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 10:33:38.842 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:33:38.995 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:33:38.995 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.015 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,26
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.031 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.062 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60634
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.062 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60642
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.062 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60654
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.062 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60645
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.062 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.062 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.077 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60648
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.077 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.077 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.077 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60639
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.077 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.077 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.077 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60479
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.077 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.187 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60634'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.202 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.265 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60654'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.265 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.296 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 93
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.296 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.359 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60642'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.374 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.390 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.390 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.421 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60639'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.421 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.484 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60645'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.499 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.499 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT T1.Status [C79eebe0c82e645b8b5cb15cf118fdbda],T2.Name [Cb65d125f6f8e4b2e872ecac79384e70c],T0.Code [C34128223803245bfb7e19666e9cf1fb1],T3.Name [C5abb5da777704276a594261c08a3fceb],case when T0.UnitStatus is not null and isnumeric(T0.UnitStatus)=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID=T0.UnitStatus) else '''' end [Cf07e1f52867b47ba9962da1105760d12]
 FROM REN_Units T0 with(nolock) left join COM_Status T1 with(nolock) on T0.Status=T1.StatusID left join REN_Property T2 with(nolock) on T0.PropertyID=T2.NodeID left join COM_Location T3 with(nolock) on T0.LocationID=T3.NodeID
 WHERE T3.NodeID IN (1,22,10,11,25,26,27,28,29,30,31) AND T1.Status=''In Active'' ORDER BY [C79eebe0c82e645b8b5cb15cf118fdbda] '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.499 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.593 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.593 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60648'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.593 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.593 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.656 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60479'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.671 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.718 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424  AND RU.ContractID=0 AND RU.IsGroup=0 
AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.718 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.749 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.749 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.780 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 

'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.796 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.796 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE
select * ,convert(decimal(18,2), (convert(float,Vacant)/convert(float,NoOfUnits))) *100 [Vacant%]
from (

SELECT Property,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0 AND RU.Status=424 
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

GROUP BY Property
) a order by Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:02.796 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:07.161 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:34:07.161 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.76] ERROR | 06-18-2025 10:34:17.517 | General Service|:: CompanyIndex:0 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwMTU5NzkyLCJleHAiOjE3NTAxODg1OTIsImlhdCI6MTc1MDE1OTc5Mn0.jwS_tsjwArfE3xkqh89aGJJNugpDhDKyTW9VrN1IjYY'''
 ,1
 ,1|Could not find stored procedure 'spADM_GetDataSet'.
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:06.619 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:06.619 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:07.009 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:07.025 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.371 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,26
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.371 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.464 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60634
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.480 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60642
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.480 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60648
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.480 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60654
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.480 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.480 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.480 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.480 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.480 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60645
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.480 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.480 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60639
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.480 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60479
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.495 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.495 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.574 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60634'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.589 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.636 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60654'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.652 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.683 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 93
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.683 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.761 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60642'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.761 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.777 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.777 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.808 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60639'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.823 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.917 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60645'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.917 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT T1.Status [C79eebe0c82e645b8b5cb15cf118fdbda],T2.Name [Cb65d125f6f8e4b2e872ecac79384e70c],T0.Code [C34128223803245bfb7e19666e9cf1fb1],T3.Name [C5abb5da777704276a594261c08a3fceb],case when T0.UnitStatus is not null and isnumeric(T0.UnitStatus)=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID=T0.UnitStatus) else '''' end [Cf07e1f52867b47ba9962da1105760d12]
 FROM REN_Units T0 with(nolock) left join COM_Status T1 with(nolock) on T0.Status=T1.StatusID left join REN_Property T2 with(nolock) on T0.PropertyID=T2.NodeID left join COM_Location T3 with(nolock) on T0.LocationID=T3.NodeID
 WHERE T3.NodeID IN (1,22,10,11,25,26,27,28,29,30,31) AND T1.Status=''In Active'' ORDER BY [C79eebe0c82e645b8b5cb15cf118fdbda] '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.917 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.917 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.995 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60648'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:13.995 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:14.011 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:14.011 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:14.073 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60479'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:14.073 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:14.183 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:14.183 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:14.183 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424  AND RU.ContractID=0 AND RU.IsGroup=0 
AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:14.198 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:14.214 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 

'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:14.230 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE
select * ,convert(decimal(18,2), (convert(float,Vacant)/convert(float,NoOfUnits))) *100 [Vacant%]
from (

SELECT Property,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0 AND RU.Status=424 
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

GROUP BY Property
) a order by Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:14.230 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:35:14.230 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.76] ERROR | 06-18-2025 10:35:18.527 | General Service|:: CompanyIndex:0 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUwMTU5NzkyLCJleHAiOjE3NTAxODg1OTIsImlhdCI6MTc1MDE1OTc5Mn0.jwS_tsjwArfE3xkqh89aGJJNugpDhDKyTW9VrN1IjYY'''
 ,1
 ,1|Could not find stored procedure 'spADM_GetDataSet'.
[System: 192.168.1.56] DEBUG | 06-18-2025 10:36:30.945 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:36:30.945 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:37:53.693 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:37:53.693 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:04.566 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60635
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:04.566 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:04.581 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60635
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:04.597 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:04.800 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID , sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
group by Property ,Property_ID'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:04.816 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:07.019 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:07.019 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:11.369 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60643
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:11.369 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:11.384 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60643
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:11.384 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:11.525 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID,SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied''
Group By Property,Property_ID
Order By Property'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:11.540 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:24.747 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 6
 ,'6a9264c9-bb35-4095-8f0c-159e465f3236'
 ,''
 ,''
 ,''
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:24.747 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:24.888 | General Service|:: CompanyIndex:175 SpName: sp_SetTokenHistory 
 0
 ,'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'
 ,''
 ,NULL
 ,1
 ,1
 message=Saved Succesfully
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:24.888 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjE2MDIsImV4cCI6MTc1MDI1MDQwMiwiaWF0IjoxNzUwMjIxNjAyfQ.SfCvnMDBcHHX_DAqFsF5XeR9U5betRNF0v3e0xtPAmM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:28.606 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'Admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:28.700 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'Admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:38.662 | General Service|:: CompanyIndex:175 SpName: spADM_GetClientUserDetails 
 'Admin'
 ,1
 ,'25.9.2'
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:38.693 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'Admin'
 ,175
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:38.709 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,175
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:38.709 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:38.709 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:38.787 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''384870fa-51c5-40e3-8fdd-1187df3de8d5''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.56'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,175,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:38.787 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:38.834 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:38:38.834 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:20.133 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:20.149 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:20.336 | General Service|:: CompanyIndex:175 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:20.336 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:20.524 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:20.539 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:20.555 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:20.555 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:20.586 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:20.586 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:20.633 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:20.649 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:20.649 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:20.649 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:20.742 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:20.758 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:20.855 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:20.855 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:20.902 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:20.917 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:20.964 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''18 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:20.964 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:20.980 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:20.980 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:21.058 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:21.058 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:21.355 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:21.355 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:21.386 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'VIEW'
 ,1
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:21.386 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.054 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,26
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.070 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.085 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60634
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.101 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60642
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.101 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60654
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.101 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60645
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.101 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60479
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.101 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.101 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.101 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.101 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.117 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60639
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.117 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.117 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.117 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60648
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.117 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.226 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60634'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.273 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.429 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.429 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.538 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60654'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.538 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.585 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 93
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.585 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.648 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60642'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.648 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.695 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60639'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.695 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.742 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60645'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.757 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.804 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60648'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.804 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.866 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60479'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.866 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.991 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.991 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT T1.Status [C79eebe0c82e645b8b5cb15cf118fdbda],T2.Name [Cb65d125f6f8e4b2e872ecac79384e70c],T0.Code [C34128223803245bfb7e19666e9cf1fb1],T3.Name [C5abb5da777704276a594261c08a3fceb],case when T0.UnitStatus is not null and isnumeric(T0.UnitStatus)=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID=T0.UnitStatus) else '''' end [Cf07e1f52867b47ba9962da1105760d12]
 FROM REN_Units T0 with(nolock) left join COM_Status T1 with(nolock) on T0.Status=T1.StatusID left join REN_Property T2 with(nolock) on T0.PropertyID=T2.NodeID left join COM_Location T3 with(nolock) on T0.LocationID=T3.NodeID
 WHERE T3.NodeID IN (1,22,10,11,25,26,27,28,29,30,31) AND T1.Status=''In Active'' ORDER BY [C79eebe0c82e645b8b5cb15cf118fdbda] '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.991 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:37.991 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:38.007 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:38.007 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:38.007 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:38.023 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:38.038 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424  AND RU.ContractID=0 AND RU.IsGroup=0 
AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:38.038 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:38.054 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 

'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:38.054 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE
select * ,convert(decimal(18,2), (convert(float,Vacant)/convert(float,NoOfUnits))) *100 [Vacant%]
from (

SELECT Property,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0 AND RU.Status=424 
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

GROUP BY Property
) a order by Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:38.054 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:41:38.054 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:42:27.503 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:42:27.503 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:42:47.379 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60635
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:42:47.395 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:42:47.442 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60635
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:42:47.442 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:42:47.598 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID , sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
group by Property ,Property_ID'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:42:47.598 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:43:21.046 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:43:21.046 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:44:21.151 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:44:21.166 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:47:44.012 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 10:47:44.012 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:47:44.137 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:47:44.137 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:47:45.833 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60643
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:47:45.833 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:47:45.864 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60643
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:47:45.864 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:47:46.005 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID,SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied''
Group By Property,Property_ID
Order By Property'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:47:46.005 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:48:21.158 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:48:21.158 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjMzMTgsImV4cCI6MTc1MDI1MjExOCwiaWF0IjoxNzUwMjIzMzE4fQ.we26O-0r1cpLcu59v_ObzxO7ZUgKw2l40n_8fRSVsn4'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:01.041 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'Admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:01.120 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'Admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:08.725 | General Service|:: CompanyIndex:175 SpName: spADM_GetClientUserDetails 
 'Admin'
 ,1
 ,'25.9.2'
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:08.787 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'Admin'
 ,175
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:08.834 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,175
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:08.850 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:08.850 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:08.912 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''c2c0d363-de7f-4ec9-9d10-862f13c70f7e''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.56'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,175,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:08.912 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:08.959 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:08.959 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:25.960 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:25.960 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:26.147 | General Service|:: CompanyIndex:175 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:26.147 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:26.335 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:26.335 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:26.351 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:26.366 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:26.382 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:26.382 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:26.429 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:26.429 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:26.429 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:26.429 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:26.507 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:26.507 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:26.616 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:26.616 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:26.663 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:26.663 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:26.710 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''18 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:26.710 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:26.741 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:26.741 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:26.804 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:26.804 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:27.101 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:27.101 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:27.116 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'VIEW'
 ,1
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:27.116 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:47.697 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,26
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:47.697 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:47.728 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60634
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:47.728 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60654
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:47.728 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:47.744 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60645
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:47.744 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:47.744 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60642
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:47.744 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:47.744 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:47.744 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60639
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:47.744 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60479
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:47.744 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:47.744 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60648
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:47.744 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:47.759 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:47.853 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60634'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:47.853 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.025 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.025 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.119 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60654'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.134 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.166 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 93
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.166 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.244 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60642'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.244 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.322 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60639'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.322 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.400 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60645'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.416 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.462 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60648'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.462 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.541 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60479'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.541 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.556 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.572 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.619 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT T1.Status [C79eebe0c82e645b8b5cb15cf118fdbda],T2.Name [Cb65d125f6f8e4b2e872ecac79384e70c],T0.Code [C34128223803245bfb7e19666e9cf1fb1],T3.Name [C5abb5da777704276a594261c08a3fceb],case when T0.UnitStatus is not null and isnumeric(T0.UnitStatus)=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID=T0.UnitStatus) else '''' end [Cf07e1f52867b47ba9962da1105760d12]
 FROM REN_Units T0 with(nolock) left join COM_Status T1 with(nolock) on T0.Status=T1.StatusID left join REN_Property T2 with(nolock) on T0.PropertyID=T2.NodeID left join COM_Location T3 with(nolock) on T0.LocationID=T3.NodeID
 WHERE T3.NodeID IN (1,22,10,11,25,26,27,28,29,30,31) AND T1.Status=''In Active'' ORDER BY [C79eebe0c82e645b8b5cb15cf118fdbda] '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.619 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.634 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.650 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.650 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.666 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.666 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424  AND RU.ContractID=0 AND RU.IsGroup=0 
AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.681 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.681 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 

'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.681 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.697 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE
select * ,convert(decimal(18,2), (convert(float,Vacant)/convert(float,NoOfUnits))) *100 [Vacant%]
from (

SELECT Property,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0 AND RU.Status=424 
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

GROUP BY Property
) a order by Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:48.697 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:50.805 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60635
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:50.821 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:50.836 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60635
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:50.836 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:51.008 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID , sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
group by Property ,Property_ID'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:50:51.008 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:51:26.802 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:51:26.818 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:52:26.938 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:52:26.938 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:53:26.819 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:53:26.819 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:54:26.806 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:54:26.806 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:55:25.982 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 10:55:25.982 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:55:26.810 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:55:26.810 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:56:26.799 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:56:26.799 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:57:26.834 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:57:26.834 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:58:26.799 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:58:26.799 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:59:26.794 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 10:59:26.810 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:00:25.977 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 11:00:25.977 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:00:26.821 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:00:26.821 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:01:26.801 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:01:26.817 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:02:26.808 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:02:26.808 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:03:26.797 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:03:26.812 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:04:26.792 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:04:26.808 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:05:08.950 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''c2c0d363-de7f-4ec9-9d10-862f13c70f7e''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 11:05:08.966 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:05:26.156 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 11:05:26.156 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:05:26.796 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:05:26.796 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:06:26.809 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:06:26.809 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:07:26.808 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:07:26.808 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:08:26.797 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:08:26.797 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:09:26.801 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:09:26.816 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:10:25.979 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 11:10:25.979 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:10:26.807 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:10:26.807 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:11:26.814 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:11:26.814 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:12:26.813 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:12:26.813 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:13:26.818 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:13:26.818 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:14:26.801 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:14:26.816 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:15:25.982 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 11:15:25.982 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:15:26.810 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:15:26.810 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:16:26.887 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:16:26.887 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:17:26.799 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:17:26.814 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:18:26.801 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:18:26.817 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:19:26.801 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:19:26.801 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:20:08.955 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''c2c0d363-de7f-4ec9-9d10-862f13c70f7e''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 11:20:08.970 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:20:25.985 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 11:20:25.985 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:20:26.798 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:20:26.813 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:21:26.805 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:21:26.805 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:22:26.801 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:22:26.817 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:23:26.813 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:23:26.813 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:24:26.818 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:24:26.818 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:25:25.983 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 11:25:25.983 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:25:26.811 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:25:26.811 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjQwMDgsImV4cCI6MTc1MDI1MjgwOCwiaWF0IjoxNzUwMjI0MDA4fQ.KvoqdHpuMq6x0HNXymBxNkh72ZFRnofrjg60jBMujjs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:28:47.536 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'Admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 11:28:47.614 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'Admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:28:57.934 | General Service|:: CompanyIndex:175 SpName: spADM_GetClientUserDetails 
 'Admin'
 ,1
 ,'25.9.2'
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 11:28:57.965 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'Admin'
 ,175
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:28:57.980 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,175
[System: 192.168.1.56] DEBUG | 06-18-2025 11:28:57.996 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:28:57.996 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:28:58.027 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''7a9d9452-6bbb-4aeb-81bf-e2f67e51080e''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.56'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,175,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 11:28:58.043 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:28:58.074 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:28:58.074 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:00.675 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:00.675 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:00.862 | General Service|:: CompanyIndex:175 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:00.862 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:01.060 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:01.060 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:01.076 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:01.091 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:01.107 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:01.122 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:01.185 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:01.201 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:01.201 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:01.201 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:01.294 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:01.310 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:01.404 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:01.404 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:01.451 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:01.451 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:01.513 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''18 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:01.513 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:01.544 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:01.544 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:01.607 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:01.607 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:01.919 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:01.919 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:01.951 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'VIEW'
 ,1
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:01.951 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.055 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,26
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.055 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.102 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60634
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.102 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60654
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.102 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60639
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.102 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.102 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60479
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.117 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60648
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.117 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.117 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60645
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.117 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.117 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.117 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.117 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.117 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60642
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.117 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.227 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60634'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.227 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.430 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.430 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.539 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60654'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.555 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.586 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 93
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.601 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.695 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60642'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.695 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.773 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60639'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.773 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.852 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60645'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.852 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.930 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60648'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.930 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:29.992 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60479'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:30.008 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:30.101 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT T1.Status [C79eebe0c82e645b8b5cb15cf118fdbda],T2.Name [Cb65d125f6f8e4b2e872ecac79384e70c],T0.Code [C34128223803245bfb7e19666e9cf1fb1],T3.Name [C5abb5da777704276a594261c08a3fceb],case when T0.UnitStatus is not null and isnumeric(T0.UnitStatus)=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID=T0.UnitStatus) else '''' end [Cf07e1f52867b47ba9962da1105760d12]
 FROM REN_Units T0 with(nolock) left join COM_Status T1 with(nolock) on T0.Status=T1.StatusID left join REN_Property T2 with(nolock) on T0.PropertyID=T2.NodeID left join COM_Location T3 with(nolock) on T0.LocationID=T3.NodeID
 WHERE T3.NodeID IN (1,22,10,11,25,26,27,28,29,30,31) AND T1.Status=''In Active'' ORDER BY [C79eebe0c82e645b8b5cb15cf118fdbda] '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:30.101 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:30.117 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:30.117 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:30.117 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:30.117 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:30.133 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:30.133 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:30.148 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424  AND RU.ContractID=0 AND RU.IsGroup=0 
AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:30.148 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:30.164 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 

'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:30.179 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:30.179 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE
select * ,convert(decimal(18,2), (convert(float,Vacant)/convert(float,NoOfUnits))) *100 [Vacant%]
from (

SELECT Property,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0 AND RU.Status=424 
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

GROUP BY Property
) a order by Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:30.179 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:37.621 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60635
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:37.621 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:37.636 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60635
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:37.636 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:37.808 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID , sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
group by Property ,Property_ID'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:29:37.808 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:30:01.613 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:30:01.613 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:01.611 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:01.611 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:01.923 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,26
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:01.939 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:01.970 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60634
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:01.970 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60654
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:01.970 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60639
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:01.970 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:01.970 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60642
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:01.970 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60645
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:01.970 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:01.970 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:01.970 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:01.970 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60648
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:01.986 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:01.986 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:01.986 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60479
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:01.986 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.080 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60634'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.080 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.142 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,26
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.142 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60654'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.158 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.158 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.189 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 93
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.189 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.314 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60634
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.314 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60654
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.314 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60639
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.314 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.314 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60479
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.314 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60645
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.314 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.314 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.314 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.329 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.314 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60642
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.329 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.329 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60642'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.329 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60648
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.329 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.329 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.361 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.361 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.407 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60639'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.407 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.454 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60645'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.454 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.533 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT T1.Status [C79eebe0c82e645b8b5cb15cf118fdbda],T2.Name [Cb65d125f6f8e4b2e872ecac79384e70c],T0.Code [C34128223803245bfb7e19666e9cf1fb1],T3.Name [C5abb5da777704276a594261c08a3fceb],case when T0.UnitStatus is not null and isnumeric(T0.UnitStatus)=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID=T0.UnitStatus) else '''' end [Cf07e1f52867b47ba9962da1105760d12]
 FROM REN_Units T0 with(nolock) left join COM_Status T1 with(nolock) on T0.Status=T1.StatusID left join REN_Property T2 with(nolock) on T0.PropertyID=T2.NodeID left join COM_Location T3 with(nolock) on T0.LocationID=T3.NodeID
 WHERE T3.NodeID IN (1,22,10,11,25,26,27,28,29,30,31) AND T1.Status=''In Active'' ORDER BY [C79eebe0c82e645b8b5cb15cf118fdbda] '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.533 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.548 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60648'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.564 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.611 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60479'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.611 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.704 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.704 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.736 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.736 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.751 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424  AND RU.ContractID=0 AND RU.IsGroup=0 
AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.767 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 

'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.767 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE
select * ,convert(decimal(18,2), (convert(float,Vacant)/convert(float,NoOfUnits))) *100 [Vacant%]
from (

SELECT Property,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0 AND RU.Status=424 
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

GROUP BY Property
) a order by Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.767 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.767 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.767 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.782 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60634'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.782 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.861 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60654'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.861 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.892 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 93
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.892 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.970 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60642'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:02.970 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:03.001 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:03.001 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:03.017 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60639'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:03.032 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:03.095 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60645'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:03.110 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT T1.Status [C79eebe0c82e645b8b5cb15cf118fdbda],T2.Name [Cb65d125f6f8e4b2e872ecac79384e70c],T0.Code [C34128223803245bfb7e19666e9cf1fb1],T3.Name [C5abb5da777704276a594261c08a3fceb],case when T0.UnitStatus is not null and isnumeric(T0.UnitStatus)=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID=T0.UnitStatus) else '''' end [Cf07e1f52867b47ba9962da1105760d12]
 FROM REN_Units T0 with(nolock) left join COM_Status T1 with(nolock) on T0.Status=T1.StatusID left join REN_Property T2 with(nolock) on T0.PropertyID=T2.NodeID left join COM_Location T3 with(nolock) on T0.LocationID=T3.NodeID
 WHERE T3.NodeID IN (1,22,10,11,25,26,27,28,29,30,31) AND T1.Status=''In Active'' ORDER BY [C79eebe0c82e645b8b5cb15cf118fdbda] '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:03.110 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:03.110 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:03.173 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60648'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:03.173 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:03.251 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:03.251 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:03.251 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60479'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:03.267 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:03.376 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:03.392 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:03.407 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424  AND RU.ContractID=0 AND RU.IsGroup=0 
AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:03.407 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:03.423 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 

'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:03.423 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:03.439 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE
select * ,convert(decimal(18,2), (convert(float,Vacant)/convert(float,NoOfUnits))) *100 [Vacant%]
from (

SELECT Property,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0 AND RU.Status=424 
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

GROUP BY Property
) a order by Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:03.439 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:04.919 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60635
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:04.919 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:04.934 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60635
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:04.934 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:05.106 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID , sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
group by Property ,Property_ID'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:31:05.122 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:32:01.598 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:32:01.613 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:32:27.069 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60643
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:32:27.069 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:32:42.933 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60643
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:32:42.933 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:32:44.249 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID,SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied''
Group By Property,Property_ID
Order By Property'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:32:44.249 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:01.608 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:01.608 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjYzMzcsImV4cCI6MTc1MDI1NTEzNywiaWF0IjoxNzUwMjI2MzM3fQ.i-Jx9apx8OCyAPtgrXRUKn7aicTdrasNTeJALTkyzZM'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:36.410 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'Admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:36.504 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'Admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:42.613 | General Service|:: CompanyIndex:175 SpName: spADM_GetClientUserDetails 
 'Admin'
 ,1
 ,'25.9.2'
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:42.645 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'Admin'
 ,175
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:42.660 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,175
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:42.676 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:42.676 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:42.723 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''cada3b10-e30b-475c-a5dd-90637d99ac2d''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.56'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,175,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:42.723 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:42.754 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:42.754 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:45.609 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:45.624 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:45.812 | General Service|:: CompanyIndex:175 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:45.812 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:45.999 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:46.015 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:46.030 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:46.030 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:46.046 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:46.062 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:46.108 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:46.108 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:46.124 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:46.124 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:46.202 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:46.202 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:46.296 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:46.296 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:46.343 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:46.343 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:46.374 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''18 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:46.374 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:46.390 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:46.390 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:46.580 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:46.580 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:46.751 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:46.751 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:46.783 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'VIEW'
 ,1
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:46.783 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:58.388 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,26
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:58.388 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:58.482 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60654
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:58.482 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60634
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:58.482 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60645
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:58.482 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60648
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:58.482 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60639
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:58.497 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60642
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:59.085 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:59.085 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:59.085 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:59.085 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:59.085 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:59.085 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:59.132 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60479
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:59.132 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:59.273 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60634'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:59.288 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:59.460 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:59.460 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:59.601 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60654'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:59.601 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:59.648 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 93
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:59.648 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:59.757 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60642'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:59.757 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:59.851 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60639'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:59.851 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:59.929 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60645'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:59.929 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:33:59.991 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60648'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:00.007 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:00.054 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60479'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:00.054 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:00.147 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT T1.Status [C79eebe0c82e645b8b5cb15cf118fdbda],T2.Name [Cb65d125f6f8e4b2e872ecac79384e70c],T0.Code [C34128223803245bfb7e19666e9cf1fb1],T3.Name [C5abb5da777704276a594261c08a3fceb],case when T0.UnitStatus is not null and isnumeric(T0.UnitStatus)=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID=T0.UnitStatus) else '''' end [Cf07e1f52867b47ba9962da1105760d12]
 FROM REN_Units T0 with(nolock) left join COM_Status T1 with(nolock) on T0.Status=T1.StatusID left join REN_Property T2 with(nolock) on T0.PropertyID=T2.NodeID left join COM_Location T3 with(nolock) on T0.LocationID=T3.NodeID
 WHERE T3.NodeID IN (1,22,10,11,25,26,27,28,29,30,31) AND T1.Status=''In Active'' ORDER BY [C79eebe0c82e645b8b5cb15cf118fdbda] '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:00.163 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:00.163 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:00.163 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:00.163 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:00.179 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:00.179 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:00.179 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:00.194 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424  AND RU.ContractID=0 AND RU.IsGroup=0 
AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:00.194 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:00.210 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 

'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:00.210 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:00.210 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE
select * ,convert(decimal(18,2), (convert(float,Vacant)/convert(float,NoOfUnits))) *100 [Vacant%]
from (

SELECT Property,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0 AND RU.Status=424 
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

GROUP BY Property
) a order by Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:00.210 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:02.288 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60643
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:02.304 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:02.319 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60643
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:02.319 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:02.460 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID,SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied''
Group By Property,Property_ID
Order By Property'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:02.460 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2MjIsImV4cCI6MTc1MDI1NTQyMiwiaWF0IjoxNzUwMjI2NjIyfQ.rMJ_avp_TPk0ZMtdNykpWgKkTzv1zYnI5kRjVYvOqWY'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:50.235 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'Admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:50.298 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'Admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:54.425 | General Service|:: CompanyIndex:175 SpName: spADM_GetClientUserDetails 
 'Admin'
 ,1
 ,'25.9.2'
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:54.441 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'Admin'
 ,175
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:54.456 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,175
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:54.456 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:54.456 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:54.488 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''1d49506c-d642-4955-b5a1-e84dffe934c5''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.56'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,175,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:54.488 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:54.519 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:54.519 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:57.087 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:57.087 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:57.259 | General Service|:: CompanyIndex:175 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:57.259 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:57.462 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:57.462 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:57.478 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:57.478 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:57.493 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:57.509 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:57.556 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:57.556 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:57.556 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:57.571 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:57.665 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:57.681 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:57.774 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:57.774 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:57.821 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:57.821 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:57.868 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''18 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:57.868 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:57.884 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:57.884 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:58.056 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:58.071 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:58.321 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:58.321 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:58.462 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'VIEW'
 ,1
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:34:58.478 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:18.667 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,26
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:18.667 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:18.699 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60634
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:18.699 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60654
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:18.699 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60642
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:18.699 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60648
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:18.699 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:18.699 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60639
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:18.699 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:18.699 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:18.699 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:18.714 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:18.714 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60645
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:18.714 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60479
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:18.714 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:18.714 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:18.808 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60634'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:18.824 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:18.964 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:18.980 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.058 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60654'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.074 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.105 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 93
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.105 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.167 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60642'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.167 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.214 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60639'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.230 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.292 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60645'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.292 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.370 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60648'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.370 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.448 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60479'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.448 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.480 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.480 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.527 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT T1.Status [C79eebe0c82e645b8b5cb15cf118fdbda],T2.Name [Cb65d125f6f8e4b2e872ecac79384e70c],T0.Code [C34128223803245bfb7e19666e9cf1fb1],T3.Name [C5abb5da777704276a594261c08a3fceb],case when T0.UnitStatus is not null and isnumeric(T0.UnitStatus)=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID=T0.UnitStatus) else '''' end [Cf07e1f52867b47ba9962da1105760d12]
 FROM REN_Units T0 with(nolock) left join COM_Status T1 with(nolock) on T0.Status=T1.StatusID left join REN_Property T2 with(nolock) on T0.PropertyID=T2.NodeID left join COM_Location T3 with(nolock) on T0.LocationID=T3.NodeID
 WHERE T3.NodeID IN (1,22,10,11,25,26,27,28,29,30,31) AND T1.Status=''In Active'' ORDER BY [C79eebe0c82e645b8b5cb15cf118fdbda] '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.542 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.542 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.558 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.574 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.574 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.589 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424  AND RU.ContractID=0 AND RU.IsGroup=0 
AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.605 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.605 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 

'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.605 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.620 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE
select * ,convert(decimal(18,2), (convert(float,Vacant)/convert(float,NoOfUnits))) *100 [Vacant%]
from (

SELECT Property,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0 AND RU.Status=424 
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

GROUP BY Property
) a order by Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:19.620 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:38.376 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60643
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:38.376 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:38.392 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60643
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:38.408 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:38.533 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID,SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied''
Group By Property,Property_ID
Order By Property'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:38.548 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:57.935 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:35:57.935 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:36:57.938 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:36:57.938 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:37:57.931 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:37:57.947 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:38:57.938 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:38:57.938 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:39:57.102 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 11:39:57.102 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:39:57.933 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:39:57.933 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:40:57.944 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:40:57.944 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:41:57.937 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:41:57.937 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:42:57.950 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:42:57.950 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:43:57.956 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:43:57.956 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:44:57.098 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 11:44:57.098 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:44:57.942 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:44:57.942 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:45:57.949 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:45:57.949 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:46:57.953 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:46:57.953 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:47:57.949 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:47:57.949 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:48:57.950 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:48:57.950 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:49:54.542 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''1d49506c-d642-4955-b5a1-e84dffe934c5''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 11:49:54.542 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:49:57.109 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 11:49:57.109 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:49:57.952 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:49:57.952 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:50:57.949 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:50:57.949 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:51:57.971 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:51:57.971 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:52:57.941 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:52:57.941 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:53:57.943 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:53:57.958 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:54:57.100 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 11:54:57.100 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:54:57.949 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:54:57.949 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:55:57.944 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:55:57.944 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:56:57.949 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:56:57.949 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:57:57.943 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:57:57.943 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:58:57.945 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:58:57.960 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:59:57.107 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 11:59:57.107 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:59:57.951 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 11:59:57.951 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:00:57.949 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:00:57.949 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:01:57.951 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:01:57.967 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:02:57.963 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:02:57.963 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:03:57.949 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:03:57.949 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:04:54.534 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''1d49506c-d642-4955-b5a1-e84dffe934c5''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 12:04:54.534 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:04:57.113 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 12:04:57.113 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:04:57.941 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:04:57.956 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:05:57.959 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:05:57.959 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:06:57.977 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:06:57.977 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:07:57.980 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:07:57.980 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:08:57.959 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:08:57.959 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:09:57.112 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 12:09:57.112 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:09:57.957 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:09:57.957 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:10:57.957 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:10:57.957 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:11:57.953 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:11:57.953 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:14:11.624 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:14:11.624 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:14:57.112 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 12:14:57.112 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:14:57.972 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:14:57.972 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:15:57.945 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:15:57.961 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:16:57.961 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:16:57.961 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:17:57.963 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:17:57.963 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:18:57.965 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:18:57.965 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:19:54.548 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''1d49506c-d642-4955-b5a1-e84dffe934c5''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 12:19:54.548 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:19:57.110 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 12:19:57.125 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:19:57.969 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:19:57.969 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:20:57.962 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:20:57.962 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:21:58.024 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:21:58.024 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:22:57.960 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:22:57.960 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:23:57.955 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:23:57.971 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:24:57.114 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 12:24:57.114 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:24:57.945 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:24:57.945 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjY2OTQsImV4cCI6MTc1MDI1NTQ5NCwiaWF0IjoxNzUwMjI2Njk0fQ.n_bAS_1PdGVf5N0inoXtzZml3YtR8R-brm3U-t-umV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:25:47.864 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'Admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 12:25:47.927 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'Admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:26.489 | General Service|:: CompanyIndex:175 SpName: spADM_GetClientUserDetails 
 'Admin'
 ,1
 ,'25.9.2'
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:26.536 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'Admin'
 ,175
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:26.551 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,175
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:26.551 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:26.551 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:26.598 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''93f3241a-52fb-46c3-9051-c4c75df40d53''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.56'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,175,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:26.598 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:26.629 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:26.629 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:29.933 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:29.933 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:30.121 | General Service|:: CompanyIndex:175 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:30.121 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:30.339 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:30.339 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:30.355 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:30.371 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:30.386 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:30.386 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:30.449 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:30.464 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:30.464 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:30.464 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:30.558 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:30.558 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:30.652 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:30.652 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:30.699 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:30.714 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:30.761 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''18 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:30.777 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:30.792 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:30.792 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:30.839 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:30.855 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:31.183 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:31.183 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:31.355 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'VIEW'
 ,1
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:26:31.370 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:00.427 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,26
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:00.427 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:00.490 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60634
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:00.490 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60645
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:00.490 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60654
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:00.490 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:00.490 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60642
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:00.490 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:00.490 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60639
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:00.490 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:00.490 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60479
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:00.505 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:00.505 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:00.505 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:00.505 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60648
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:00.505 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:00.599 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60634'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:00.599 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.277 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.277 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.387 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60654'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.387 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.434 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 93
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.434 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.496 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60642'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.512 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.590 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60639'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.590 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.652 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60645'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.668 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.730 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60648'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.746 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.808 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60479'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.824 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.933 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT T1.Status [C79eebe0c82e645b8b5cb15cf118fdbda],T2.Name [Cb65d125f6f8e4b2e872ecac79384e70c],T0.Code [C34128223803245bfb7e19666e9cf1fb1],T3.Name [C5abb5da777704276a594261c08a3fceb],case when T0.UnitStatus is not null and isnumeric(T0.UnitStatus)=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID=T0.UnitStatus) else '''' end [Cf07e1f52867b47ba9962da1105760d12]
 FROM REN_Units T0 with(nolock) left join COM_Status T1 with(nolock) on T0.Status=T1.StatusID left join REN_Property T2 with(nolock) on T0.PropertyID=T2.NodeID left join COM_Location T3 with(nolock) on T0.LocationID=T3.NodeID
 WHERE T3.NodeID IN (1,22,10,11,25,26,27,28,29,30,31) AND T1.Status=''In Active'' ORDER BY [C79eebe0c82e645b8b5cb15cf118fdbda] '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.933 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.949 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.949 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.949 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.949 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.965 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.980 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.980 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424  AND RU.ContractID=0 AND RU.IsGroup=0 
AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.980 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.980 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 

'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.980 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.996 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE
select * ,convert(decimal(18,2), (convert(float,Vacant)/convert(float,NoOfUnits))) *100 [Vacant%]
from (

SELECT Property,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0 AND RU.Status=424 
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

GROUP BY Property
) a order by Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:02.996 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:06.059 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60635
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:06.059 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:06.075 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60635
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:06.090 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:06.262 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID , sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
group by Property ,Property_ID'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:06.262 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:31.326 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:27:31.326 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk3ODYsImV4cCI6MTc1MDI1ODU4NiwiaWF0IjoxNzUwMjI5Nzg2fQ.nGD4cqh3IK5gF_ckysf9TqKvvC-Y1ZI3-RKLNQfoicw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:25.959 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'Admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:26.053 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'Admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:29.568 | General Service|:: CompanyIndex:175 SpName: spADM_GetClientUserDetails 
 'Admin'
 ,1
 ,'25.9.2'
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:29.600 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'Admin'
 ,175
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:29.615 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,175
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:29.631 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:29.631 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:29.678 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''a70d080c-45fe-44d8-a515-6e81b596029a''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.56'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,175,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:29.678 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:29.725 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:29.725 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:40.858 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:40.858 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:41.030 | General Service|:: CompanyIndex:175 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:41.030 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:41.223 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:41.223 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:41.238 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:41.254 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:41.269 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:41.269 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:41.316 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:41.332 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:41.332 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:41.332 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:41.425 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:41.441 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:41.535 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:41.535 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:41.597 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:41.613 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:41.660 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''18 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:41.660 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:41.676 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:41.676 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:41.738 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:41.738 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:42.051 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:42.051 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:42.082 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'VIEW'
 ,1
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:42.082 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.380 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,26
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.396 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.427 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60634
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.427 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60639
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.427 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60654
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.427 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60645
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.427 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60648
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.427 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60642
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.427 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.427 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.427 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.427 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.427 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.442 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.442 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60479
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.442 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.536 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60634'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.536 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.692 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.692 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.817 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60654'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.817 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.849 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 93
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.849 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.911 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60642'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.927 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.973 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60639'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:48.973 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:49.067 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60645'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:49.067 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:49.130 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60648'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:49.145 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:49.208 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60479'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:49.208 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:49.239 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:49.239 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:49.286 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT T1.Status [C79eebe0c82e645b8b5cb15cf118fdbda],T2.Name [Cb65d125f6f8e4b2e872ecac79384e70c],T0.Code [C34128223803245bfb7e19666e9cf1fb1],T3.Name [C5abb5da777704276a594261c08a3fceb],case when T0.UnitStatus is not null and isnumeric(T0.UnitStatus)=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID=T0.UnitStatus) else '''' end [Cf07e1f52867b47ba9962da1105760d12]
 FROM REN_Units T0 with(nolock) left join COM_Status T1 with(nolock) on T0.Status=T1.StatusID left join REN_Property T2 with(nolock) on T0.PropertyID=T2.NodeID left join COM_Location T3 with(nolock) on T0.LocationID=T3.NodeID
 WHERE T3.NodeID IN (1,22,10,11,25,26,27,28,29,30,31) AND T1.Status=''In Active'' ORDER BY [C79eebe0c82e645b8b5cb15cf118fdbda] '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:49.302 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:49.317 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:49.317 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:49.333 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:49.333 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:49.364 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424  AND RU.ContractID=0 AND RU.IsGroup=0 
AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:49.364 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 

'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:49.364 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:49.364 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:49.380 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE
select * ,convert(decimal(18,2), (convert(float,Vacant)/convert(float,NoOfUnits))) *100 [Vacant%]
from (

SELECT Property,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0 AND RU.Status=424 
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

GROUP BY Property
) a order by Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:49.380 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:51.442 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60643
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:51.457 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:51.473 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60643
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:51.473 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:51.614 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID,SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied''
Group By Property,Property_ID
Order By Property'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:29:51.614 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:30:41.739 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:30:41.739 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:31:41.993 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:31:41.993 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:32:41.885 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:32:41.885 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:33:41.748 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:33:41.748 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:34:40.873 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 12:34:40.873 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:34:41.748 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:34:41.748 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:35:41.750 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:35:41.750 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:36:41.751 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:36:41.751 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:37:41.764 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:37:41.764 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:38:41.747 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:38:41.747 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:39:40.861 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 12:39:40.876 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:39:41.751 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:39:41.751 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:40:41.741 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:40:41.757 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:41:41.739 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:41:41.739 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:42:41.749 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:42:41.749 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:43:41.740 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:43:41.740 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:44:29.732 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''a70d080c-45fe-44d8-a515-6e81b596029a''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 12:44:29.732 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:44:40.857 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 12:44:40.873 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:44:41.748 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:44:41.748 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:45:50.850 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:45:50.850 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:46:42.208 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:46:42.208 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:47:41.838 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:47:41.838 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:48:41.744 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:48:41.744 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:49:41.176 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 12:49:41.176 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:49:42.207 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:49:42.207 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:50:41.759 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:50:41.759 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMjk5NjksImV4cCI6MTc1MDI1ODc2OSwiaWF0IjoxNzUwMjI5OTY5fQ.w1WY8whtbUi88h-_r6COsXcJacSkO25qkHp_2YYatDE'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:28.366 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'Admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:28.444 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'Admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:32.127 | General Service|:: CompanyIndex:175 SpName: spADM_GetClientUserDetails 
 'Admin'
 ,1
 ,'25.9.2'
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:32.173 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'Admin'
 ,175
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:32.189 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,175
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:32.205 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:32.205 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:32.236 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''82c9f768-886d-43da-9f66-a8282018ec62''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.56'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,175,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:32.236 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:32.283 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:32.283 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:35.430 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:35.445 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:35.792 | General Service|:: CompanyIndex:175 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:35.792 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:35.996 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:35.996 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:36.027 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:36.027 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:36.058 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:36.058 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:36.183 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:36.183 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:36.230 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:36.230 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:36.324 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:36.339 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:36.417 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:36.417 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:36.448 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:36.464 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:36.761 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''18 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:36.777 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:36.792 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:36.792 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:37.027 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:37.027 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:37.152 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:37.152 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:37.183 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'VIEW'
 ,1
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:37.183 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:46.721 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,26
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:46.721 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:46.752 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60634
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:46.752 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60642
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:46.752 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60654
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:46.768 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60648
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:46.768 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60645
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:46.768 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:46.768 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:46.768 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:46.768 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:46.768 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60479
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:46.768 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:46.768 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:46.783 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60639
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:46.783 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:46.886 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60634'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:46.886 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:48.872 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:48.872 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:48.966 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60654'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:48.982 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:49.013 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 93
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:49.013 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:49.091 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60642'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:49.091 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:49.154 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60639'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:49.169 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:49.294 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60645'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:49.294 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:49.372 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60648'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:49.372 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:49.435 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60479'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:49.435 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:49.560 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT T1.Status [C79eebe0c82e645b8b5cb15cf118fdbda],T2.Name [Cb65d125f6f8e4b2e872ecac79384e70c],T0.Code [C34128223803245bfb7e19666e9cf1fb1],T3.Name [C5abb5da777704276a594261c08a3fceb],case when T0.UnitStatus is not null and isnumeric(T0.UnitStatus)=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID=T0.UnitStatus) else '''' end [Cf07e1f52867b47ba9962da1105760d12]
 FROM REN_Units T0 with(nolock) left join COM_Status T1 with(nolock) on T0.Status=T1.StatusID left join REN_Property T2 with(nolock) on T0.PropertyID=T2.NodeID left join COM_Location T3 with(nolock) on T0.LocationID=T3.NodeID
 WHERE T3.NodeID IN (1,22,10,11,25,26,27,28,29,30,31) AND T1.Status=''In Active'' ORDER BY [C79eebe0c82e645b8b5cb15cf118fdbda] '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:49.560 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:49.560 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:49.575 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:49.575 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:49.591 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:49.591 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:49.591 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:49.607 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424  AND RU.ContractID=0 AND RU.IsGroup=0 
AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:49.607 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:49.638 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 

'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:49.638 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE
select * ,convert(decimal(18,2), (convert(float,Vacant)/convert(float,NoOfUnits))) *100 [Vacant%]
from (

SELECT Property,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0 AND RU.Status=424 
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

GROUP BY Property
) a order by Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:49.638 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:49.638 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:52.136 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60643
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:52.136 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:52.448 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60643
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:52.464 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:52.902 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID,SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied''
Group By Property,Property_ID
Order By Property'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:51:52.902 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:52:37.019 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:52:37.019 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:58:20.108 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:58:20.108 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 12:58:21.420 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 12:58:21.436 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:01:33.235 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:01:33.235 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:01:36.175 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 13:01:36.175 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:01:37.269 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:01:37.269 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:05:44.628 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:05:44.634 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:06:32.477 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''82c9f768-886d-43da-9f66-a8282018ec62''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 13:06:32.477 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:06:35.439 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 13:06:35.454 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:06:38.642 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:06:38.642 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzEyOTIsImV4cCI6MTc1MDI2MDA5MiwiaWF0IjoxNzUwMjMxMjkyfQ.bocfvzZHLCKi1qUOgi2dEdKSY16g5lPtrP-awdn5zV8'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:05.105 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'Admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:05.230 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'Admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:09.964 | General Service|:: CompanyIndex:175 SpName: spADM_GetClientUserDetails 
 'Admin'
 ,1
 ,'25.9.2'
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:10.027 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'Admin'
 ,175
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:10.058 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,175
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:10.058 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:10.058 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:10.089 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''70d9004a-950b-4891-9f3b-a9dd3838fde3''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.56'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,175,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:10.089 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:10.464 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:10.480 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:18.312 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:18.312 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:18.390 | General Service|:: CompanyIndex:175 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:18.390 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:18.656 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:18.656 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:18.687 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:18.687 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:18.703 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:18.718 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:18.828 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:18.843 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:18.843 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:18.859 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:18.922 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:18.922 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:19.206 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:19.206 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:19.253 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:19.268 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:19.346 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''18 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:19.362 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:19.393 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:19.393 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:19.471 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:19.487 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:19.800 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:19.800 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:19.831 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'VIEW'
 ,1
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:19.831 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:27.656 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,26
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:27.656 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:27.781 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60634
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:27.781 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60654
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:27.781 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60642
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:27.781 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60645
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:27.781 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60648
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:27.796 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:27.796 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:27.796 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:27.796 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:27.796 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:27.796 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60639
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:27.796 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:27.796 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60479
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:27.796 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:27.890 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60634'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:27.906 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:28.125 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:28.125 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:28.500 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60654'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:28.500 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:28.546 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 93
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:28.562 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:28.624 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60642'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:28.624 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:28.718 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60639'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:28.718 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:28.781 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60645'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:28.796 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:28.843 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60648'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:28.843 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:28.921 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60479'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:28.921 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:29.015 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT T1.Status [C79eebe0c82e645b8b5cb15cf118fdbda],T2.Name [Cb65d125f6f8e4b2e872ecac79384e70c],T0.Code [C34128223803245bfb7e19666e9cf1fb1],T3.Name [C5abb5da777704276a594261c08a3fceb],case when T0.UnitStatus is not null and isnumeric(T0.UnitStatus)=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID=T0.UnitStatus) else '''' end [Cf07e1f52867b47ba9962da1105760d12]
 FROM REN_Units T0 with(nolock) left join COM_Status T1 with(nolock) on T0.Status=T1.StatusID left join REN_Property T2 with(nolock) on T0.PropertyID=T2.NodeID left join COM_Location T3 with(nolock) on T0.LocationID=T3.NodeID
 WHERE T3.NodeID IN (1,22,10,11,25,26,27,28,29,30,31) AND T1.Status=''In Active'' ORDER BY [C79eebe0c82e645b8b5cb15cf118fdbda] '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:29.031 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:29.031 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:29.031 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:29.031 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:29.046 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:29.062 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424  AND RU.ContractID=0 AND RU.IsGroup=0 
AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:29.062 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:29.077 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:29.077 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:29.109 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 

'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:29.124 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:29.124 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE
select * ,convert(decimal(18,2), (convert(float,Vacant)/convert(float,NoOfUnits))) *100 [Vacant%]
from (

SELECT Property,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0 AND RU.Status=424 
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

GROUP BY Property
) a order by Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:29.124 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:48.154 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,26
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:48.154 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:48.609 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60654
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:48.609 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60645
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:48.609 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60642
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:48.609 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60639
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:48.609 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:48.609 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:48.624 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60634
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:48.624 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60648
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:48.624 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:48.624 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:48.624 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:48.624 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:48.656 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60479
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:48.656 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:49.327 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60634'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:49.327 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:49.577 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60654'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:49.577 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:49.843 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 93
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:49.843 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:49.921 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60642'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:49.921 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:49.952 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:49.968 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:49.984 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60639'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:49.999 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:50.171 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60645'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:50.171 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:50.312 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60648'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:50.327 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:50.405 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60479'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:50.405 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:50.515 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT T1.Status [C79eebe0c82e645b8b5cb15cf118fdbda],T2.Name [Cb65d125f6f8e4b2e872ecac79384e70c],T0.Code [C34128223803245bfb7e19666e9cf1fb1],T3.Name [C5abb5da777704276a594261c08a3fceb],case when T0.UnitStatus is not null and isnumeric(T0.UnitStatus)=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID=T0.UnitStatus) else '''' end [Cf07e1f52867b47ba9962da1105760d12]
 FROM REN_Units T0 with(nolock) left join COM_Status T1 with(nolock) on T0.Status=T1.StatusID left join REN_Property T2 with(nolock) on T0.PropertyID=T2.NodeID left join COM_Location T3 with(nolock) on T0.LocationID=T3.NodeID
 WHERE T3.NodeID IN (1,22,10,11,25,26,27,28,29,30,31) AND T1.Status=''In Active'' ORDER BY [C79eebe0c82e645b8b5cb15cf118fdbda] '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:50.515 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:50.530 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:50.546 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:50.561 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:50.577 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:50.577 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424  AND RU.ContractID=0 AND RU.IsGroup=0 
AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:50.577 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:50.608 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 

'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:50.608 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:50.624 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE
select * ,convert(decimal(18,2), (convert(float,Vacant)/convert(float,NoOfUnits))) *100 [Vacant%]
from (

SELECT Property,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0 AND RU.Status=424 
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

GROUP BY Property
) a order by Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:07:50.624 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:08:20.801 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:08:20.817 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:09:20.562 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:09:20.593 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:14:20.641 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:14:20.668 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:14:21.605 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 13:14:21.605 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:15:19.469 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:15:19.469 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzIyMjksImV4cCI6MTc1MDI2MTAyOSwiaWF0IjoxNzUwMjMyMjI5fQ.TTIMu6IV6UAYvAUPIBBKq8xHkkyQq8oAvlNZADGis0I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:11.850 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:11.959 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:31.688 | General Service|:: CompanyIndex:175 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'25.9.2'
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:31.782 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,175
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:31.797 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,175
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:31.797 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:31.813 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:31.875 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''8f193e84-2a9d-450c-8d2c-d8ef9b1a632a''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.56'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,175,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:31.875 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:32.157 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:32.157 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:49.559 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:49.559 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:49.684 | General Service|:: CompanyIndex:175 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:49.684 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:49.871 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:49.887 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:49.903 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:49.918 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:49.934 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:49.934 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:49.996 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:49.996 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:49.996 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:49.996 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:50.121 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:50.121 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:50.543 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:50.543 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:50.590 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:50.606 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:50.637 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''18 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:50.637 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:50.715 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:50.715 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:50.887 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:50.902 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:51.390 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:51.406 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:51.453 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'VIEW'
 ,1
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:16:51.468 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:28.860 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,26
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:28.860 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:28.938 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60634
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:28.938 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60654
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:28.938 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60645
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:28.938 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60479
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:28.938 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60648
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:28.938 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:28.954 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:28.938 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:28.954 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:28.954 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60642
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:28.954 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:28.954 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:28.970 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60639
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:28.970 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:29.095 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60634'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:29.095 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:29.266 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:29.282 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:29.832 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60654'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:29.832 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:30.066 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 93
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:30.066 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:30.847 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60642'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:30.847 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:31.182 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60639'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:31.197 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:31.260 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60645'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:31.276 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:31.354 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60648'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:31.354 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:31.479 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60479'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:31.479 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:31.635 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:31.635 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:31.635 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT T1.Status [C79eebe0c82e645b8b5cb15cf118fdbda],T2.Name [Cb65d125f6f8e4b2e872ecac79384e70c],T0.Code [C34128223803245bfb7e19666e9cf1fb1],T3.Name [C5abb5da777704276a594261c08a3fceb],case when T0.UnitStatus is not null and isnumeric(T0.UnitStatus)=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID=T0.UnitStatus) else '''' end [Cf07e1f52867b47ba9962da1105760d12]
 FROM REN_Units T0 with(nolock) left join COM_Status T1 with(nolock) on T0.Status=T1.StatusID left join REN_Property T2 with(nolock) on T0.PropertyID=T2.NodeID left join COM_Location T3 with(nolock) on T0.LocationID=T3.NodeID
 WHERE T3.NodeID IN (1,22,10,11,25,26,27,28,29,30,31) AND T1.Status=''In Active'' ORDER BY [C79eebe0c82e645b8b5cb15cf118fdbda] '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:31.635 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:31.651 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:31.666 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:31.682 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:31.682 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:31.713 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 

'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:31.713 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424  AND RU.ContractID=0 AND RU.IsGroup=0 
AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:31.713 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE
select * ,convert(decimal(18,2), (convert(float,Vacant)/convert(float,NoOfUnits))) *100 [Vacant%]
from (

SELECT Property,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0 AND RU.Status=424 
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

GROUP BY Property
) a order by Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:31.713 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:31.713 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:31.713 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:54.027 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:17:54.027 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:18:51.485 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:18:51.485 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:19:51.488 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:19:51.488 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzI3OTEsImV4cCI6MTc1MDI2MTU5MSwiaWF0IjoxNzUwMjMyNzkxfQ.whuc6gL8cbCPa_Riaho293_9CJL9tanViILbjqr2uXs'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:20:46.947 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 13:20:47.057 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:20:54.353 | General Service|:: CompanyIndex:175 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'25.9.2'
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 13:20:54.384 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,175
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:20:54.416 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,175
[System: 192.168.1.56] DEBUG | 06-18-2025 13:20:54.416 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:20:54.416 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:20:54.494 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''d7b7959a-79d2-4914-9be8-66e0716a18c8''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.56'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,175,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 13:20:54.494 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:20:54.540 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:20:54.540 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:09.701 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:09.717 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:09.889 | General Service|:: CompanyIndex:175 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:09.889 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:10.092 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:10.092 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:10.107 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:10.107 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:10.139 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:10.139 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:10.482 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:10.482 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:10.482 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:10.498 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:10.592 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:10.592 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:10.986 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:10.986 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:11.361 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:11.377 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:11.424 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''18 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:11.424 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:11.517 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:11.517 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:11.924 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:11.924 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:12.236 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:12.236 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:12.267 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'VIEW'
 ,1
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:12.267 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:24.058 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,26
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:24.058 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:24.105 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60634
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:24.105 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60654
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:24.120 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60645
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:24.120 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60642
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:24.120 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:24.120 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60648
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:24.120 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:24.120 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:24.120 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:24.120 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:24.120 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60479
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:24.120 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:24.245 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60639
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:24.245 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:24.339 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60634'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:24.355 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:24.495 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:24.495 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:24.761 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60654'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:24.761 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:25.058 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 93
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:25.058 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:25.183 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60642'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:25.183 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:25.245 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60639'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:25.245 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:25.323 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60645'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:25.323 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:25.386 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60648'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:25.386 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:25.464 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60479'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:25.464 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:25.589 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:25.604 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:25.604 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT T1.Status [C79eebe0c82e645b8b5cb15cf118fdbda],T2.Name [Cb65d125f6f8e4b2e872ecac79384e70c],T0.Code [C34128223803245bfb7e19666e9cf1fb1],T3.Name [C5abb5da777704276a594261c08a3fceb],case when T0.UnitStatus is not null and isnumeric(T0.UnitStatus)=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID=T0.UnitStatus) else '''' end [Cf07e1f52867b47ba9962da1105760d12]
 FROM REN_Units T0 with(nolock) left join COM_Status T1 with(nolock) on T0.Status=T1.StatusID left join REN_Property T2 with(nolock) on T0.PropertyID=T2.NodeID left join COM_Location T3 with(nolock) on T0.LocationID=T3.NodeID
 WHERE T3.NodeID IN (1,22,10,11,25,26,27,28,29,30,31) AND T1.Status=''In Active'' ORDER BY [C79eebe0c82e645b8b5cb15cf118fdbda] '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:25.620 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:25.636 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:25.636 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:25.651 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:25.651 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:25.667 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424  AND RU.ContractID=0 AND RU.IsGroup=0 
AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:25.667 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:25.667 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 

'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:25.667 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:25.682 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE
select * ,convert(decimal(18,2), (convert(float,Vacant)/convert(float,NoOfUnits))) *100 [Vacant%]
from (

SELECT Property,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0 AND RU.Status=424 
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

GROUP BY Property
) a order by Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:21:25.682 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:12.081 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:12.081 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMwNTQsImV4cCI6MTc1MDI2MTg1NCwiaWF0IjoxNzUwMjMzMDU0fQ.ESqH2bTRZKvjueLyxaqMGxYu5xUQae_J3ruwe0S-BuU'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:40.653 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:40.747 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:44.475 | General Service|:: CompanyIndex:175 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'25.9.2'
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:44.522 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,175
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:44.537 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,175
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:44.537 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:44.537 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:44.585 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''8f4a5e1d-1e56-494f-abc0-3005ce2bfb84''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.56'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,175,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:44.585 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:44.616 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:44.631 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:50.268 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:50.283 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:50.455 | General Service|:: CompanyIndex:175 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:50.455 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:50.643 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:50.658 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:50.705 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:50.705 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:50.721 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:50.721 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:50.799 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:50.799 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:50.799 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:50.815 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:50.893 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:50.893 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:50.986 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:50.986 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:51.033 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:51.033 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:51.064 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''18 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:51.064 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:51.080 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:51.080 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:51.268 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:51.268 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:51.518 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:51.518 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:51.705 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'VIEW'
 ,1
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:22:51.705 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.123 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,26
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.123 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.154 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60634
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.154 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60654
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.154 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60639
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.154 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.154 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.154 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60642
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.154 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.169 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.169 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60648
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.169 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.169 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60645
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.169 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.169 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60479
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.169 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.279 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60634'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.279 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.419 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.419 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.576 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60654'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.591 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.607 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 93
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.622 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.669 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60642'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.685 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.732 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60639'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.732 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.794 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60645'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.810 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.888 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60648'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.888 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.904 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.904 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.966 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60479'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:07.982 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:08.075 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT T1.Status [C79eebe0c82e645b8b5cb15cf118fdbda],T2.Name [Cb65d125f6f8e4b2e872ecac79384e70c],T0.Code [C34128223803245bfb7e19666e9cf1fb1],T3.Name [C5abb5da777704276a594261c08a3fceb],case when T0.UnitStatus is not null and isnumeric(T0.UnitStatus)=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID=T0.UnitStatus) else '''' end [Cf07e1f52867b47ba9962da1105760d12]
 FROM REN_Units T0 with(nolock) left join COM_Status T1 with(nolock) on T0.Status=T1.StatusID left join REN_Property T2 with(nolock) on T0.PropertyID=T2.NodeID left join COM_Location T3 with(nolock) on T0.LocationID=T3.NodeID
 WHERE T3.NodeID IN (1,22,10,11,25,26,27,28,29,30,31) AND T1.Status=''In Active'' ORDER BY [C79eebe0c82e645b8b5cb15cf118fdbda] '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:08.091 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:08.107 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:08.107 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:08.122 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:08.122 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:08.138 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424  AND RU.ContractID=0 AND RU.IsGroup=0 
AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:08.138 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:08.154 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 

'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:08.169 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:08.169 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE
select * ,convert(decimal(18,2), (convert(float,Vacant)/convert(float,NoOfUnits))) *100 [Vacant%]
from (

SELECT Property,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0 AND RU.Status=424 
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

GROUP BY Property
) a order by Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:08.169 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:12.173 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60635
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:12.173 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:12.199 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60635
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:12.199 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:13.311 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID , sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
group by Property ,Property_ID'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:13.326 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:51.345 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:23:51.361 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:24:51.350 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:24:51.397 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:25:51.140 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:25:51.140 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:26:26.046 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60635
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:26:26.046 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:26:26.062 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60635
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:26:26.077 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:26:26.312 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID , sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
group by Property ,Property_ID'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:26:26.312 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:26:29.586 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60643
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:26:29.601 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:26:29.695 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60643
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:26:29.695 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:26:29.945 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID,SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied''
Group By Property,Property_ID
Order By Property'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:26:29.945 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:26:51.235 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:26:51.235 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzMxNjQsImV4cCI6MTc1MDI2MTk2NCwiaWF0IjoxNzUwMjMzMTY0fQ.DUKtDFLDlnt51iyW-uVXkOvwLuD3gzh0_6gFNdSJB_c'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:27:57.148 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 13:27:57.226 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:00.538 | General Service|:: CompanyIndex:175 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'25.9.2'
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:00.569 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,175
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:00.569 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,175
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:00.585 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:00.585 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:00.632 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''56f1bda8-1280-45a9-aaaf-9c39b04dc32d''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.56'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,175,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:00.632 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:00.694 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:00.694 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:03.428 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:03.428 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:03.632 | General Service|:: CompanyIndex:175 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:03.647 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:03.866 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:03.866 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:03.881 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:03.897 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:03.913 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:03.913 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:03.960 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:03.975 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:03.975 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:03.975 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:04.069 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:04.069 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:04.163 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:04.163 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:04.210 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:04.210 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:04.256 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''18 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:04.256 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:04.272 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:04.288 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:04.335 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:04.350 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:04.663 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:04.663 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:04.694 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'VIEW'
 ,1
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:04.694 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:13.855 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,26
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:13.855 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:13.886 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60634
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:13.886 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60654
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:13.902 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60639
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:13.902 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60645
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:13.902 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60642
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:13.902 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:13.902 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:13.902 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:13.917 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60479
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:13.917 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:13.917 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:13.917 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:13.917 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60648
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:13.933 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.011 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60634'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.027 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.245 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.245 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.339 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60654'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.339 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.371 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 93
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.386 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.449 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60642'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.464 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.511 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60639'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.527 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.574 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60645'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.574 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.636 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60648'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.636 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.698 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60479'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.698 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.792 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT T1.Status [C79eebe0c82e645b8b5cb15cf118fdbda],T2.Name [Cb65d125f6f8e4b2e872ecac79384e70c],T0.Code [C34128223803245bfb7e19666e9cf1fb1],T3.Name [C5abb5da777704276a594261c08a3fceb],case when T0.UnitStatus is not null and isnumeric(T0.UnitStatus)=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID=T0.UnitStatus) else '''' end [Cf07e1f52867b47ba9962da1105760d12]
 FROM REN_Units T0 with(nolock) left join COM_Status T1 with(nolock) on T0.Status=T1.StatusID left join REN_Property T2 with(nolock) on T0.PropertyID=T2.NodeID left join COM_Location T3 with(nolock) on T0.LocationID=T3.NodeID
 WHERE T3.NodeID IN (1,22,10,11,25,26,27,28,29,30,31) AND T1.Status=''In Active'' ORDER BY [C79eebe0c82e645b8b5cb15cf118fdbda] '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.792 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.808 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.808 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.808 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.823 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.823 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.823 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.839 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 

'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.839 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.839 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE
select * ,convert(decimal(18,2), (convert(float,Vacant)/convert(float,NoOfUnits))) *100 [Vacant%]
from (

SELECT Property,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0 AND RU.Status=424 
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

GROUP BY Property
) a order by Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.855 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.870 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424  AND RU.ContractID=0 AND RU.IsGroup=0 
AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:14.870 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:19.100 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60643
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:19.100 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:19.131 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60643
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:19.147 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:19.287 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID,SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied''
Group By Property,Property_ID
Order By Property'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:28:19.287 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:04.366 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:04.381 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM0ODAsImV4cCI6MTc1MDI2MjI4MCwiaWF0IjoxNzUwMjMzNDgwfQ.QyV0YTd4oIPE7jlhVpQaNgUt5LK_GYQ3Yq2yITddD8I'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:12.886 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:12.964 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:17.540 | General Service|:: CompanyIndex:175 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'25.9.2'
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:17.603 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,175
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:17.618 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,175
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:17.618 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:17.634 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:17.681 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''1e23e971-f16f-48e8-b857-0da79dac03aa''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.56'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,175,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:17.681 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:17.712 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:17.712 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:20.461 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:20.461 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:20.695 | General Service|:: CompanyIndex:175 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:20.695 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:20.900 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:20.900 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:20.915 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:20.931 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:20.946 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:20.946 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:21.024 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:21.024 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:21.024 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:21.040 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:21.134 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:21.149 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:21.274 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:21.274 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:21.321 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:21.321 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:21.353 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''18 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:21.353 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:21.368 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:21.368 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:21.431 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:21.431 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:21.743 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:21.743 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:21.790 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'VIEW'
 ,1
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:21.790 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.008 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,26
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.008 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.039 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60654
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.039 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60634
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.055 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60639
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.055 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60642
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.055 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.055 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60645
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.055 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.055 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.055 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.055 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.055 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60648
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.055 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.055 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60479
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.070 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.149 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60634'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.164 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.320 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.320 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.414 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60654'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.414 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.445 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 93
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.445 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.492 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60642'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.508 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.555 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60639'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.555 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.602 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60645'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.617 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.680 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60648'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.680 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.742 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60479'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.742 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.773 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.773 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.852 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT T1.Status [C79eebe0c82e645b8b5cb15cf118fdbda],T2.Name [Cb65d125f6f8e4b2e872ecac79384e70c],T0.Code [C34128223803245bfb7e19666e9cf1fb1],T3.Name [C5abb5da777704276a594261c08a3fceb],case when T0.UnitStatus is not null and isnumeric(T0.UnitStatus)=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID=T0.UnitStatus) else '''' end [Cf07e1f52867b47ba9962da1105760d12]
 FROM REN_Units T0 with(nolock) left join COM_Status T1 with(nolock) on T0.Status=T1.StatusID left join REN_Property T2 with(nolock) on T0.PropertyID=T2.NodeID left join COM_Location T3 with(nolock) on T0.LocationID=T3.NodeID
 WHERE T3.NodeID IN (1,22,10,11,25,26,27,28,29,30,31) AND T1.Status=''In Active'' ORDER BY [C79eebe0c82e645b8b5cb15cf118fdbda] '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.852 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.899 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE
select * ,convert(decimal(18,2), (convert(float,Vacant)/convert(float,NoOfUnits))) *100 [Vacant%]
from (

SELECT Property,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0 AND RU.Status=424 
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

GROUP BY Property
) a order by Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.977 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.852 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.883 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424  AND RU.ContractID=0 AND RU.IsGroup=0 
AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.977 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.977 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.899 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 

'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.992 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.992 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:28.992 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:31.696 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60643
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:31.696 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:31.727 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60643
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:31.727 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:31.852 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID,SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied''
Group By Property,Property_ID
Order By Property'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:29:31.852 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:30:21.604 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:30:21.604 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:31:22.484 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:31:22.484 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM1NTcsImV4cCI6MTc1MDI2MjM1NywiaWF0IjoxNzUwMjMzNTU3fQ.53s7OAsuvOhRy8oeXuQGn2G7fgxyssEq6or9BqxgbyA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:31:58.994 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 13:31:59.088 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:02.631 | General Service|:: CompanyIndex:175 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'25.9.2'
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:02.647 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,175
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:02.662 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,175
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:02.662 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:02.662 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:02.694 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''78d50eb9-ac5d-4bf0-a6c8-bacdadaa487e''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.56'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,175,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:02.694 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:02.725 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:02.725 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:05.232 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:05.232 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:05.576 | General Service|:: CompanyIndex:175 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:05.576 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:05.786 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:05.801 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:05.817 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:05.817 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:05.833 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:05.848 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:05.911 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:05.911 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:05.911 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:05.911 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:06.020 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:06.020 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:06.223 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:06.223 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:06.270 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:06.286 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:06.317 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''18 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:06.317 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:06.348 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:06.348 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:06.442 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:06.442 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:06.757 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:06.757 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:06.789 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'VIEW'
 ,1
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:06.789 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:11.530 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,26
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:11.530 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:11.577 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60642
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:11.577 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60634
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:11.577 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60639
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:11.577 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60479
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:11.577 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60654
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:11.577 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60645
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:11.577 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:11.577 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:11.577 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:11.577 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:11.577 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:11.593 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:11.593 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60648
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:11.593 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:11.686 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60634'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:11.686 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:12.171 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:12.171 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:12.296 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60654'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:12.296 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:12.327 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 93
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:12.342 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:12.421 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60642'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:12.421 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:12.468 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60639'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:12.639 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:12.733 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60645'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:12.749 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:12.795 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60648'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:12.795 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:12.863 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60479'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:12.863 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:12.973 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT T1.Status [C79eebe0c82e645b8b5cb15cf118fdbda],T2.Name [Cb65d125f6f8e4b2e872ecac79384e70c],T0.Code [C34128223803245bfb7e19666e9cf1fb1],T3.Name [C5abb5da777704276a594261c08a3fceb],case when T0.UnitStatus is not null and isnumeric(T0.UnitStatus)=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID=T0.UnitStatus) else '''' end [Cf07e1f52867b47ba9962da1105760d12]
 FROM REN_Units T0 with(nolock) left join COM_Status T1 with(nolock) on T0.Status=T1.StatusID left join REN_Property T2 with(nolock) on T0.PropertyID=T2.NodeID left join COM_Location T3 with(nolock) on T0.LocationID=T3.NodeID
 WHERE T3.NodeID IN (1,22,10,11,25,26,27,28,29,30,31) AND T1.Status=''In Active'' ORDER BY [C79eebe0c82e645b8b5cb15cf118fdbda] '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:12.973 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:12.973 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:12.988 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:12.988 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:12.988 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:12.988 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:13.004 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:13.019 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424  AND RU.ContractID=0 AND RU.IsGroup=0 
AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:13.019 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:13.019 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 

'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:13.019 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:13.019 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE
select * ,convert(decimal(18,2), (convert(float,Vacant)/convert(float,NoOfUnits))) *100 [Vacant%]
from (

SELECT Property,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0 AND RU.Status=424 
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

GROUP BY Property
) a order by Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:13.035 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:14.738 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60643
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:14.738 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:14.769 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60643
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:14.769 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:14.910 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID,SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied''
Group By Property,Property_ID
Order By Property'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:14.910 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:46.383 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60635
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:46.399 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:46.414 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60635
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:46.414 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:46.586 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID , sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
group by Property ,Property_ID'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:32:46.586 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:33:06.508 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:33:06.508 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:33:42.042 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60643
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:33:42.042 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:33:42.058 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60643
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:33:42.089 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:33:42.245 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID,SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied''
Group By Property,Property_ID
Order By Property'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:33:42.245 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:34:06.443 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:34:06.443 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:34:26.258 | General Service|:: CompanyIndex:175 SpName: spDOC_GetDocumentDefinition 
 40024
 ,NULL
 ,NULL
 ,''
 ,1
 ,'admin'
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:34:26.273 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:34:26.648 | General Service|:: CompanyIndex:175 SpName: spADM_GetCostCenterListViewData 
 268
 ,'a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:34:26.648 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:34:26.711 | General Service|:: CompanyIndex:175 SpName: spADM_GetCostCenterListViewData 
 268
 ,'a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:34:26.711 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:34:26.929 | General Service|:: CompanyIndex:175 SpName: spADM_GetCostCenterListViewData 
 143
 ,'a.AccountName,a.AccountCode,at.accounttype AccountTypeID'
 ,''
 ,' LEFT JOIN acc_accounttypes at WITH(NOLOCK)  on  at.AccountTypeid=a.AccountTypeid  '
 ,'AccountName'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,'(a.AccountName like  N''%{0}%''  escape ''\'' )'
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:34:26.929 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:34:27.023 | General Service|:: CompanyIndex:175 SpName: spADM_GetCostCenterListViewData 
 268
 ,'a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:34:27.023 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:34:27.101 | General Service|:: CompanyIndex:175 SpName: spADM_GetCostCenterListViewData 
 643
 ,'a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:34:27.117 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:34:27.164 | General Service|:: CompanyIndex:175 SpName: spADM_GetCostCenterListViewData 
 646
 ,'a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:34:27.164 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:34:27.226 | General Service|:: CompanyIndex:175 SpName: spADM_GetCostCenterListViewData 
 659
 ,'a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:34:27.226 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:34:27.257 | General Service|:: CompanyIndex:175 SpName: spADM_GetCostCenterListViewData 
 643
 ,'a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:34:27.257 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:34:27.304 | General Service|:: CompanyIndex:175 SpName: spADM_GetCostCenterListViewData 
 656
 ,'a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:34:27.304 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:34:27.445 | General Service|:: CompanyIndex:175 SpName: spADM_GetCostCenterListViewData 
 35
 ,'a.ProductName,a.ProductCode'
 ,''
 ,''
 ,'ProductName'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:34:27.445 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:35:06.429 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:35:06.429 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:36:07.315 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:36:07.315 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:37:06.278 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 13:37:06.278 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:37:07.231 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:37:07.246 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:38:07.311 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:38:07.342 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:39:07.309 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:39:07.309 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:40:08.326 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:40:08.326 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:41:09.324 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:41:09.340 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:42:06.277 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 13:42:06.277 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:42:49.398 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:42:49.398 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:43:49.322 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:43:49.322 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:44:49.362 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:44:49.362 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:45:49.330 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:45:49.330 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:46:49.334 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:46:49.350 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:47:03.228 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''78d50eb9-ac5d-4bf0-a6c8-bacdadaa487e''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 13:47:03.228 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:47:06.197 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 13:47:06.197 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:47:49.327 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:47:49.343 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:48:49.330 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:48:49.330 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:49:49.313 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:49:49.313 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:50:49.319 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:50:49.319 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:51:49.318 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:51:49.318 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:52:06.202 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 13:52:06.202 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:52:49.316 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:52:49.316 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:53:49.358 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:53:49.358 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:54:49.338 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:54:49.338 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:55:49.323 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:55:49.323 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:56:49.312 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:56:49.312 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:57:06.199 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 13:57:06.199 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:57:49.311 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:57:49.311 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:58:49.344 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:58:49.344 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:59:49.340 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 13:59:49.340 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:00:49.343 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:00:49.343 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:01:49.323 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:01:49.323 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:02:03.226 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''78d50eb9-ac5d-4bf0-a6c8-bacdadaa487e''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 14:02:03.226 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:02:06.198 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 14:02:06.213 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:02:49.316 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:02:49.332 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:03:49.320 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:03:49.335 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:04:49.336 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:04:49.336 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:05:49.349 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:05:49.365 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:06:49.336 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:06:49.336 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:07:49.285 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 14:07:49.300 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:07:49.347 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:07:49.347 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:08:49.316 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:08:49.332 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:09:49.321 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:09:49.321 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:10:49.318 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:10:49.333 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:11:49.383 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:11:49.383 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:12:49.287 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 14:12:49.287 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:12:49.334 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:12:49.350 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:13:49.349 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:13:49.349 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:14:49.322 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:14:49.338 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:15:49.323 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:15:49.339 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:16:49.326 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:16:49.326 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:17:03.226 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''78d50eb9-ac5d-4bf0-a6c8-bacdadaa487e''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 14:17:03.226 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:17:49.299 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 14:17:49.315 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:17:49.362 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:17:49.362 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:18:49.332 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:18:49.332 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:19:49.342 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:19:49.342 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:20:49.334 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:20:49.334 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:21:49.328 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:21:49.328 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:22:49.315 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 14:22:49.315 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:22:49.362 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:22:49.362 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:23:07.250 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:23:07.250 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:24:06.432 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:24:06.447 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:25:07.238 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:25:07.254 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzM3MjIsImV4cCI6MTc1MDI2MjUyMiwiaWF0IjoxNzUwMjMzNzIyfQ.mGyhKHb5Ok9XLyA_lA1FL5xwYHI4lMfSwj4OJkr8xQw'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:07.975 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:08.085 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:11.514 | General Service|:: CompanyIndex:175 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'25.9.2'
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:11.560 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,175
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:11.670 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,175
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:11.685 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:11.685 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:11.717 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''487a3bc3-6a8a-41ff-a554-36921cd1b82b''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.56'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,175,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:11.732 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:11.795 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:11.795 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:14.708 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:14.723 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:14.879 | General Service|:: CompanyIndex:175 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:14.879 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:15.067 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:15.067 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:15.083 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:15.098 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:15.114 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:15.114 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:15.161 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:15.161 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:15.161 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:15.161 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:15.239 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:15.254 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:15.395 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:15.395 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:15.461 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:15.461 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:15.508 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''18 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:15.508 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:15.539 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:15.539 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:15.602 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:15.602 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:15.914 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:15.914 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:15.945 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'VIEW'
 ,1
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:15.961 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:24.470 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,26
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:24.470 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:24.502 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60634
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:24.502 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60654
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:24.502 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60639
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:24.517 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60645
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:24.517 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:24.517 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60648
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:24.517 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:24.517 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:24.517 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:24.517 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60642
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:24.517 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:24.517 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:24.533 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60479
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:24.533 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:24.626 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60634'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:24.626 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:24.783 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:24.783 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:24.908 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60654'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:24.908 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:24.939 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 93
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:24.939 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:25.017 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60642'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:25.017 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:25.080 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60639'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:25.080 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:25.142 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60645'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:25.158 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:25.204 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60648'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:25.220 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:25.283 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60479'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:25.283 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:25.298 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:25.298 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:25.361 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT T1.Status [C79eebe0c82e645b8b5cb15cf118fdbda],T2.Name [Cb65d125f6f8e4b2e872ecac79384e70c],T0.Code [C34128223803245bfb7e19666e9cf1fb1],T3.Name [C5abb5da777704276a594261c08a3fceb],case when T0.UnitStatus is not null and isnumeric(T0.UnitStatus)=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID=T0.UnitStatus) else '''' end [Cf07e1f52867b47ba9962da1105760d12]
 FROM REN_Units T0 with(nolock) left join COM_Status T1 with(nolock) on T0.Status=T1.StatusID left join REN_Property T2 with(nolock) on T0.PropertyID=T2.NodeID left join COM_Location T3 with(nolock) on T0.LocationID=T3.NodeID
 WHERE T3.NodeID IN (1,22,10,11,25,26,27,28,29,30,31) AND T1.Status=''In Active'' ORDER BY [C79eebe0c82e645b8b5cb15cf118fdbda] '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:25.361 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:25.376 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:25.376 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:25.392 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:25.392 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:25.408 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424  AND RU.ContractID=0 AND RU.IsGroup=0 
AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:25.423 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:25.454 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 

'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:25.454 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:25.470 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE
select * ,convert(decimal(18,2), (convert(float,Vacant)/convert(float,NoOfUnits))) *100 [Vacant%]
from (

SELECT Property,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0 AND RU.Status=424 
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

GROUP BY Property
) a order by Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:25.470 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:27.706 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60643
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:27.721 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:27.737 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60643
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:27.737 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:27.893 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID,SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied''
Group By Property,Property_ID
Order By Property'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:26:27.893 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:27:15.727 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:27:15.727 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:28:15.742 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:28:15.742 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:29:15.607 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:29:15.607 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:30:16.253 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:30:16.253 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzY5NzEsImV4cCI6MTc1MDI2NTc3MSwiaWF0IjoxNzUwMjM2OTcxfQ.t3NH3NloKhFW9IMXtnjWcXr_e3oYukKD6pjhesk-Ryo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:33.982 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:34.107 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:37.623 | General Service|:: CompanyIndex:175 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'25.9.2'
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:37.654 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,175
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:37.701 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,175
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:37.701 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:37.717 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:37.748 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''cdccae54-af2d-433e-b2ff-52b99919a317''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.56'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,175,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:37.748 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:37.779 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:37.779 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:43.965 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:43.965 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:44.137 | General Service|:: CompanyIndex:175 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:44.137 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:44.340 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:44.340 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:44.356 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:44.356 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:44.387 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:44.387 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:44.434 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:44.434 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:44.434 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:44.449 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:44.528 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:44.543 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:44.652 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:44.668 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:44.715 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:44.715 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:44.762 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''18 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:44.762 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:44.793 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:44.793 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:44.996 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:44.996 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:45.153 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:45.153 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:45.184 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'VIEW'
 ,1
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:45.184 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:51.597 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,26
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:51.597 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:51.628 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60634
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:51.628 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60639
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:51.644 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60479
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:51.644 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:51.644 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60642
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:51.644 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:51.644 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:51.644 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60654
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:51.644 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:51.644 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:51.644 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60648
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:51.644 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60645
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:51.644 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:51.659 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:51.753 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60634'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:51.753 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:51.909 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:51.909 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.019 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60654'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.019 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.050 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 93
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.050 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.128 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60642'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.128 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.175 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60639'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.175 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.237 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60645'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.237 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.331 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60648'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.331 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.409 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60479'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.409 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.441 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.441 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.503 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT T1.Status [C79eebe0c82e645b8b5cb15cf118fdbda],T2.Name [Cb65d125f6f8e4b2e872ecac79384e70c],T0.Code [C34128223803245bfb7e19666e9cf1fb1],T3.Name [C5abb5da777704276a594261c08a3fceb],case when T0.UnitStatus is not null and isnumeric(T0.UnitStatus)=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID=T0.UnitStatus) else '''' end [Cf07e1f52867b47ba9962da1105760d12]
 FROM REN_Units T0 with(nolock) left join COM_Status T1 with(nolock) on T0.Status=T1.StatusID left join REN_Property T2 with(nolock) on T0.PropertyID=T2.NodeID left join COM_Location T3 with(nolock) on T0.LocationID=T3.NodeID
 WHERE T3.NodeID IN (1,22,10,11,25,26,27,28,29,30,31) AND T1.Status=''In Active'' ORDER BY [C79eebe0c82e645b8b5cb15cf118fdbda] '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.503 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.518 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.518 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.518 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.534 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.550 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424  AND RU.ContractID=0 AND RU.IsGroup=0 
AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.550 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.550 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 

'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.565 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.581 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE
select * ,convert(decimal(18,2), (convert(float,Vacant)/convert(float,NoOfUnits))) *100 [Vacant%]
from (

SELECT Property,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0 AND RU.Status=424 
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

GROUP BY Property
) a order by Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:52.581 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:54.565 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60643
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:54.565 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:54.596 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60643
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:54.596 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:54.768 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID,SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied''
Group By Property,Property_ID
Order By Property'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:31:54.768 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:04.538 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60635
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:04.538 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:04.554 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60635
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:04.569 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:04.757 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID , sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
group by Property ,Property_ID'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:04.773 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:20.549 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60649
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:20.549 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:20.565 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60649
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:20.565 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:20.753 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID,SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 
Group By Property,Property_ID
Order By Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:20.768 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:29.318 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60640
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:29.318 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:29.318 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60640
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:29.318 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:29.506 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID, Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant''
Group By property,Property_ID
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:29.506 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.084 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,26
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.084 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.115 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60654
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.131 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60642
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.131 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60634
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.131 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60639
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.131 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.131 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.131 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.131 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60645
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.147 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.147 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.147 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60648
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.147 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60479
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.147 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.147 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.240 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60634'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.256 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.334 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60654'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.334 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.365 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 93
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.365 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.443 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60642'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.443 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.459 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.459 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.490 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60639'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.490 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.553 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60645'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.553 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT T1.Status [C79eebe0c82e645b8b5cb15cf118fdbda],T2.Name [Cb65d125f6f8e4b2e872ecac79384e70c],T0.Code [C34128223803245bfb7e19666e9cf1fb1],T3.Name [C5abb5da777704276a594261c08a3fceb],case when T0.UnitStatus is not null and isnumeric(T0.UnitStatus)=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID=T0.UnitStatus) else '''' end [Cf07e1f52867b47ba9962da1105760d12]
 FROM REN_Units T0 with(nolock) left join COM_Status T1 with(nolock) on T0.Status=T1.StatusID left join REN_Property T2 with(nolock) on T0.PropertyID=T2.NodeID left join COM_Location T3 with(nolock) on T0.LocationID=T3.NodeID
 WHERE T3.NodeID IN (1,22,10,11,25,26,27,28,29,30,31) AND T1.Status=''In Active'' ORDER BY [C79eebe0c82e645b8b5cb15cf118fdbda] '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.553 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.553 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.615 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60648'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.615 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.693 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.693 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.693 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60479'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.693 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.803 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.818 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.818 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424  AND RU.ContractID=0 AND RU.IsGroup=0 
AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.834 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.834 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 

'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.850 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.850 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE
select * ,convert(decimal(18,2), (convert(float,Vacant)/convert(float,NoOfUnits))) *100 [Vacant%]
from (

SELECT Property,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0 AND RU.Status=424 
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

GROUP BY Property
) a order by Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:39.850 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:42.677 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60646
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:42.677 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:42.693 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60646
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:42.708 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:42.865 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID,SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired''
Group By Property,Property_ID
Order By Property'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:42.865 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:44.861 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:32:44.861 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzcyOTcsImV4cCI6MTc1MDI2NjA5NywiaWF0IjoxNzUwMjM3Mjk3fQ.s4mIc3KU5RygxJnl5h77n_Kt0ouoPt65YTEq72XIl48'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:28.984 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:29.062 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:34.303 | General Service|:: CompanyIndex:175 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'25.9.2'
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:34.334 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,175
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:34.350 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,175
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:34.365 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:34.365 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:34.397 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''aace430b-9282-4a9c-9e26-cd8ba0bc5f3a''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.56'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,175,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:34.397 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:34.443 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:34.443 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:36.972 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:36.987 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:37.144 | General Service|:: CompanyIndex:175 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:37.144 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:37.334 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:37.334 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:37.412 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:37.428 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:37.522 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:37.522 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:37.615 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:37.615 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:37.631 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:37.631 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:37.709 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:37.709 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:37.912 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:37.912 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:38.053 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:38.068 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:38.100 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''18 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:38.115 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:38.209 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:38.209 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:38.303 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:38.318 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:38.591 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:38.591 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:38.622 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'VIEW'
 ,1
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:38.622 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.359 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,26
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.359 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.390 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60634
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.390 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60639
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.390 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60642
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.390 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.390 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60645
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.390 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.390 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.406 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.406 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60479
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.406 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60654
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.406 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.406 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.406 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60648
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.406 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.515 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60634'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.531 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.672 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.672 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.797 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60654'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.797 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.828 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 93
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.828 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.890 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60642'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.890 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.953 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60639'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:48.953 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:49.000 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60645'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:49.015 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:49.062 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60648'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:49.062 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:49.140 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60479'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:49.140 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:49.156 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:49.156 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:49.218 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT T1.Status [C79eebe0c82e645b8b5cb15cf118fdbda],T2.Name [Cb65d125f6f8e4b2e872ecac79384e70c],T0.Code [C34128223803245bfb7e19666e9cf1fb1],T3.Name [C5abb5da777704276a594261c08a3fceb],case when T0.UnitStatus is not null and isnumeric(T0.UnitStatus)=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID=T0.UnitStatus) else '''' end [Cf07e1f52867b47ba9962da1105760d12]
 FROM REN_Units T0 with(nolock) left join COM_Status T1 with(nolock) on T0.Status=T1.StatusID left join REN_Property T2 with(nolock) on T0.PropertyID=T2.NodeID left join COM_Location T3 with(nolock) on T0.LocationID=T3.NodeID
 WHERE T3.NodeID IN (1,22,10,11,25,26,27,28,29,30,31) AND T1.Status=''In Active'' ORDER BY [C79eebe0c82e645b8b5cb15cf118fdbda] '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:49.218 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:49.234 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:49.234 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:49.250 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:49.250 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:49.281 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424  AND RU.ContractID=0 AND RU.IsGroup=0 
AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:49.281 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:49.297 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 

'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:49.297 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:49.312 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE
select * ,convert(decimal(18,2), (convert(float,Vacant)/convert(float,NoOfUnits))) *100 [Vacant%]
from (

SELECT Property,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0 AND RU.Status=424 
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

GROUP BY Property
) a order by Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:49.312 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:51.984 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60635
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:52.000 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:52.015 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60635
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:52.015 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:52.172 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID , sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
group by Property ,Property_ID'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:33:52.188 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0MTQsImV4cCI6MTc1MDI2NjIxNCwiaWF0IjoxNzUwMjM3NDE0fQ.OIK0Z_aeVPlngJM8CYa5GvgEEot1aK2KWWuH-UPNr1g'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:45.113 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:45.175 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:48.655 | General Service|:: CompanyIndex:175 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'25.9.2'
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:48.686 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,175
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:48.686 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,175
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:48.702 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:48.702 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:48.749 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''2acaf976-27ca-448c-b209-80bba9c7f771''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.56'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,175,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:48.749 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:48.795 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:48.795 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:51.267 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:51.267 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:51.439 | General Service|:: CompanyIndex:175 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:51.439 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:51.627 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:51.642 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:51.658 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:51.658 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:51.689 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:51.689 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:51.736 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:51.736 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:51.751 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:51.751 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:51.845 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:51.845 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:51.954 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:51.954 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:52.017 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:52.017 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:52.064 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''18 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:52.064 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:52.079 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:52.079 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:52.142 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:52.142 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:52.439 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:52.439 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:52.470 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'VIEW'
 ,1
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:52.470 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.216 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,26
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.231 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.247 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60654
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.247 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60634
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.263 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60642
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.263 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.263 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60639
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.263 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.263 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.263 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.263 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60645
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.263 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60648
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.263 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.278 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.278 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60479
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.278 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.372 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60634'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.388 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.544 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.544 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.653 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60654'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.653 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.685 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 93
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.685 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.732 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60642'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.747 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.794 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60639'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.794 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.856 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60645'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.856 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.919 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60648'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.934 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.997 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60479'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:58.997 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:59.013 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:59.028 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:59.075 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT T1.Status [C79eebe0c82e645b8b5cb15cf118fdbda],T2.Name [Cb65d125f6f8e4b2e872ecac79384e70c],T0.Code [C34128223803245bfb7e19666e9cf1fb1],T3.Name [C5abb5da777704276a594261c08a3fceb],case when T0.UnitStatus is not null and isnumeric(T0.UnitStatus)=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID=T0.UnitStatus) else '''' end [Cf07e1f52867b47ba9962da1105760d12]
 FROM REN_Units T0 with(nolock) left join COM_Status T1 with(nolock) on T0.Status=T1.StatusID left join REN_Property T2 with(nolock) on T0.PropertyID=T2.NodeID left join COM_Location T3 with(nolock) on T0.LocationID=T3.NodeID
 WHERE T3.NodeID IN (1,22,10,11,25,26,27,28,29,30,31) AND T1.Status=''In Active'' ORDER BY [C79eebe0c82e645b8b5cb15cf118fdbda] '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:59.091 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:59.091 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:59.106 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:59.122 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:59.138 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:59.138 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424  AND RU.ContractID=0 AND RU.IsGroup=0 
AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:59.153 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 

'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:59.153 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:59.153 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:59.169 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE
select * ,convert(decimal(18,2), (convert(float,Vacant)/convert(float,NoOfUnits))) *100 [Vacant%]
from (

SELECT Property,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0 AND RU.Status=424 
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

GROUP BY Property
) a order by Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:34:59.169 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:35:00.153 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60635
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:35:00.153 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:35:00.153 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60635
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:35:00.169 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:35:00.340 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID , sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
group by Property ,Property_ID'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:35:00.340 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:35:08.249 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60643
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:35:08.249 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:35:08.265 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60643
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:35:08.265 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:35:08.405 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID,SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied''
Group By Property,Property_ID
Order By Property'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:35:08.405 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:35:53.614 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:35:53.614 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:36:52.144 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:36:52.144 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:37:52.244 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:37:52.244 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc0ODgsImV4cCI6MTc1MDI2NjI4OCwiaWF0IjoxNzUwMjM3NDg4fQ.ADIYlZlMu-8iTqr3FfZrkaltqiT7fsvMq27TipxDd8E'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:22.673 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:22.766 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:27.306 | General Service|:: CompanyIndex:175 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'25.9.2'
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:27.338 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,175
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:27.353 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,175
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:27.369 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:27.369 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:27.400 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''127bbe15-d93a-4555-9945-129f20714cd5''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.56'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,175,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:27.416 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:27.478 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:27.478 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:32.381 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:32.381 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:32.537 | General Service|:: CompanyIndex:175 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:32.553 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:32.756 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:32.756 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:32.771 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:32.771 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:32.787 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:32.802 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:32.849 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:32.849 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:32.849 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:32.849 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:32.959 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:32.959 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:33.052 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:33.052 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:33.099 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:33.099 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:33.146 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''18 Jun 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:33.162 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:33.177 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:33.177 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:33.224 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:33.240 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:33.537 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:33.537 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:33.568 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'VIEW'
 ,1
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:33.568 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:37.997 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,26
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:37.997 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.028 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60634
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.028 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60479
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.028 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60654
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.028 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.028 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60642
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.028 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.044 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.044 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.044 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60645
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.044 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60648
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.044 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60639
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.044 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.044 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.044 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.153 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60634'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.153 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.325 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.325 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.450 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60654'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.450 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.481 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 93
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.481 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.575 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60642'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.575 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.669 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60639'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.669 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.731 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60645'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.731 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.825 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60648'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.841 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.934 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60479'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.934 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.950 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RUC.NodeID IN (1,22,10,11,25,26,27,28,29,30,31)
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:38.965 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:39.028 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT T1.Status [C79eebe0c82e645b8b5cb15cf118fdbda],T2.Name [Cb65d125f6f8e4b2e872ecac79384e70c],T0.Code [C34128223803245bfb7e19666e9cf1fb1],T3.Name [C5abb5da777704276a594261c08a3fceb],case when T0.UnitStatus is not null and isnumeric(T0.UnitStatus)=1 then (select TOP 1 Name from COM_Lookup L with(nolock) where L.NodeID=T0.UnitStatus) else '''' end [Cf07e1f52867b47ba9962da1105760d12]
 FROM REN_Units T0 with(nolock) left join COM_Status T1 with(nolock) on T0.Status=T1.StatusID left join REN_Property T2 with(nolock) on T0.PropertyID=T2.NodeID left join COM_Location T3 with(nolock) on T0.LocationID=T3.NodeID
 WHERE T3.NodeID IN (1,22,10,11,25,26,27,28,29,30,31) AND T1.Status=''In Active'' ORDER BY [C79eebe0c82e645b8b5cb15cf118fdbda] '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:39.044 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:39.044 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:39.059 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:39.059 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:39.075 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:39.091 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UStatus like ''%Case%'' 

'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:39.091 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Sum(Cnt) Cnt from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424  AND RU.ContractID=0 AND RU.IsGroup=0 
AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Vacant'' 
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:39.091 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:39.091 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:39.106 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate 
WHEN RC.StatusID IN(450,480) THEN ISNULL(RC.RefundDate,RC.VacancyDate) 
ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE
select * ,convert(decimal(18,2), (convert(float,Vacant)/convert(float,NoOfUnits))) *100 [Vacant%]
from (

SELECT Property,COUNT(*) NoOfUnits
,SUM(CASE WHEN UnitStatus=''Occupied'' THEN 1 ELSE 0 END) Occupied
,SUM(CASE WHEN UnitStatus=''Expired '' THEN 1 ELSE 0 END) Expired 
,SUM(CASE WHEN UnitStatus=''Vacant'' THEN 1 ELSE 0 END) Vacant FROM (
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType
,CASE WHEN RC.StatusID IN(428,450,480) THEN ''Vacant'' 
WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' 
ELSE ''Occupied''  END UnitStatus
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.ContractID=0 AND RU.Status=424 
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' 
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) AS T

GROUP BY Property
) a order by Property
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:39.122 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:40.933 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60643
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:40.949 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:40.964 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60643
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:40.964 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:41.152 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID,SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied''
Group By Property,Property_ID
Order By Property'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:38:41.152 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:39:33.245 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:39:33.245 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:30.186 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=10005'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:30.202 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:30.265 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,10005
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:30.265 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:30.296 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,10005
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:30.296 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:30.405 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 400
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:30.405 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:30.499 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 40001
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:30.499 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:30.608 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 50011
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:30.608 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:30.639 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 110
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:30.655 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:30.686 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 2
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:30.686 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:30.733 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 50019
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:30.749 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:31.093 | General Service|:: CompanyIndex:175 SpName: spADM_GetCostCenterGridViewList 
 50011
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:31.108 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:31.764 | General Service|:: CompanyIndex:175 SpName: spCom_GetCostCenterSummary 
 67
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'18-Jun-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:31.780 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:31.811 | General Service|:: CompanyIndex:175 SpName: spADM_GetCostCenterGridViewList 
 2
 ,1
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:31.811 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:31.920 | General Service|:: CompanyIndex:175 SpName: spCom_GetCostCenterSummary 
 126
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'18-Jun-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:31.920 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:32.014 | General Service|:: CompanyIndex:175 SpName: spADM_GetLocationRole 
 50002
 ,1
 message=Saved Succesfully
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:32.030 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:32.061 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT CL.RESOURCEDATA Name FROM [ADM_Features] ADF WITH(NOLOCK),COM_LANGUAGERESOURCES CL WITH(NOLOCK) WHERE ADF.RESOURCEID=CL.RESOURCEID AND ADF.FeatureID=50002 AND CL.LanguageID=1'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:32.061 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:32.108 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT AF.FEATUREID FEATUREID,CL.ResourceData NAME FROM ADM_FEATURES AF WITH(NOLOCK),COM_LANGUAGERESOURCES CL WITH(NOLOCK) WHERE AF.RESOURCEID=CL.RESOURCEID AND  AF.FEATUREID>50000 and AF.ISEnabled=1 AND CL.LANGUAGEID=1'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:32.108 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:32.123 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT CurrencyID,Name,ExchangeRate FROM COM_Currency WITH(NOLOCK)'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:32.123 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:32.139 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT CurrencyID,Name,ExchangeRate FROM COM_Currency WITH(NOLOCK)'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:32.139 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:33.221 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:33.236 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:42.082 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select convert(int,ccAlpha41) MonthStart from COM_Location with(nolock) where StatusID !=86 and ccAlpha41 is not null and isnumeric(ccAlpha41)=1  group by ccAlpha41'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:42.082 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:42.207 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT A1.AccountID,A1.AccountTypeID,A1.AccountName,A1.GLClubTranBy,A1.AccountCode AS [Cd8ffd8610aef496cbfa6b04dac1c17b0],A1.AccountName AS [C3c75048416c9418fbd61a5ef5f9ddfc4],A1.AccountCode FROM ACC_Accounts A1 with(nolock),(select T.AccountID GTID from ACC_Accounts T with(nolock),ACC_Accounts GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.AccountID=230 group by T.AccountID) AS GTP  WHERE (A1.IsGroup=0 and A1.AccountID>1  AND A1.AccountID=GTP.GTID AND (A1.AccountID IN (SELECT CreditAccount FROM ACC_DocDetails AS Cr with(nolock) UNION SELECT DebitAccount FROM ACC_DocDetails AS Dr with(nolock)))) Order By A1.AccountCode'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:42.207 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:42.977 | General Service|:: CompanyIndex:175 SpName: spRPT_GLDimensionWise 
 '863,864'
 ,''
 ,NULL
 ,False
 ,'04/Jun/2015 12:00:00 AM'
 ,'18/Jun/2025 02:40:30 PM'
 ,''
 ,True
 ,False
 ,True
 ,True
 ,True
 ,'DocDate'
 ,'ChequeMaturityDate'
 ,50011
 ,'COM_CC50011'
 ,''
 ,True
 ,1
 ,0
 ,0
 ,False
 ,''
 ,',D.CommonNarration AS [C0f19568f2f3549b09f2e99e7c5322514],T1.Name AS [Cb934d1ca1d10414d8c8eb42b9bd23c7a],T2.Name AS [C0d68337f08084682af433abac5818f9a],D.LineNarration AS [Cacf5f4f972884deb91ced90e963d9662],T3.Name AS [C0d104ba1bbe64d0389b9917e1b8a2508],D.ChequeBankName AS [C4e68533fb1694c29bd66acdc61d9d8c1],T4.Name AS [C000552b41ad74749a54b15ade9cfcabd],CONVERT(DATETIME,D.BillDate) AS [C1bdfd1e47bbd45d38d47155521b99bf2],T5.Status AS [C52a0a7db274f49ec94ea36983d82022e],stuff((select '',''+[GUID]+''.''+FileExtension from COM_Files WITH(NOLOCK) WHERE FeatureID=D.CostCenterID AND FeaturePK=D.DocID FOR XML PATH('''')),1,1,'''') Cfc55de9a782b48bcb9d7978308ace3a7_ID,stuff((select '', ''+ActualFileName from COM_Files WITH(NOLOCK) WHERE FeatureID=D.CostCenterID AND FeaturePK=D.DocID FOR XML PATH('''')),1,2,'''') AS [Cfc55de9a782b48bcb9d7978308ace3a7],T6.Name AS [Cb732cd7c27474d7a8d1b36dd44947935],T6.NodeID [Cb732cd7c27474d7a8d1b36dd44947935_ID],D.LineNarration AS [C90a84e09e13b4823afca564976285a9e],T3.ccAlpha5 AS [C8b070b6549ea446c93db6237b30ab014],CONVERT(DATETIME,T6.ccAlpha1) AS [C84a32253f206422990c7e96a9baa8db9],CONVERT(DATETIME,T6.ccAlpha2) AS [C3765c233769744e89c78d8d7ba0befe3],T3.Name AS [C495dbb2037e44ce3b654fba38df4f4d6],A1.AccountCode AS [Cd8ffd8610aef496cbfa6b04dac1c17b0],A1.AccountName AS [C3c75048416c9418fbd61a5ef5f9ddfc4]'
 ,' LEFT JOIN COM_CC50010 AS T1 with(nolock) ON T1.NodeID=DCC.dcCCNID10 LEFT JOIN COM_Salesman AS T2 with(nolock) ON T2.NodeID=DCC.dcCCNID5 LEFT JOIN COM_CC50011 AS T3 with(nolock) ON T3.NodeID=DCC.dcCCNID11 LEFT JOIN COM_CC50009 AS T4 with(nolock) ON T4.NodeID=DCC.dcCCNID9 LEFT JOIN COM_Status AS T5 with(nolock) ON T5.StatusID=D.StatusID LEFT JOIN COM_CC50019 AS T6 with(nolock) ON T6.NodeID=DCC.dcCCNID19'
 ,',C0f19568f2f3549b09f2e99e7c5322514,Cb934d1ca1d10414d8c8eb42b9bd23c7a,C0d68337f08084682af433abac5818f9a,Cacf5f4f972884deb91ced90e963d9662,C0d104ba1bbe64d0389b9917e1b8a2508,C4e68533fb1694c29bd66acdc61d9d8c1,C000552b41ad74749a54b15ade9cfcabd,C1bdfd1e47bbd45d38d47155521b99bf2,C52a0a7db274f49ec94ea36983d82022e,Cfc55de9a782b48bcb9d7978308ace3a7_ID,Cfc55de9a782b48bcb9d7978308ace3a7,Cb732cd7c27474d7a8d1b36dd44947935,Cb732cd7c27474d7a8d1b36dd44947935_ID,C90a84e09e13b4823afca564976285a9e,C8b070b6549ea446c93db6237b30ab014,C84a32253f206422990c7e96a9baa8db9,C3765c233769744e89c78d8d7ba0befe3,C495dbb2037e44ce3b654fba38df4f4d6,Cd8ffd8610aef496cbfa6b04dac1c17b0,C3c75048416c9418fbd61a5ef5f9ddfc4'
 ,0
 ,''
 ,False
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:40:42.977 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:41:33.373 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:41:33.373 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:42:16.286 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60643
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:42:16.286 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:42:36.510 | General Service|:: CompanyIndex:175 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,60643
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:42:36.510 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:42:38.110 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:42:38.126 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:42:38.532 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select Property,Property_ID,SUM(Cnt) Cnt from (
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0 AND RU.Status=424  AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
UNION
SELECT RP.Name Property,RU.PropertyID Property_ID,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.Status=424 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)   AND RP.LocationID IN (1,22,10,11,25,26,27,28,29,30,31)
) a where UnitStatus=''Occupied''
Group By Property,Property_ID
Order By Property'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:42:38.532 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:43:32.380 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 14:43:32.380 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:43:33.255 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:43:33.255 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:44:33.245 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:44:33.260 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:45:33.237 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:45:33.237 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:46:33.226 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:46:33.242 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:47:33.225 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:47:33.241 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:48:32.382 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 14:48:32.382 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:48:33.226 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:48:33.242 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:49:33.227 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:49:33.243 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:50:33.230 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:50:33.246 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:51:33.234 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:51:33.234 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:52:33.238 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:52:33.254 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:53:27.453 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''127bbe15-d93a-4555-9945-129f20714cd5''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 06-18-2025 14:53:27.469 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:53:32.382 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 06-18-2025 14:53:32.382 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:53:33.234 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:53:33.234 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:54:33.237 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:54:33.252 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:55:33.240 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:55:33.240 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:56:33.241 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:56:33.241 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:57:33.242 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 06-18-2025 14:57:33.242 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTAyMzc3MDcsImV4cCI6MTc1MDI2NjUwNywiaWF0IjoxNzUwMjM3NzA3fQ.2r0SoK1EdyZlg6CwS73kpXXCaFJ4aDtzdjRjL87AvDc'''
 ,1
 ,1
