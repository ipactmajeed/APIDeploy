[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:34.479 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:34.635 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:34.697 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:35.322 | General Service|:: CompanyIndex:1 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.0.3'
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:35.463 | General Service|:: CompanyIndex:1 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.0.3'
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:35.478 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,1
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:35.541 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:35.572 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:35.572 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:35.572 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 11:19:35.572 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 11:19:35.572 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 11:19:35.572 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:35.619 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''01e9e09f-7cf8-4ce1-a641-59caa9c7a26d''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.99'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,1,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:35.635 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:35.635 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 11:19:35.635 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 11:19:35.635 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 11:19:35.635 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:35.728 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:35.728 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:35.728 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 11:19:35.728 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 11:19:35.728 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 11:19:35.728 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:35.791 | General Service|:: CompanyIndex:1 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:35.791 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:35.791 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 11:19:35.791 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 11:19:35.791 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 11:19:35.791 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:37.103 | General Service|:: CompanyIndex:1 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:37.103 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:37.103 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 11:19:37.103 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 11:19:37.103 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 11:19:37.103 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:37.400 | General Service|:: CompanyIndex:1 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:37.400 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:37.400 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 11:19:37.400 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 11:19:37.400 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 11:19:37.415 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:37.447 | General Service|:: CompanyIndex:1 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:37.447 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:37.447 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 11:19:37.447 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 11:19:37.447 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 11:19:37.447 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:37.462 | General Service|:: CompanyIndex:1 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:37.478 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:37.478 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 11:19:37.478 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 11:19:37.478 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 11:19:37.478 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:37.900 | General Service|:: CompanyIndex:1 SpName: spCOM_GetFavorites 
 'GETLIST1'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:37.915 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:37.915 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 11:19:37.915 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 11:19:37.915 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 11:19:37.915 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:37.962 | General Service|:: CompanyIndex:1 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:37.962 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:37.962 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 11:19:37.962 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 11:19:37.962 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 11:19:37.962 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:38.087 | General Service|:: CompanyIndex:1 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:38.087 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:38.087 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 11:19:38.087 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 11:19:38.087 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 11:19:38.087 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:38.243 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:38.243 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:38.243 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 11:19:38.243 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 11:19:38.243 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 11:19:38.243 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:38.290 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
 message=Invalid object name 'PAY_PayrollPreferences'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:38.290 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 11:19:38.290 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 11:19:38.290 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 11:19:38.290 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1|Invalid object name 'PAY_PayrollPreferences'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:38.290 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:38.290 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 11:19:38.290 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 11:19:38.290 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 11:19:38.290 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:38.509 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''03 Jul 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:38.509 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:38.509 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 11:19:38.509 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 11:19:38.509 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 11:19:38.509 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:38.837 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:38.837 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:38.837 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 11:19:38.837 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 11:19:38.837 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 11:19:38.837 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:38.868 | General Service|:: CompanyIndex:1 SpName: spCOM_GetFavorites 
 'GETLIST1'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:38.868 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:38.868 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 11:19:38.868 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 11:19:38.868 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 11:19:38.868 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:38.900 | General Service|:: CompanyIndex:1 SpName: spCOM_GetFavorites 
 'VIEW'
 ,1
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:38.915 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:38.915 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 11:19:38.915 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 11:19:38.915 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 11:19:38.915 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:44.156 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 6
 ,'01e9e09f-7cf8-4ce1-a641-59caa9c7a26d'
 ,''
 ,''
 ,''
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:44.156 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:44.156 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 11:19:44.156 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 11:19:44.156 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 11:19:44.156 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] ERROR | 07-03-2025 11:19:44.203 | General Service|:: CompanyIndex:1 SpName: sp_SetTokenHistoryParameters :
 0
 ,'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'
 ,''
 ,NULL
 ,1
 ,1|Could not find stored procedure 'sp_SetTokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:44.203 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:44.203 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 11:19:44.203 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 11:19:44.203 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 11:19:44.203 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMSwxIiwibmJmIjoxNzUxNTIxNzc1LCJleHAiOjE3NTE1NTA1NzUsImlhdCI6MTc1MTUyMTc3NX0.dPcTwk8R_qRJscmDRliOKq1YUnTORsh0v3jd69S12DI'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:51.389 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:51.436 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 11:19:51.467 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:04.006 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:04.084 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:04.147 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:06.996 | General Service|:: CompanyIndex:53 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.0.3'
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:07.059 | General Service|:: CompanyIndex:53 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.0.3'
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:07.137 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,53
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:07.137 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,53
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:07.152 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:07.152 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:07.215 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''43456fa0-52e9-4c19-a509-5552b674a56a''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.99'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,53,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:07.215 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:07.246 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:07.246 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:07.293 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:07.293 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:07.496 | General Service|:: CompanyIndex:53 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:07.496 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:07.730 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:07.730 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:07.746 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:07.746 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:07.762 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:07.777 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:07.809 | General Service|:: CompanyIndex:53 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:07.824 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:07.824 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:07.824 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:07.934 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:07.934 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.043 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.043 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.090 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.090 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.105 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''03 Jul 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.105 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.309 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.309 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.590 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 1
 ,41
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.605 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.621 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.621 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.636 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.636 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.636 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.636 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.636 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.652 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.652 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.652 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.652 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.652 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.652 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.652 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.652 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.668 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.668 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.668 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.668 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.668 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.668 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.668 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.668 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.668 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.668 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.668 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.668 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.683 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.683 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.683 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.699 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.699 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.699 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.699 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.715 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.715 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.730 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.730 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.730 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.746 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.746 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.746 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.762 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.762 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.762 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.777 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.777 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.777 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.980 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:08.996 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.152 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.168 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.215 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.215 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.230 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.230 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.261 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.261 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.277 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.277 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.277 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.277 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.293 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.293 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.308 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.308 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.308 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.308 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.324 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.324 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.339 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.339 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.339 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.339 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.371 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.371 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.386 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.386 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.402 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.402 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.418 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.418 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.433 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.433 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.449 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.465 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.480 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.496 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.514 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.514 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.530 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.530 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.530 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.546 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.577 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.593 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.608 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:09.608 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:12.976 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 6
 ,'43456fa0-52e9-4c19-a509-5552b674a56a'
 ,''
 ,''
 ,''
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:12.992 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:13.163 | General Service|:: CompanyIndex:53 SpName: sp_SetTokenHistory 
 0
 ,'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'
 ,''
 ,NULL
 ,1
 ,1
 message=Saved Succesfully
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:13.163 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUyMTgwNywiZXhwIjoxNzUxNTUwNjA3LCJpYXQiOjE3NTE1MjE4MDd9.KreA2e3qSAugR8D-k-22t4qo-xbA-vfhqmYdbkiszB4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:23.643 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'walter'
 ,1
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:23.690 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'walter'
 ,1
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:23.721 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'walter'
 ,0
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:23.753 | General Service|:: CompanyIndex:53 SpName: spADM_GetClientUserDetails 
 'walter'
 ,1
 ,'26.0.3'
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:23.800 | General Service|:: CompanyIndex:53 SpName: spADM_GetClientUserDetails 
 'walter'
 ,1
 ,'26.0.3'
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:23.878 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'walter'
 ,53
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:23.893 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,53
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:23.909 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:23.909 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTIxODIzLCJleHAiOjE3NTE1NTA2MjMsImlhdCI6MTc1MTUyMTgyM30.SJhb67DdZCsGrTLav29qsSqOTu3Ien_UTPQPzmbMwXA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:23.940 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''ff78425e-1f7d-4c70-b666-186799e1f0db''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''Walter''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.99'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,53,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:23.940 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTIxODIzLCJleHAiOjE3NTE1NTA2MjMsImlhdCI6MTc1MTUyMTgyM30.SJhb67DdZCsGrTLav29qsSqOTu3Ien_UTPQPzmbMwXA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:23.956 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:23.956 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTIxODIzLCJleHAiOjE3NTE1NTA2MjMsImlhdCI6MTc1MTUyMTgyM30.SJhb67DdZCsGrTLav29qsSqOTu3Ien_UTPQPzmbMwXA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:23.972 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:23.972 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTIxODIzLCJleHAiOjE3NTE1NTA2MjMsImlhdCI6MTc1MTUyMTgyM30.SJhb67DdZCsGrTLav29qsSqOTu3Ien_UTPQPzmbMwXA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:24.206 | General Service|:: CompanyIndex:53 SpName: spADM_GetRibbonView 
 20038
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:24.206 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTIxODIzLCJleHAiOjE3NTE1NTA2MjMsImlhdCI6MTc1MTUyMTgyM30.SJhb67DdZCsGrTLav29qsSqOTu3Ien_UTPQPzmbMwXA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:24.393 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'20038'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:24.409 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTIxODIzLCJleHAiOjE3NTE1NTA2MjMsImlhdCI6MTc1MTUyMTgyM30.SJhb67DdZCsGrTLav29qsSqOTu3Ien_UTPQPzmbMwXA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:24.409 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:24.424 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTIxODIzLCJleHAiOjE3NTE1NTA2MjMsImlhdCI6MTc1MTUyMTgyM30.SJhb67DdZCsGrTLav29qsSqOTu3Ien_UTPQPzmbMwXA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:24.487 | General Service|:: CompanyIndex:53 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'20038'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:24.503 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTIxODIzLCJleHAiOjE3NTE1NTA2MjMsImlhdCI6MTc1MTUyMTgyM30.SJhb67DdZCsGrTLav29qsSqOTu3Ien_UTPQPzmbMwXA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:24.503 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:24.503 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTIxODIzLCJleHAiOjE3NTE1NTA2MjMsImlhdCI6MTc1MTUyMTgyM30.SJhb67DdZCsGrTLav29qsSqOTu3Ien_UTPQPzmbMwXA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:24.596 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:24.596 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTIxODIzLCJleHAiOjE3NTE1NTA2MjMsImlhdCI6MTc1MTUyMTgyM30.SJhb67DdZCsGrTLav29qsSqOTu3Ien_UTPQPzmbMwXA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:24.706 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:24.706 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTIxODIzLCJleHAiOjE3NTE1NTA2MjMsImlhdCI6MTc1MTUyMTgyM30.SJhb67DdZCsGrTLav29qsSqOTu3Ien_UTPQPzmbMwXA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:24.753 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:24.753 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTIxODIzLCJleHAiOjE3NTE1NTA2MjMsImlhdCI6MTc1MTUyMTgyM30.SJhb67DdZCsGrTLav29qsSqOTu3Ien_UTPQPzmbMwXA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:24.784 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''Walter''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''Walter'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''Walter'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''03 Jul 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=20038
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=20038
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=20038
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''Walter'')                         
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:24.784 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTIxODIzLCJleHAiOjE3NTE1NTA2MjMsImlhdCI6MTc1MTUyMTgyM30.SJhb67DdZCsGrTLav29qsSqOTu3Ien_UTPQPzmbMwXA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:25.003 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:25.003 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTIxODIzLCJleHAiOjE3NTE1NTA2MjMsImlhdCI6MTc1MTUyMTgyM30.SJhb67DdZCsGrTLav29qsSqOTu3Ien_UTPQPzmbMwXA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:25.174 | General Service|:: CompanyIndex:53 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'20038'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:25.174 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTIxODIzLCJleHAiOjE3NTE1NTA2MjMsImlhdCI6MTc1MTUyMTgyM30.SJhb67DdZCsGrTLav29qsSqOTu3Ien_UTPQPzmbMwXA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:25.206 | General Service|:: CompanyIndex:53 SpName: spCOM_GetFavorites 
 'VIEW'
 ,1
 ,'20038'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:25.206 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTIxODIzLCJleHAiOjE3NTE1NTA2MjMsImlhdCI6MTc1MTUyMTgyM30.SJhb67DdZCsGrTLav29qsSqOTu3Ien_UTPQPzmbMwXA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:28.528 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 6
 ,'ff78425e-1f7d-4c70-b666-186799e1f0db'
 ,''
 ,''
 ,''
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:28.544 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTIxODIzLCJleHAiOjE3NTE1NTA2MjMsImlhdCI6MTc1MTUyMTgyM30.SJhb67DdZCsGrTLav29qsSqOTu3Ien_UTPQPzmbMwXA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:28.559 | General Service|:: CompanyIndex:53 SpName: sp_SetTokenHistory 
 0
 ,'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTIxODIzLCJleHAiOjE3NTE1NTA2MjMsImlhdCI6MTc1MTUyMTgyM30.SJhb67DdZCsGrTLav29qsSqOTu3Ien_UTPQPzmbMwXA'
 ,''
 ,NULL
 ,20038
 ,1
 message=Saved Succesfully
[System: 192.168.1.99] DEBUG | 07-03-2025 11:20:28.575 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTIxODIzLCJleHAiOjE3NTE1NTA2MjMsImlhdCI6MTc1MTUyMTgyM30.SJhb67DdZCsGrTLav29qsSqOTu3Ien_UTPQPzmbMwXA'''
 ,1
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 11:35:47.330 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 11:35:47.393 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.54'
 ,'192.168.1.54'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 11:35:57.678 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 11:35:57.741 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.54'
 ,'192.168.1.54'
 ,''
 ,'MobileWeb'
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 11:36:03.457 | General Service|:: CompanyIndex:7 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.0.3'
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 11:36:03.551 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,7
 ,'192.168.1.54'
 ,'192.168.1.54'
 ,''
 ,'MobileWeb'
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 11:36:03.567 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,7
[System: 192.168.1.54] DEBUG | 07-03-2025 11:36:03.582 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 11:36:03.582 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTIyNzYzLCJleHAiOjE3NTE1NTE1NjMsImlhdCI6MTc1MTUyMjc2M30.hQKsiAIL-TVZwRMhFg7ZoeOYwQfblInm6Ttugh3dgIk'''
 ,1
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 11:36:03.629 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''62e16687-a9c4-48f3-a1c6-9d5e8d9a2c30''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.54'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,7,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 11:36:03.629 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTIyNzYzLCJleHAiOjE3NTE1NTE1NjMsImlhdCI6MTc1MTUyMjc2M30.hQKsiAIL-TVZwRMhFg7ZoeOYwQfblInm6Ttugh3dgIk'''
 ,1
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 11:36:03.660 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 11:36:03.676 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTIyNzYzLCJleHAiOjE3NTE1NTE1NjMsImlhdCI6MTc1MTUyMjc2M30.hQKsiAIL-TVZwRMhFg7ZoeOYwQfblInm6Ttugh3dgIk'''
 ,1
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 11:51:04.393 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''62e16687-a9c4-48f3-a1c6-9d5e8d9a2c30''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 11:51:04.409 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTIyNzYzLCJleHAiOjE3NTE1NTE1NjMsImlhdCI6MTc1MTUyMjc2M30.hQKsiAIL-TVZwRMhFg7ZoeOYwQfblInm6Ttugh3dgIk'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 12:04:16.585 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 12:04:16.648 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 12:06:04.328 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''62e16687-a9c4-48f3-a1c6-9d5e8d9a2c30''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 12:06:04.343 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTIyNzYzLCJleHAiOjE3NTE1NTE1NjMsImlhdCI6MTc1MTUyMjc2M30.hQKsiAIL-TVZwRMhFg7ZoeOYwQfblInm6Ttugh3dgIk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 07-03-2025 12:10:05.022 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 07-03-2025 12:10:05.116 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 12:21:04.306 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''62e16687-a9c4-48f3-a1c6-9d5e8d9a2c30''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 12:21:04.337 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTIyNzYzLCJleHAiOjE3NTE1NTE1NjMsImlhdCI6MTc1MTUyMjc2M30.hQKsiAIL-TVZwRMhFg7ZoeOYwQfblInm6Ttugh3dgIk'''
 ,1
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 12:36:04.305 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''62e16687-a9c4-48f3-a1c6-9d5e8d9a2c30''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 12:36:04.321 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTIyNzYzLCJleHAiOjE3NTE1NTE1NjMsImlhdCI6MTc1MTUyMjc2M30.hQKsiAIL-TVZwRMhFg7ZoeOYwQfblInm6Ttugh3dgIk'''
 ,1
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 12:51:04.306 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''62e16687-a9c4-48f3-a1c6-9d5e8d9a2c30''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 12:51:04.321 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTIyNzYzLCJleHAiOjE3NTE1NTE1NjMsImlhdCI6MTc1MTUyMjc2M30.hQKsiAIL-TVZwRMhFg7ZoeOYwQfblInm6Ttugh3dgIk'''
 ,1
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 13:06:04.307 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''62e16687-a9c4-48f3-a1c6-9d5e8d9a2c30''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 13:06:04.322 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTIyNzYzLCJleHAiOjE3NTE1NTE1NjMsImlhdCI6MTc1MTUyMjc2M30.hQKsiAIL-TVZwRMhFg7ZoeOYwQfblInm6Ttugh3dgIk'''
 ,1
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 13:21:04.315 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''62e16687-a9c4-48f3-a1c6-9d5e8d9a2c30''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 13:21:04.346 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTIyNzYzLCJleHAiOjE3NTE1NTE1NjMsImlhdCI6MTc1MTUyMjc2M30.hQKsiAIL-TVZwRMhFg7ZoeOYwQfblInm6Ttugh3dgIk'''
 ,1
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 13:36:04.287 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''62e16687-a9c4-48f3-a1c6-9d5e8d9a2c30''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 13:36:04.302 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTIyNzYzLCJleHAiOjE3NTE1NTE1NjMsImlhdCI6MTc1MTUyMjc2M30.hQKsiAIL-TVZwRMhFg7ZoeOYwQfblInm6Ttugh3dgIk'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:00.970 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:02.032 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:37.618 | General Service|:: CompanyIndex:30 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.0.3'
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:38.040 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,30
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:38.524 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,30
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:38.555 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:38.587 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:38.587 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:38:38.587 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:38:38.587 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:38:38.587 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:38.696 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''dd3ad278-56ad-4903-b61b-7fc476975072''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.99'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,30,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:38.696 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:38.696 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:38:38.696 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:38:38.696 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:38:38.696 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:40.830 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:40.830 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:40.830 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:38:40.830 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:38:40.830 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:38:40.830 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:54.520 | General Service|:: CompanyIndex:30 SpName: spCOM_GetDivisions 
 0
 ,1
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:54.535 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:54.535 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:38:54.535 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:38:54.535 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:38:54.535 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:55.348 | General Service|:: CompanyIndex:30 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:55.348 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:55.348 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:38:55.348 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:38:55.348 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:38:55.348 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:56.735 | General Service|:: CompanyIndex:30 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:56.735 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:56.735 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:38:56.735 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:38:56.735 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:38:56.735 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:57.001 | General Service|:: CompanyIndex:30 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:57.016 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:57.016 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:38:57.016 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:38:57.016 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:38:57.016 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:57.141 | General Service|:: CompanyIndex:30 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:57.141 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:57.141 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:38:57.141 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:38:57.141 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:38:57.141 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:58.266 | General Service|:: CompanyIndex:30 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:58.282 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:58.282 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:38:58.282 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:38:58.282 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:38:58.282 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:58.643 | General Service|:: CompanyIndex:30 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:58.643 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:58.643 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:38:58.643 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:38:58.643 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:38:58.643 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:58.862 | General Service|:: CompanyIndex:30 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:58.862 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:38:58.862 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:38:58.862 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:38:58.862 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:38:58.862 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:01.283 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:01.283 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:01.283 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:39:01.283 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:39:01.283 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:39:01.283 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:01.377 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:01.393 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:01.393 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:39:01.393 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:39:01.393 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:39:01.393 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:02.814 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''03 Jul 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:02.814 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:02.814 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:39:02.814 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:39:02.814 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:39:02.814 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:02.846 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:02.861 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:02.861 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:39:02.861 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:39:02.861 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:39:02.861 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:04.321 | General Service|:: CompanyIndex:30 SpName: spADM_GetDashBoard 
 1
 ,11
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:04.337 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:04.337 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:39:04.337 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:39:04.337 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:39:04.337 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:05.619 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:05.634 | General Service|:: CompanyIndex:30 SpName: spRPT_GetReport 
 0
 ,10038
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:05.634 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:05.634 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:39:05.634 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:39:05.634 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:39:05.634 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:05.634 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:05.634 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:39:05.634 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:39:05.634 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:39:05.634 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:05.634 | General Service|:: CompanyIndex:30 SpName: spRPT_GetReport 
 0
 ,188
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:05.650 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:05.650 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:39:05.650 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:39:05.650 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:39:05.650 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:05.790 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=188'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:05.790 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:05.790 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:39:05.790 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:39:05.790 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:39:05.790 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:10.549 | General Service|:: CompanyIndex:30 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:10.565 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:10.565 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:39:10.565 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:39:10.565 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:39:10.565 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:11.002 | General Service|:: CompanyIndex:30 SpName: spRPT_GetReportFields 
 400
 ,0
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:11.002 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:11.002 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:39:11.002 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:39:11.002 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:39:11.018 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:11.439 | General Service|:: CompanyIndex:30 SpName: spRPT_GetReportFields 
 401
 ,0
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:11.627 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:11.627 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:39:11.627 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:39:11.627 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:39:11.627 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:11.689 | General Service|:: CompanyIndex:30 SpName: spRPT_GetReportFields 
 7
 ,0
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:11.689 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:11.689 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:39:11.689 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:39:11.689 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:39:11.689 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:12.221 | General Service|:: CompanyIndex:30 SpName: spRPT_GetReportData 
 9
 ,1
 ,'<XML UID="1" ShowMyQueue="1"></XML>'
 ,'1'
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:12.236 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:12.236 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:39:12.236 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:39:12.236 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:39:12.236 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:14.505 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=10038'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:14.505 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:14.505 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:39:14.505 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:39:14.505 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:39:14.505 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:14.568 | General Service|:: CompanyIndex:30 SpName: spRPT_GetReportFields 
 400
 ,0
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:14.568 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:14.568 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:39:14.568 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:39:14.568 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:39:14.568 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:14.646 | General Service|:: CompanyIndex:30 SpName: spRPT_GetReportFields 
 7
 ,0
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:14.661 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:14.661 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:39:14.661 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:39:14.661 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:39:14.661 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:17.933 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
                EXEC spRPT_GetReportData @Type=8,@Param1=1,@strXML=null,@RoleID=1
SELECT T1.DocumentName [C18d70dc2c534464e904e30f047bdab69],INV.VoucherNo [C302d10683b6f48a6ab1fb3016c5edb5d],INV.DocAbbr [C302d10683b6f48a6ab1fb3016c5edb5dAbr],INV.DocPrefix [C302d10683b6f48a6ab1fb3016c5edb5dprf],CONVERT(BIGINT,INV.DocNumber) [C302d10683b6f48a6ab1fb3016c5edb5ddno],CONVERT(DATETIME,INV.DocDate) [C96d296fac7994630aaf49cf8ad8ca49d],T2.Status [Cdd6a6a752d5b4a51bb588b9edde4afe9],T4.Name [C1b181948f2be48f797d0bf333efa1daa],INV.CommonNarration [Cb92ba68eb997415abdff56fafee23af5],T5.Name [C38455049de614018b1f3b59ce4ff4cea],NULL [Ca95fcbcd0cde4b368b8db46c4491e488],CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END [Ce7f76d15a687447db7d41d783a5429ea],T7.dcCalcNum67 [Ca00cd8320c2d4902881459a59e6b8bfe],T7.dcCalcNum68 [C53e44f2e0cbe478398caf2513e8cd34a],T7.dcCalcNum69 [Cc6657302ea7a411b89e709d32cb1cf81],stuff((select '',''+[GUID]+''.''+FileExtension from COM_Files WITH(NOLOCK) WHERE FeatureID=INV.CostCenterID AND FeaturePK=INV.DocID FOR XML PATH('''')),1,1,'''') Ceefe39aa104a4f83b6aea7ca2cb25550_ID,stuff((select '', ''+ActualFileName from COM_Files WITH(NOLOCK) WHERE FeatureID=INV.CostCenterID AND FeaturePK=INV.DocID FOR XML PATH('''')),1,2,'''') [Ceefe39aa104a4f83b6aea7ca2cb25550],(select CreatedBy from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc)) [C5818a5e7039d4c39a4a3454f3f980e4b],(select Remarks from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc)) [C69c3eb458930474d8abef28cc1c6ae92],(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))) [C3c418a0727b84ae8ae6e7a1c195a12cb],T8.UserName [Cdb5f471d28044bbd97ee34a15dc0ec35],CONVERT(DATETIME,INV.CreatedDate) [C03b87fe0479346fbac054154ab881fac],WFTU1.FirstName [C7d2d7501fecd4b45b71554216b65918b],WFTU2.FirstName [C63303c3df7d34b398e21e9bc16a506f6],convert(datetime,floor(WFT.L2CreatedDate)) [C7ac683d68f79423d83d26b8de3576c1a],WFTU3.FirstName [C88cbe187a0a94b9f80243293f4f0d4db],convert(datetime,floor(WFT.L3CreatedDate)) [C99335a29f93e445990a8fd4abe676dc4],WFTU4.FirstName [C968b16e5b8ff453a984be02f5b8d5681],(select convert(datetime,CreatedDate) from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc)) [C2a57348604524a71a7837e8dde7497c9],WFTU5.FirstName [Cceb88395a21d424fb63a821ee93252fc],INV.WorkFlowLevel,INV.WorkFlowID
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_Status T2 with(nolock) on INV.StatusID=T2.StatusID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T4 with(nolock) on TDCC.dcCCNID2=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_DocNumData T7 with(nolock) on INV.INVDOCDETAILSID=T7.INVDOCDETAILSID left join ADM_Users T8 with(nolock) on INV.CreatedBy=T8.Username left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID ,#TblUsrWF WF
 WHERE T2.StatusID IN (371,440,441,464,466,1001,1002) AND TDCC.dcCCNID1 IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T4.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND INV.WorkFlowID>0 AND WF.WID=INV.WorkflowID and (INV.CreatedBy=''admin'' or WF.LevelID>INV.WorkFlowLevel) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (INV.CreatedBy=''admin'' or ( WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372))  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef and INV.CreatedDate+WF.CtWef<=convert(float,getdate())))
 UNION ALL 
SELECT T1.DocumentName,ACC.VoucherNo,ACC.DocAbbr,ACC.DocPrefix,CONVERT(BIGINT,ACC.DocNumber),CONVERT(DATETIME,ACC.DocDate),T2.Status,T4.Name,ACC.CommonNarration,T5.Name,ACC.Amount,NULL,T7.dcCalcNum67,T7.dcCalcNum68,T7.dcCalcNum69,stuff((select '',''+[GUID]+''.''+FileExtension from COM_Files WITH(NOLOCK) WHERE FeatureID=ACC.CostCenterID AND FeaturePK=ACC.DocID FOR XML PATH('''')),1,1,'''') Ceefe39aa104a4f83b6aea7ca2cb25550_ID,stuff((select '', ''+ActualFileName from COM_Files WITH(NOLOCK) WHERE FeatureID=ACC.CostCenterID AND FeaturePK=ACC.DocID FOR XML PATH('''')),1,2,''''),(select CreatedBy from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc)),(select Remarks from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc)),(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc))),T8.UserName,CONVERT(DATETIME,ACC.CreatedDate),WFTU1.FirstName,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFTU4.FirstName,(select convert(datetime,CreatedDate) from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc)),WFTU5.FirstName,ACC.WorkFlowLevel,ACC.WorkFlowID
 FROM ACC_DocDetails ACC with(nolock) left join ADM_DocumentTypes T1 with(nolock) on ACC.CostCenterID=T1.CostCenterID left join COM_Status T2 with(nolock) on ACC.StatusID=T2.StatusID left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_Location T4 with(nolock) on TDCC.dcCCNID2=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_DocNumData T7 with(nolock) on ACC.ACCDOCDETAILSID=T7.ACCDOCDETAILSID left join ADM_Users T8 with(nolock) on ACC.CreatedBy=T8.Username left join COM_ApprovalSummary WFT on WFT.DocID=ACC.docid and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=ACC.AccDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID ,#TblUsrWF WF
 WHERE T2.StatusID IN (371,440,441,464,466,1001,1002) AND TDCC.dcCCNID1 IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T4.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND ACC.LinkedAccDocDetailsID is null AND ACC.WorkFlowID>0 AND ACC.InvDocDetailsID IS NULL AND WF.WID=ACC.WorkflowID and (ACC.CreatedBy=''admin'' or WF.LevelID>ACC.WorkFlowLevel) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (ACC.CreatedBy=''admin'' or ( WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372))  or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef and ACC.CreatedDate+WF.CtWef<=convert(float,getdate()))) ORDER BY [C302d10683b6f48a6ab1fb3016c5edb5dAbr] ,[C302d10683b6f48a6ab1fb3016c5edb5dprf] ,[C302d10683b6f48a6ab1fb3016c5edb5ddno] 
 SELECT WorkFlowID,MAX(LevelID) Levels FROM COM_WorkFlow with(nolock) GROUP BY WorkFlowID 
 DROP TABLE #TblUsrWF'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:17.948 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:17.948 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:39:17.948 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:39:17.948 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:39:17.948 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:19.449 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 6
 ,'dd3ad278-56ad-4903-b61b-7fc476975072'
 ,''
 ,''
 ,''
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:19.464 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:19.464 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:39:19.464 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:39:19.464 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:39:19.464 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] ERROR | 07-03-2025 13:39:19.574 | General Service|:: CompanyIndex:30 SpName: sp_SetTokenHistoryParameters :
 0
 ,'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'
 ,''
 ,NULL
 ,1
 ,1|Could not find stored procedure 'sp_SetTokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:19.589 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:19.589 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:39:19.589 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:39:19.589 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:39:19.589 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:35.736 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:35.814 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:47.994 | General Service|:: CompanyIndex:12 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.0.3'
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:48.056 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,12
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:48.072 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,12
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:48.135 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:48.213 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:48.275 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''4cda6970-d5e4-41dd-afbe-4cc59497227f''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.99'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,12,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:48.275 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:48.510 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:48.510 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:51.384 | General Service|:: CompanyIndex:12 SpName: spCOM_GetDivisions 
 0
 ,1
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:51.462 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:52.040 | General Service|:: CompanyIndex:12 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:52.118 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:53.321 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'SELECT ACC.VoucherNo [Cdda1c283318d4f85ba78a81b17025d01],ACC.DocAbbr [Cdda1c283318d4f85ba78a81b17025d01Abr],ACC.DocPrefix [Cdda1c283318d4f85ba78a81b17025d01prf],CONVERT(BIGINT,ACC.DocNumber) [Cdda1c283318d4f85ba78a81b17025d01dno],CONVERT(DATETIME,ACC.DocDate) [C6749288653854552882096ad6bda1ac7],T1.DocumentName [Cedee0408740e4b97a82375c5263fe0a4],ACC.CommonNarration [Cf98d6823ab804531ac518ff0d8b310b4],T3.Name [C93647491572b4b88b3ca068a9b6dedcf],T4.Name [Cc383a940702d47698533aebeadbd03c0],T5.Name [C8a669908048c4783a5508e024d7861a1],(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc))) [Cf46eab74cac744d6806bbdbbc50a27fa],ACC.Amount [C3bcf45a880934b19a457e01cb6d31436],NULL [C9e0f538d21ce4c4592d5c4fed7370353],WFTU1.UserName [C2c5ca2818d8f44b8a37cb12ec3f6a50a],WFTU1.FirstName [Ce7f973825c394f42a7995c67c89b4a99],CONVERT(DATETIME,ACC.CreatedDate) [C988be4da81034e63a2ed3e7643bc2d04],WFTU2.UserName [C76fd6dc3203a4067a76678ae7374f8bb],WFT.L2Status [Cd27da39604ed47c7b5ca76b659ccc6d1],WFTU2.FirstName [Cffce42ec7f354cf79785e7b190bec749],convert(datetime,floor(WFT.L2CreatedDate)) [C286cc18c7cee4b7cb94b6081d4490e3a],WFTU3.UserName [C19b7dfa031264f2b8c98a420eca2eabf],WFT.L3Status [C1d160588b9d74e10bcd9f9aab18a35c1],WFTU3.FirstName [Cb28f6a75bda3442ca25d8ff0440c13f8],convert(datetime,floor(WFT.L3CreatedDate)) [Cf4d929fb0ab744eebe413fd3d83446c8],WFT.L1Status [C36d968b782024a7582acc77d14ceca30],WFT.L4Status [C3ff32df5947640d4b6de888dbce867fa],WFTU4.FirstName [C046a8460b1c545ebb4366d9c23847b39],convert(datetime,floor(WFT.L4CreatedDate)) [C815c7b99ddc04ba5a5097c1ab08e7541],WFTU4.UserName [C855ec0594b2e4b12900721ea4ef16c84],WFT.L5Status [C2b9ff2a8c999427bbefd6fe6bf1a6ba2],WFTU5.FirstName [Cad22eeb104b34675ac092db014c9f6a2],convert(datetime,floor(WFT.L5CreatedDate)) [Cae9b88c12c9f41128cd8649e20771e90],WFTU5.UserName [Cd7cb0552ae964bd280beec3b388247bc],T1.DocumentName [Cc46068c4efad4f7d9c21b64414bd05a8]
 FROM ACC_DocDetails ACC with(nolock) left join ADM_DocumentTypes T1 with(nolock) on ACC.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=ACC.docid and WFT.CCID=40014 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=ACC.AccDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (ACC.CostCenterID=40014) AND ACC.LinkedAccDocDetailsID is null
 UNION ALL 
SELECT ACC.VoucherNo,ACC.DocAbbr,ACC.DocPrefix,CONVERT(BIGINT,ACC.DocNumber),CONVERT(DATETIME,ACC.DocDate),T1.DocumentName,ACC.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc))),ACC.Amount,NULL,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,ACC.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM ACC_DocDetails ACC with(nolock) left join ADM_DocumentTypes T1 with(nolock) on ACC.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=ACC.docid and WFT.CCID=41077 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=ACC.AccDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (ACC.CostCenterID=41077) AND ACC.LinkedAccDocDetailsID is null
 UNION ALL 
SELECT ACC.VoucherNo,ACC.DocAbbr,ACC.DocPrefix,CONVERT(BIGINT,ACC.DocNumber),CONVERT(DATETIME,ACC.DocDate),T1.DocumentName,ACC.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc))),ACC.Amount,NULL,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,ACC.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM ACC_DocDetails ACC with(nolock) left join ADM_DocumentTypes T1 with(nolock) on ACC.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=ACC.docid and WFT.CCID=40015 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=ACC.AccDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (ACC.CostCenterID=40015) AND ACC.LinkedAccDocDetailsID is null
 UNION ALL 
SELECT ACC.VoucherNo,ACC.DocAbbr,ACC.DocPrefix,CONVERT(BIGINT,ACC.DocNumber),CONVERT(DATETIME,ACC.DocDate),T1.DocumentName,ACC.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc))),ACC.Amount,NULL,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,ACC.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM ACC_DocDetails ACC with(nolock) left join ADM_DocumentTypes T1 with(nolock) on ACC.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=ACC.docid and WFT.CCID=41074 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=ACC.AccDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (ACC.CostCenterID=41074) AND ACC.LinkedAccDocDetailsID is null
 UNION ALL 
SELECT ACC.VoucherNo,ACC.DocAbbr,ACC.DocPrefix,CONVERT(BIGINT,ACC.DocNumber),CONVERT(DATETIME,ACC.DocDate),T1.DocumentName,ACC.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc))),ACC.Amount,NULL,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,ACC.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM ACC_DocDetails ACC with(nolock) left join ADM_DocumentTypes T1 with(nolock) on ACC.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=ACC.docid and WFT.CCID=41065 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=ACC.AccDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (ACC.CostCenterID=41065) AND ACC.LinkedAccDocDetailsID is null
 UNION ALL 
SELECT ACC.VoucherNo,ACC.DocAbbr,ACC.DocPrefix,CONVERT(BIGINT,ACC.DocNumber),CONVERT(DATETIME,ACC.DocDate),T1.DocumentName,ACC.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc))),ACC.Amount,NULL,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,ACC.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM ACC_DocDetails ACC with(nolock) left join ADM_DocumentTypes T1 with(nolock) on ACC.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=ACC.docid and WFT.CCID=41094 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=ACC.AccDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (ACC.CostCenterID=41094) AND ACC.LinkedAccDocDetailsID is null
 UNION ALL 
SELECT ACC.VoucherNo,ACC.DocAbbr,ACC.DocPrefix,CONVERT(BIGINT,ACC.DocNumber),CONVERT(DATETIME,ACC.DocDate),T1.DocumentName,ACC.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc))),ACC.Amount,NULL,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,ACC.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM ACC_DocDetails ACC with(nolock) left join ADM_DocumentTypes T1 with(nolock) on ACC.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=ACC.docid and WFT.CCID=41093 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=ACC.AccDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (ACC.CostCenterID=41093) AND ACC.LinkedAccDocDetailsID is null
 UNION ALL 
SELECT ACC.VoucherNo,ACC.DocAbbr,ACC.DocPrefix,CONVERT(BIGINT,ACC.DocNumber),CONVERT(DATETIME,ACC.DocDate),T1.DocumentName,ACC.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc))),ACC.Amount,NULL,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,ACC.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM ACC_DocDetails ACC with(nolock) left join ADM_DocumentTypes T1 with(nolock) on ACC.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=ACC.docid and WFT.CCID=40018 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=ACC.AccDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (ACC.CostCenterID=40018) AND ACC.LinkedAccDocDetailsID is null
 UNION ALL 
SELECT ACC.VoucherNo,ACC.DocAbbr,ACC.DocPrefix,CONVERT(BIGINT,ACC.DocNumber),CONVERT(DATETIME,ACC.DocDate),T1.DocumentName,ACC.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc))),ACC.Amount,NULL,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,ACC.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM ACC_DocDetails ACC with(nolock) left join ADM_DocumentTypes T1 with(nolock) on ACC.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=ACC.docid and WFT.CCID=41075 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=ACC.AccDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (ACC.CostCenterID=41075) AND ACC.LinkedAccDocDetailsID is null
 UNION ALL 
SELECT ACC.VoucherNo,ACC.DocAbbr,ACC.DocPrefix,CONVERT(BIGINT,ACC.DocNumber),CONVERT(DATETIME,ACC.DocDate),T1.DocumentName,ACC.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc))),ACC.Amount,NULL,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,ACC.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM ACC_DocDetails ACC with(nolock) left join ADM_DocumentTypes T1 with(nolock) on ACC.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=ACC.docid and WFT.CCID=41117 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=ACC.AccDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (ACC.CostCenterID=41117) AND ACC.LinkedAccDocDetailsID is null
 UNION ALL 
SELECT ACC.VoucherNo,ACC.DocAbbr,ACC.DocPrefix,CONVERT(BIGINT,ACC.DocNumber),CONVERT(DATETIME,ACC.DocDate),T1.DocumentName,ACC.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc))),ACC.Amount,NULL,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,ACC.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM ACC_DocDetails ACC with(nolock) left join ADM_DocumentTypes T1 with(nolock) on ACC.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=ACC.docid and WFT.CCID=40019 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=ACC.AccDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (ACC.CostCenterID=40019) AND ACC.LinkedAccDocDetailsID is null
 UNION ALL 
SELECT ACC.VoucherNo,ACC.DocAbbr,ACC.DocPrefix,CONVERT(BIGINT,ACC.DocNumber),CONVERT(DATETIME,ACC.DocDate),T1.DocumentName,ACC.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc))),ACC.Amount,NULL,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,ACC.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM ACC_DocDetails ACC with(nolock) left join ADM_DocumentTypes T1 with(nolock) on ACC.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=ACC.docid and WFT.CCID=40022 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=ACC.AccDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (ACC.CostCenterID=40022) AND ACC.LinkedAccDocDetailsID is null
 UNION ALL 
SELECT ACC.VoucherNo,ACC.DocAbbr,ACC.DocPrefix,CONVERT(BIGINT,ACC.DocNumber),CONVERT(DATETIME,ACC.DocDate),T1.DocumentName,ACC.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc))),ACC.Amount,NULL,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,ACC.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM ACC_DocDetails ACC with(nolock) left join ADM_DocumentTypes T1 with(nolock) on ACC.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=ACC.docid and WFT.CCID=40023 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=ACC.AccDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (ACC.CostCenterID=40023) AND ACC.LinkedAccDocDetailsID is null
 UNION ALL 
SELECT ACC.VoucherNo,ACC.DocAbbr,ACC.DocPrefix,CONVERT(BIGINT,ACC.DocNumber),CONVERT(DATETIME,ACC.DocDate),T1.DocumentName,ACC.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc))),ACC.Amount,NULL,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,ACC.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM ACC_DocDetails ACC with(nolock) left join ADM_DocumentTypes T1 with(nolock) on ACC.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=ACC.docid and WFT.CCID=41095 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=ACC.AccDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (ACC.CostCenterID=41095) AND ACC.LinkedAccDocDetailsID is null
 UNION ALL 
SELECT ACC.VoucherNo,ACC.DocAbbr,ACC.DocPrefix,CONVERT(BIGINT,ACC.DocNumber),CONVERT(DATETIME,ACC.DocDate),T1.DocumentName,ACC.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc))),ACC.Amount,NULL,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,ACC.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM ACC_DocDetails ACC with(nolock) left join ADM_DocumentTypes T1 with(nolock) on ACC.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=ACC.docid and WFT.CCID=40016 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=ACC.AccDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (ACC.CostCenterID=40016) AND ACC.LinkedAccDocDetailsID is null
 UNION ALL 
SELECT ACC.VoucherNo,ACC.DocAbbr,ACC.DocPrefix,CONVERT(BIGINT,ACC.DocNumber),CONVERT(DATETIME,ACC.DocDate),T1.DocumentName,ACC.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc))),ACC.Amount,NULL,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,ACC.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM ACC_DocDetails ACC with(nolock) left join ADM_DocumentTypes T1 with(nolock) on ACC.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=ACC.docid and WFT.CCID=41105 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=ACC.AccDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (ACC.CostCenterID=41105) AND ACC.LinkedAccDocDetailsID is null
 UNION ALL 
SELECT ACC.VoucherNo,ACC.DocAbbr,ACC.DocPrefix,CONVERT(BIGINT,ACC.DocNumber),CONVERT(DATETIME,ACC.DocDate),T1.DocumentName,ACC.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc))),ACC.Amount,NULL,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,ACC.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM ACC_DocDetails ACC with(nolock) left join ADM_DocumentTypes T1 with(nolock) on ACC.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=ACC.docid and WFT.CCID=40017 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=ACC.AccDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (ACC.CostCenterID=40017) AND ACC.LinkedAccDocDetailsID is null
 UNION ALL 
SELECT ACC.VoucherNo,ACC.DocAbbr,ACC.DocPrefix,CONVERT(BIGINT,ACC.DocNumber),CONVERT(DATETIME,ACC.DocDate),T1.DocumentName,ACC.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc))),ACC.Amount,NULL,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,ACC.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM ACC_DocDetails ACC with(nolock) left join ADM_DocumentTypes T1 with(nolock) on ACC.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=ACC.docid and WFT.CCID=41089 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=ACC.AccDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (ACC.CostCenterID=41089) AND ACC.LinkedAccDocDetailsID is null
 UNION ALL 
SELECT ACC.VoucherNo,ACC.DocAbbr,ACC.DocPrefix,CONVERT(BIGINT,ACC.DocNumber),CONVERT(DATETIME,ACC.DocDate),T1.DocumentName,ACC.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc))),ACC.Amount,NULL,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,ACC.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM ACC_DocDetails ACC with(nolock) left join ADM_DocumentTypes T1 with(nolock) on ACC.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=ACC.docid and WFT.CCID=41087 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=ACC.AccDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (ACC.CostCenterID=41087) AND ACC.LinkedAccDocDetailsID is null
 UNION ALL 
SELECT ACC.VoucherNo,ACC.DocAbbr,ACC.DocPrefix,CONVERT(BIGINT,ACC.DocNumber),CONVERT(DATETIME,ACC.DocDate),T1.DocumentName,ACC.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc))),ACC.Amount,NULL,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,ACC.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM ACC_DocDetails ACC with(nolock) left join ADM_DocumentTypes T1 with(nolock) on ACC.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=ACC.docid and WFT.CCID=41104 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=ACC.AccDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (ACC.CostCenterID=41104) AND ACC.LinkedAccDocDetailsID is null
 UNION ALL 
SELECT ACC.VoucherNo,ACC.DocAbbr,ACC.DocPrefix,CONVERT(BIGINT,ACC.DocNumber),CONVERT(DATETIME,ACC.DocDate),T1.DocumentName,ACC.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc))),ACC.Amount,NULL,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,ACC.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM ACC_DocDetails ACC with(nolock) left join ADM_DocumentTypes T1 with(nolock) on ACC.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=ACC.docid and WFT.CCID=41086 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=ACC.AccDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (ACC.CostCenterID=41086) AND ACC.LinkedAccDocDetailsID is null
 UNION ALL 
SELECT ACC.VoucherNo,ACC.DocAbbr,ACC.DocPrefix,CONVERT(BIGINT,ACC.DocNumber),CONVERT(DATETIME,ACC.DocDate),T1.DocumentName,ACC.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc))),ACC.Amount,NULL,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,ACC.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM ACC_DocDetails ACC with(nolock) left join ADM_DocumentTypes T1 with(nolock) on ACC.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=ACC.docid and WFT.CCID=40020 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=ACC.AccDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (ACC.CostCenterID=40020) AND ACC.LinkedAccDocDetailsID is null
 UNION ALL 
SELECT ACC.VoucherNo,ACC.DocAbbr,ACC.DocPrefix,CONVERT(BIGINT,ACC.DocNumber),CONVERT(DATETIME,ACC.DocDate),T1.DocumentName,ACC.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc))),ACC.Amount,NULL,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,ACC.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM ACC_DocDetails ACC with(nolock) left join ADM_DocumentTypes T1 with(nolock) on ACC.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=ACC.docid and WFT.CCID=40021 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=ACC.AccDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (ACC.CostCenterID=40021) AND ACC.LinkedAccDocDetailsID is null
 UNION ALL 
SELECT ACC.VoucherNo,ACC.DocAbbr,ACC.DocPrefix,CONVERT(BIGINT,ACC.DocNumber),CONVERT(DATETIME,ACC.DocDate),T1.DocumentName,ACC.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc))),ACC.Amount,NULL,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,ACC.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM ACC_DocDetails ACC with(nolock) left join ADM_DocumentTypes T1 with(nolock) on ACC.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=ACC.docid and WFT.CCID=40028 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=ACC.AccDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (ACC.CostCenterID=40028) AND ACC.LinkedAccDocDetailsID is null
 UNION ALL 
SELECT ACC.VoucherNo,ACC.DocAbbr,ACC.DocPrefix,CONVERT(BIGINT,ACC.DocNumber),CONVERT(DATETIME,ACC.DocDate),T1.DocumentName,ACC.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=ACC.costcenterid and ccnodeid=ACC.docid AND (DocDetID=0 OR DocDetID=ACC.InvDocDetailsID) order by ApprovalID desc))),ACC.Amount,NULL,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,ACC.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM ACC_DocDetails ACC with(nolock) left join ADM_DocumentTypes T1 with(nolock) on ACC.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on ACC.AccDocDetailsID=TDCC.AccDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=ACC.docid and WFT.CCID=40029 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=ACC.AccDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (ACC.CostCenterID=40029) AND ACC.LinkedAccDocDetailsID is null
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41017 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41017)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41101 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41101)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40006 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40006)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41069 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41069)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41083 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41083)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41034 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41034)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41056 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41056)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41043 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41043)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41006 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41006)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41005 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41005)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41119 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41119)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41084 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41084)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40007 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40007)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41042 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41042)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41118 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41118)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40009 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40009)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41059 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41059)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41079 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41079)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41053 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41053)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41121 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41121)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41007 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41007)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41018 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41018)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41102 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41102)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41016 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41016)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41120 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41120)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41112 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41112)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41071 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41071)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41099 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41099)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41116 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41116)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40011 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40011)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41088 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41088)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41052 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41052)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41066 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41066)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40012 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40012)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41057 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41057)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40024 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40024)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40994 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40994)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40993 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40993)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41070 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41070)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41050 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41050)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41030 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41030)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41029 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41029)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41072 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41072)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41067 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41067)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41081 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41081)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41092 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41092)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41103 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41103)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41008 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41008)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41009 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41009)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41097 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41097)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41012 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41012)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41013 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41013)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41014 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41014)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41011 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41011)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41015 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41015)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40001 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40001)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41073 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41073)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41058 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41058)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41085 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41085)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41022 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41022)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41114 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41114)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41115 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41115)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41100 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41100)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41076 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41076)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41106 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41106)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41108 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41108)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41038 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41038)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41023 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41023)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41051 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41051)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41004 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41004)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41021 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41021)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41111 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41111)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41096 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41096)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40002 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40002)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41019 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41019)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41064 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41064)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41107 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41107)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41047 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41047)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41113 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41113)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40004 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40004)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41078 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41078)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41054 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41054)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41082 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41082)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41010 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41010)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41098 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41098)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40010 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40010)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41041 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41041)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41000 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41000)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41068 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41068)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41110 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41110)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41080 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41080)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41033 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41033)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40025 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40025)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41060 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41060)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41049 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41049)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41002 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41002)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41122 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41122)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41035 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41035)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40026 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40026)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41061 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41061)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41045 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41045)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41037 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41037)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41020 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41020)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41063 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41063)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41044 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41044)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41024 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41024)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41003 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41003)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41036 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41036)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40027 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40027)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41062 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41062)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40003 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40003)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40005 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40005)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40008 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40008)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41040 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41040)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41027 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41027)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40013 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40013)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41039 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41039)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41025 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41025)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40030 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40030)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40031 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40031)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40032 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40032)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40998 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40998)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40999 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40999)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40995 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40995)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40996 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40996)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40997 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40997)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=40045 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=40045)
 UNION ALL 
SELECT INV.VoucherNo,INV.DocAbbr,INV.DocPrefix,CONVERT(BIGINT,INV.DocNumber),CONVERT(DATETIME,INV.DocDate),T1.DocumentName,INV.CommonNarration,T3.Name,T4.Name,T5.Name,(SELECT Status FROM COM_Status with(nolock) WHERE StatusID IN (select statusid from COM_Approvals with(nolock) where ApprovalID IN (select top 1 ApprovalID
from COM_Approvals with(nolock) where RowType=1 and ccid=INV.costcenterid and ccnodeid=INV.docid AND (DocDetID=0 OR DocDetID=INV.InvDocDetailsID) order by ApprovalID desc))),NULL,CASE WHEN (SELECT DocumentType FROM ADM_DocumentTypes WITH(NOLOCK) WHERE CostCenterID=INV.CostCenterID)=38 AND VoucherType=1 THEN -INV.Gross ELSE INV.Gross END,WFTU1.UserName,WFTU1.FirstName,CONVERT(DATETIME,INV.CreatedDate),WFTU2.UserName,WFT.L2Status,WFTU2.FirstName,convert(datetime,floor(WFT.L2CreatedDate)),WFTU3.UserName,WFT.L3Status,WFTU3.FirstName,convert(datetime,floor(WFT.L3CreatedDate)),WFT.L1Status,WFT.L4Status,WFTU4.FirstName,convert(datetime,floor(WFT.L4CreatedDate)),WFTU4.UserName,WFT.L5Status,WFTU5.FirstName,convert(datetime,floor(WFT.L5CreatedDate)),WFTU5.UserName,T1.DocumentName
 FROM INV_DocDetails INV with(nolock) left join ADM_DocumentTypes T1 with(nolock) on INV.CostCenterID=T1.CostCenterID left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_Location T3 with(nolock) on TDCC.dcCCNID2=T3.NodeID left join COM_Division T4 with(nolock) on TDCC.dcCCNID1=T4.NodeID left join COM_CC50009 T5 with(nolock) on TDCC.dcCCNID9=T5.NodeID left join COM_ApprovalSummary WFT on WFT.DocID=INV.docid and WFT.CCID=41124 and (WFT.InvDocDetailsID=0 OR WFT.InvDocDetailsID=INV.InvDocDetailsID) left join ADM_Users WFTU1 with(nolock) on WFT.L1UserID=WFTU1.UserID  left join ADM_Users WFTU2 with(nolock) on WFT.L2UserID=WFTU2.UserID  left join ADM_Users WFTU3 with(nolock) on WFT.L3UserID=WFTU3.UserID  left join ADM_Users WFTU4 with(nolock) on WFT.L4UserID=WFTU4.UserID  left join ADM_Users WFTU5 with(nolock) on WFT.L5UserID=WFTU5.UserID 
 WHERE T4.NodeID IN (1,2,1,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,149) AND T3.NodeID IN (1,13,14,15,16,17,18,19,20,21,22,23) AND (INV.CostCenterID=41124) ORDER BY [Cc46068c4efad4f7d9c21b64414bd05a8] ,[Cdda1c283318d4f85ba78a81b17025d01Abr] ,[Cdda1c283318d4f85ba78a81b17025d01prf] ,[Cdda1c283318d4f85ba78a81b17025d01dno] '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:53.337 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:53.337 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:39:53.337 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:39:53.337 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:39:53.337 | General Service|:: CompanyIndex:30 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzAsMSIsIm5iZiI6MTc1MTUzMDExNywiZXhwIjoxNzUxNTU4OTE3LCJpYXQiOjE3NTE1MzAxMTd9.kUN2smDjzcwxNEzzFrC4nsdLh8JrGaSILcRwNTxtEfQ'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:54.667 | General Service|:: CompanyIndex:12 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:54.667 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:55.214 | General Service|:: CompanyIndex:12 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:55.214 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:55.307 | General Service|:: CompanyIndex:12 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:55.307 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:55.354 | General Service|:: CompanyIndex:12 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:55.354 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:56.705 | General Service|:: CompanyIndex:12 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:56.705 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:56.829 | General Service|:: CompanyIndex:12 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:56.829 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:57.586 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:57.586 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:57.664 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:57.664 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:59.086 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''03 Jul 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:59.101 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:59.461 | General Service|:: CompanyIndex:12 SpName: spADM_GetDashBoard 
 1
 ,2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:39:59.476 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:00.070 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:00.070 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:00.367 | General Service|:: CompanyIndex:12 SpName: spCOM_GetFavorites 
 'VIEW'
 ,557
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:00.367 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:00.367 | General Service|:: CompanyIndex:12 SpName: spCOM_GetFavorites 
 'VIEW'
 ,142
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:00.383 | General Service|:: CompanyIndex:12 SpName: spCOM_GetFavorites 
 'VIEW'
 ,164
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:00.383 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:00.383 | General Service|:: CompanyIndex:12 SpName: spCOM_GetFavorites 
 'VIEW'
 ,27
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:00.383 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:00.383 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:03.499 | General Service|:: CompanyIndex:12 SpName: spADM_GetCostCenterGridViewList 
 86
 ,1
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:03.514 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:04.827 | General Service|:: CompanyIndex:12 SpName: spCom_GetCostCenterSummary 
 250
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'03-Jul-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:04.827 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:07.102 | General Service|:: CompanyIndex:12 SpName: spCom_GetCostCenterQuickViewDefn 
 86
 ,'14'
 ,86
 ,1
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:07.102 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:07.571 | General Service|:: CompanyIndex:12 SpName: spCom_GetCostCenterQuickViewSummary 
 86
 ,'14'
 ,86
 ,'03/Jul/2025 01:40:07 PM'
 ,NULL
 ,0
 ,19
 ,1
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:07.571 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:10.072 | General Service|:: CompanyIndex:12 SpName: spCOM_GetCostCenterScreenDetails 
 86
 ,1
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:10.072 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:10.150 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'SELECT CostCenterColID,QuickAddOrder FROM ADM_CostCenterDef with(nolock) WHERE CostCenterID=86 AND ShowInQuickAdd=1  ORDER BY QuickAddOrder
                    SELECT CostCenterColID,SysColumnName FROM ADM_CostCenterDef with(nolock) WHERE CostCenterID=144 and LocalReference=86 AND ShowInQuickAdd=1'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:10.150 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:14.195 | General Service|:: CompanyIndex:12 SpName: spCRM_GetLead 
 14
 ,1
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:14.195 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:20.275 | General Service|:: CompanyIndex:12 SpName: spCom_GetCostCenterQuickViewSummary 
 86
 ,'9'
 ,86
 ,'03/Jul/2025 01:40:20 PM'
 ,NULL
 ,0
 ,19
 ,1
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:20.290 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:24.346 | General Service|:: CompanyIndex:12 SpName: spCOM_GetCostCenterScreenDetails 
 86
 ,1
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:24.362 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:24.737 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'SELECT CostCenterColID,QuickAddOrder FROM ADM_CostCenterDef with(nolock) WHERE CostCenterID=86 AND ShowInQuickAdd=1  ORDER BY QuickAddOrder
                    SELECT CostCenterColID,SysColumnName FROM ADM_CostCenterDef with(nolock) WHERE CostCenterID=144 and LocalReference=86 AND ShowInQuickAdd=1'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:24.752 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:25.698 | General Service|:: CompanyIndex:12 SpName: spCRM_GetLead 
 9
 ,1
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:25.698 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:28.386 | General Service|:: CompanyIndex:12 SpName: spCOM_GetCostCenterScreenDetails 
 86
 ,1
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:28.401 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:29.292 | General Service|:: CompanyIndex:12 SpName: spCOM_GetDimensionTabGridData 
 86
 ,144
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:29.307 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:30.916 | General Service|:: CompanyIndex:12 SpName: SPCRM_GetActivitiesCustomFields 
 86
 ,9
 ,'admin'
 ,1
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:30.916 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:30.963 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 ' select Name,value from [com_Costcenterpreferences] with(nolock) where CostCenterID=1000 '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:30.963 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:30.979 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:31.042 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select UserName,UserID from dbo.adm_users with(nolock) where isuserdeleted=0 and StatusID=1'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:31.042 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:31.292 | General Service|:: CompanyIndex:12 SpName: spCOM_GetWorkFlowScreenDetails 
 NULL
 ,NULL
 ,'1'
 ,'1'
 ,1
 ,True
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:31.292 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:31.323 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select Name,value from [com_Costcenterpreferences] with(nolock) where CostCenterID=86'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:31.323 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:31.401 | General Service|:: CompanyIndex:12 SpName: spCRM_GetAssignedList 
 86
 ,9
 ,0
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:31.401 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:31.448 | General Service|:: CompanyIndex:12 SpName: SPCRM_GetSuppliersByCRMProducts 
 86
 ,9
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:31.448 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:31.619 | General Service|:: CompanyIndex:12 SpName: SPCRM_GetFeedbackDetails 
 114
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:31.619 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:31.651 | General Service|:: CompanyIndex:12 SpName: SPCRM_GetFeedbackDetails 
 146
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:31.651 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:31.666 | General Service|:: CompanyIndex:12 SpName: SPCRM_GetFeedbackDetails 
 146
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:31.682 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:31.713 | General Service|:: CompanyIndex:12 SpName: spCOM_GetWorkFlowScreenDetails 
 NULL
 ,NULL
 ,'1'
 ,'1'
 ,1
 ,False
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:31.713 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:31.791 | General Service|:: CompanyIndex:12 SpName: spCRM_GetPreferencesatCRM 
 86
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:31.791 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:31.838 | General Service|:: CompanyIndex:12 SpName: SPCRM_GetFeedbackDetails 
 115
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:31.838 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:31.885 | General Service|:: CompanyIndex:12 SpName: SPCRM_GetProductValueMapping 
 86
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:31.885 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:31.963 | General Service|:: CompanyIndex:12 SpName: spCOM_GetCostCenterScreenDetails 
 65
 ,1
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:31.963 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:32.026 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'SELECT CostCenterColID,QuickAddOrder FROM ADM_CostCenterDef with(nolock) WHERE CostCenterID=65 AND ShowInQuickAdd=1  ORDER BY QuickAddOrder
                    SELECT CostCenterColID,SysColumnName FROM ADM_CostCenterDef with(nolock) WHERE CostCenterID=144 and LocalReference=65 AND ShowInQuickAdd=1'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:32.026 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:32.057 | General Service|:: CompanyIndex:12 SpName: spCOM_GetDimensionTabGridData 
 86
 ,65
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:32.057 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:32.729 | General Service|:: CompanyIndex:12 SpName: spCRM_GetLead 
 9
 ,1
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:32.744 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:32.901 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 ' SELECT * FROM CRM_ASSIGNMENT WITH(NOLOCK) WHERE CCID=86 AND CCNODEID=9 AND ISFROMACTIVITY IS NOT NULL     SELECT a.* FROM COM_FILES a WITH(NOLOCK) join CRM_Activities b WITH(NOLOCK) on a.FEATUREPK=b.ActivityID WHERE a.FEATUREID=144 and b.CostCenterID=86 and b.NodeID=9   exec spCRM_GetAssignedListForActivities 86,9 ,0 '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:32.901 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:32.947 | General Service|:: CompanyIndex:12 SpName: spCOM_GetCostCenterScreenDetails 
 65
 ,1
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:32.947 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:32.963 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'SELECT CostCenterColID,QuickAddOrder FROM ADM_CostCenterDef with(nolock) WHERE CostCenterID=65 AND ShowInQuickAdd=1  ORDER BY QuickAddOrder
                    SELECT CostCenterColID,SysColumnName FROM ADM_CostCenterDef with(nolock) WHERE CostCenterID=144 and LocalReference=65 AND ShowInQuickAdd=1'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:32.963 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:32.994 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 ' declare @UserID int,@RoleID int        set @UserID=1 set @RoleID=1    
        SELECT R.ReportID,Q.ReportName,Q.ReportField,Q.ReportFieldName,Q.DocumentField,Q.DocumentFieldName,A.SysColumnName,Q.Shortcut,Q.DisplayAsPopup,Q.GroupLevel,Q.Width ,Q.Height,Q.mapxml,Q.MapType
        FROM ADM_RevenUReports R  with(nolock)
        inner join ADM_DocumentReports Q WITH(NOLOCK) on Q.DocumentReportID=R.ReportID
        left join ADM_CostCenterDef A WITH(NOLOCK) on A.CostCenterColID=Q.DocumentField 
        left join [ADM_DocReportUserRoleMap] DR WITH(NOLOCK) on DR.DocumentViewID=Q.DocumentViewID and DR.CostCenterID=Q.CostCenterID
        where  Q.CostCenterID=86 and (DR.UserID=@UserID OR DR.RoleID=@RoleID OR GroupID IN (SELECT GroupID FROM COM_Groups WITH(NOLOCK) WHERE UserID=@UserID OR RoleID=@RoleID))
        GROUP BY  Q.ReportID, R.ReportID,Q.ReportName,Q.ReportField,Q.ReportFieldName,Q.DocumentField,Q.DocumentFieldName,A.SysColumnName,Q.Shortcut,Q.DisplayAsPopup,Q.GroupLevel ,Q.Width,Q.Height,Q.mapxml,Q.MapType 
        order by Q.ReportID '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:32.994 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:33.276 | General Service|:: CompanyIndex:12 SpName: spADM_GetCostCenterListViewData 
 4
 ,'a.AccountName,a.AccountCode'
 ,''
 ,''
 ,'AccountName'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:33.276 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:33.307 | General Service|:: CompanyIndex:12 SpName: spADM_GetCostCenterListViewData 
 275
 ,'a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,1
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:33.307 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:33.338 | General Service|:: CompanyIndex:12 SpName: spADM_GetCostCenterListViewData 
 4
 ,'a.AccountName,a.AccountCode'
 ,''
 ,''
 ,'AccountName'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:33.338 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:33.369 | General Service|:: CompanyIndex:12 SpName: spADM_GetCostCenterListViewData 
 234
 ,'a.Name,a.Code,a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,1
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:33.369 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:33.416 | General Service|:: CompanyIndex:12 SpName: spADM_GetCostCenterListViewData 
 500008
 ,'a.Code,a.AliasName'
 ,''
 ,''
 ,'Code'
 ,''
 ,8
 ,False
 ,''
 ,1
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:33.416 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:33.447 | General Service|:: CompanyIndex:12 SpName: spADM_GetCostCenterListViewData 
 531
 ,'a.Name'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:33.463 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:33.816 | General Service|:: CompanyIndex:12 SpName: spADM_GetCostCenterListViewData 
 284
 ,'a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,1
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:33.816 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:33.863 | General Service|:: CompanyIndex:12 SpName: spADM_GetCostCenterListViewData 
 283
 ,'a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,9
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:33.863 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.191 | General Service|:: CompanyIndex:12 SpName: spCOM_GetCostCenterScreenDetails 
 86
 ,1
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.191 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.238 | General Service|:: CompanyIndex:12 SpName: spCOM_GetDimensionTabGridData 
 86
 ,144
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.253 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.316 | General Service|:: CompanyIndex:12 SpName: SPCRM_GetActivitiesCustomFields 
 86
 ,9
 ,'admin'
 ,1
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.316 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.347 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 ' select Name,value from [com_Costcenterpreferences] with(nolock) where CostCenterID=1000 '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.363 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.378 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.410 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select UserName,UserID from dbo.adm_users with(nolock) where isuserdeleted=0 and StatusID=1'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.410 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.441 | General Service|:: CompanyIndex:12 SpName: spCOM_GetWorkFlowScreenDetails 
 NULL
 ,NULL
 ,'1'
 ,'1'
 ,1
 ,True
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.441 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.472 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select Name,value from [com_Costcenterpreferences] with(nolock) where CostCenterID=86'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.472 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.503 | General Service|:: CompanyIndex:12 SpName: spCRM_GetAssignedList 
 86
 ,9
 ,0
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.503 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.535 | General Service|:: CompanyIndex:12 SpName: SPCRM_GetSuppliersByCRMProducts 
 86
 ,9
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.535 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.566 | General Service|:: CompanyIndex:12 SpName: SPCRM_GetFeedbackDetails 
 114
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.566 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.597 | General Service|:: CompanyIndex:12 SpName: SPCRM_GetFeedbackDetails 
 146
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.597 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.613 | General Service|:: CompanyIndex:12 SpName: SPCRM_GetFeedbackDetails 
 146
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.628 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.660 | General Service|:: CompanyIndex:12 SpName: spCOM_GetWorkFlowScreenDetails 
 NULL
 ,NULL
 ,'1'
 ,'1'
 ,1
 ,False
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.660 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.675 | General Service|:: CompanyIndex:12 SpName: spCRM_GetPreferencesatCRM 
 86
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.691 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.722 | General Service|:: CompanyIndex:12 SpName: SPCRM_GetFeedbackDetails 
 115
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.722 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.738 | General Service|:: CompanyIndex:12 SpName: SPCRM_GetProductValueMapping 
 86
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.753 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.800 | General Service|:: CompanyIndex:12 SpName: spCOM_GetCostCenterScreenDetails 
 65
 ,1
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.800 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.832 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'SELECT CostCenterColID,QuickAddOrder FROM ADM_CostCenterDef with(nolock) WHERE CostCenterID=65 AND ShowInQuickAdd=1  ORDER BY QuickAddOrder
                    SELECT CostCenterColID,SysColumnName FROM ADM_CostCenterDef with(nolock) WHERE CostCenterID=144 and LocalReference=65 AND ShowInQuickAdd=1'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.832 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.847 | General Service|:: CompanyIndex:12 SpName: spCOM_GetDimensionTabGridData 
 86
 ,65
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:34.863 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:35.050 | General Service|:: CompanyIndex:12 SpName: spCRM_GetLead 
 9
 ,1
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:35.050 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:35.081 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 ' SELECT * FROM CRM_ASSIGNMENT WITH(NOLOCK) WHERE CCID=86 AND CCNODEID=9 AND ISFROMACTIVITY IS NOT NULL     SELECT a.* FROM COM_FILES a WITH(NOLOCK) join CRM_Activities b WITH(NOLOCK) on a.FEATUREPK=b.ActivityID WHERE a.FEATUREID=144 and b.CostCenterID=86 and b.NodeID=9   exec spCRM_GetAssignedListForActivities 86,9 ,0 '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:35.081 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:35.128 | General Service|:: CompanyIndex:12 SpName: spCOM_GetCostCenterScreenDetails 
 65
 ,1
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:35.128 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:35.144 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'SELECT CostCenterColID,QuickAddOrder FROM ADM_CostCenterDef with(nolock) WHERE CostCenterID=65 AND ShowInQuickAdd=1  ORDER BY QuickAddOrder
                    SELECT CostCenterColID,SysColumnName FROM ADM_CostCenterDef with(nolock) WHERE CostCenterID=144 and LocalReference=65 AND ShowInQuickAdd=1'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:35.144 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:35.160 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 ' declare @UserID int,@RoleID int        set @UserID=1 set @RoleID=1    
        SELECT R.ReportID,Q.ReportName,Q.ReportField,Q.ReportFieldName,Q.DocumentField,Q.DocumentFieldName,A.SysColumnName,Q.Shortcut,Q.DisplayAsPopup,Q.GroupLevel,Q.Width ,Q.Height,Q.mapxml,Q.MapType
        FROM ADM_RevenUReports R  with(nolock)
        inner join ADM_DocumentReports Q WITH(NOLOCK) on Q.DocumentReportID=R.ReportID
        left join ADM_CostCenterDef A WITH(NOLOCK) on A.CostCenterColID=Q.DocumentField 
        left join [ADM_DocReportUserRoleMap] DR WITH(NOLOCK) on DR.DocumentViewID=Q.DocumentViewID and DR.CostCenterID=Q.CostCenterID
        where  Q.CostCenterID=86 and (DR.UserID=@UserID OR DR.RoleID=@RoleID OR GroupID IN (SELECT GroupID FROM COM_Groups WITH(NOLOCK) WHERE UserID=@UserID OR RoleID=@RoleID))
        GROUP BY  Q.ReportID, R.ReportID,Q.ReportName,Q.ReportField,Q.ReportFieldName,Q.DocumentField,Q.DocumentFieldName,A.SysColumnName,Q.Shortcut,Q.DisplayAsPopup,Q.GroupLevel ,Q.Width,Q.Height,Q.mapxml,Q.MapType 
        order by Q.ReportID '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:35.160 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:35.207 | General Service|:: CompanyIndex:12 SpName: spADM_GetCostCenterListViewData 
 4
 ,'a.AccountName,a.AccountCode'
 ,''
 ,''
 ,'AccountName'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:35.207 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:35.238 | General Service|:: CompanyIndex:12 SpName: spADM_GetCostCenterListViewData 
 275
 ,'a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,1
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:35.238 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:35.269 | General Service|:: CompanyIndex:12 SpName: spADM_GetCostCenterListViewData 
 4
 ,'a.AccountName,a.AccountCode'
 ,''
 ,''
 ,'AccountName'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:35.269 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:35.300 | General Service|:: CompanyIndex:12 SpName: spADM_GetCostCenterListViewData 
 234
 ,'a.Name,a.Code,a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,1
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:35.300 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:35.331 | General Service|:: CompanyIndex:12 SpName: spADM_GetCostCenterListViewData 
 500008
 ,'a.Code,a.AliasName'
 ,''
 ,''
 ,'Code'
 ,''
 ,8
 ,False
 ,''
 ,1
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:35.331 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:35.363 | General Service|:: CompanyIndex:12 SpName: spADM_GetCostCenterListViewData 
 531
 ,'a.Name'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:35.363 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:35.488 | General Service|:: CompanyIndex:12 SpName: spADM_GetCostCenterListViewData 
 284
 ,'a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,1
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:35.503 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:35.519 | General Service|:: CompanyIndex:12 SpName: spADM_GetCostCenterListViewData 
 283
 ,'a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,9
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:35.534 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:38.331 | General Service|:: CompanyIndex:12 SpName: spCOM_GetWorkFlowScreenDetails 
 NULL
 ,NULL
 ,'1'
 ,'1'
 ,1
 ,True
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:38.347 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:38.362 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select Name,value from [com_Costcenterpreferences] with(nolock) where CostCenterID=86'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:38.362 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:38.378 | General Service|:: CompanyIndex:12 SpName: spCRM_GetAssignedList 
 86
 ,9
 ,0
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:38.394 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:46.041 | General Service|:: CompanyIndex:12 SpName: spCOM_GetWorkFlowScreenDetails 
 NULL
 ,NULL
 ,'1'
 ,'1'
 ,1
 ,True
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:46.057 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:46.072 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select Name,value from [com_Costcenterpreferences] with(nolock) where CostCenterID=86'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:46.072 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:46.088 | General Service|:: CompanyIndex:12 SpName: spCRM_GetAssignedList 
 86
 ,9
 ,0
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:46.103 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:52.370 | General Service|:: CompanyIndex:12 SpName: spCOM_GetWorkFlowScreenDetails 
 NULL
 ,NULL
 ,'1'
 ,'1'
 ,1
 ,True
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:52.370 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:52.401 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select Name,value from [com_Costcenterpreferences] with(nolock) where CostCenterID=86'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:52.401 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:52.417 | General Service|:: CompanyIndex:12 SpName: spCRM_GetAssignedList 
 86
 ,9
 ,0
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:52.432 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:57.813 | General Service|:: CompanyIndex:12 SpName: spCRM_SetCRMAssignment 
 86
 ,9
 ,0
 ,0
 ,0
 ,'10130'
 ,''
 ,''
 ,''
 ,'admin'
 ,'admin'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:57.813 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:59.323 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:40:59.339 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:14.784 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 6
 ,'4cda6970-d5e4-41dd-afbe-4cc59497227f'
 ,''
 ,''
 ,''
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:14.784 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:14.925 | General Service|:: CompanyIndex:12 SpName: sp_SetTokenHistory 
 0
 ,'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'
 ,''
 ,NULL
 ,1
 ,1
 message=Saved Succesfully
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:14.940 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTIsMSIsIm5iZiI6MTc1MTUzMDE4NywiZXhwIjoxNzUxNTU4OTg3LCJpYXQiOjE3NTE1MzAxODd9.QXV3O4_a99eD-_xfZA_QZnu15Y7k3krYGoBmi2FkK2U'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:42.572 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'walter'
 ,1
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:42.619 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'walter'
 ,0
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:42.869 | General Service|:: CompanyIndex:53 SpName: spADM_GetClientUserDetails 
 'walter'
 ,1
 ,'26.0.3'
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:42.994 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'walter'
 ,53
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:43.010 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,53
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:43.010 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:43.025 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:43.057 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''7c135192-5717-4fae-b267-bde3ccc2dd4d''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''Walter''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.99'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,53,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:43.072 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:43.088 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:43.103 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:43.119 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:43.119 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:43.681 | General Service|:: CompanyIndex:53 SpName: spADM_GetRibbonView 
 20038
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:43.681 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:43.900 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'20038'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:43.900 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:43.931 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:43.931 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:44.072 | General Service|:: CompanyIndex:53 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'20038'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:44.072 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:44.103 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:44.103 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:44.181 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:44.197 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:44.306 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:44.306 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:44.353 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:44.353 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:45.197 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''Walter''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''Walter'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''Walter'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''03 Jul 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=20038
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=20038
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=20038
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''Walter'')                         
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:45.212 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:45.494 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:45.494 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:45.572 | General Service|:: CompanyIndex:53 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'20038'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:45.572 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:45.603 | General Service|:: CompanyIndex:53 SpName: spCOM_GetFavorites 
 'VIEW'
 ,1
 ,'20038'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:45.603 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:50.160 | General Service|:: CompanyIndex:53 SpName: spADM_GetCostCenterGridViewList 
 86
 ,20038
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:50.160 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:50.988 | General Service|:: CompanyIndex:53 SpName: spCom_GetCostCenterSummary 
 250
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'03-Jul-2025'
 ,NULL
 ,''
 ,20038
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:50.988 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:53.347 | General Service|:: CompanyIndex:53 SpName: spCom_GetCostCenterQuickViewDefn 
 86
 ,'39'
 ,86
 ,20038
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:53.347 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:53.597 | General Service|:: CompanyIndex:53 SpName: spCom_GetCostCenterQuickViewSummary 
 86
 ,'39'
 ,86
 ,'03/Jul/2025 01:41:53 PM'
 ,NULL
 ,0
 ,19
 ,20038
 ,1
 ,1
 message=Invalid column name 'LDAlpha6'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:53.597 | General Service|:: CompanyIndex:53 SpName: spCom_GetCostCenterQuickViewSummary 
 86
 ,'39'
 ,86
 ,'03/Jul/2025 01:41:53 PM'
 ,NULL
 ,0
 ,19
 ,20038
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.99] INFO | 07-03-2025 13:41:53.597 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.99] INFO | 07-03-2025 13:41:53.597 | OnStartup: Application Starting...
[System: 192.168.1.99] ERROR | 07-03-2025 13:41:53.597 | General Service|:: CompanyIndex:53 SpName: spCom_GetCostCenterQuickViewSummaryParameters :
 86
 ,'39'
 ,86
 ,'03/Jul/2025 01:41:53 PM'
 ,NULL
 ,0
 ,19
 ,20038
 ,1
 ,1|Invalid column name 'LDAlpha6'.
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:53.612 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:53.706 | General Service|:: CompanyIndex:53 SpName: spCOM_GetCostCenterScreenDetails 
 86
 ,20038
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:53.706 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:53.925 | General Service|:: CompanyIndex:53 SpName: spCOM_GetDimensionTabGridData 
 86
 ,144
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:53.925 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:55.884 | General Service|:: CompanyIndex:53 SpName: SPCRM_GetActivitiesCustomFields 
 86
 ,39
 ,'Walter'
 ,20038
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:55.884 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:55.916 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 ' select Name,value from [com_Costcenterpreferences] with(nolock) where CostCenterID=1000 '
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:55.916 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:55.947 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:55.978 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select UserName,UserID from dbo.adm_users with(nolock) where isuserdeleted=0 and StatusID=1 and userid in (select nodeid from dbo.COM_CostCenterCostCenterMap  with(nolock)  where Parentcostcenterid=7 and costcenterid=7 and ParentNodeid=20038) '
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:55.978 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.056 | General Service|:: CompanyIndex:53 SpName: spCOM_GetWorkFlowScreenDetails 
 NULL
 ,NULL
 ,'20038'
 ,'1'
 ,1
 ,True
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.056 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.072 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select Name,value from [com_Costcenterpreferences] with(nolock) where CostCenterID=86'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.072 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.244 | General Service|:: CompanyIndex:53 SpName: spCRM_GetAssignedList 
 86
 ,39
 ,0
 ,'20038'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.244 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.306 | General Service|:: CompanyIndex:53 SpName: SPCRM_GetSuppliersByCRMProducts 
 86
 ,39
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.306 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.478 | General Service|:: CompanyIndex:53 SpName: SPCRM_GetFeedbackDetails 
 114
 ,'20038'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.494 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.509 | General Service|:: CompanyIndex:53 SpName: SPCRM_GetFeedbackDetails 
 146
 ,'20038'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.525 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.556 | General Service|:: CompanyIndex:53 SpName: SPCRM_GetFeedbackDetails 
 146
 ,'20038'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.556 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.587 | General Service|:: CompanyIndex:53 SpName: spCOM_GetWorkFlowScreenDetails 
 NULL
 ,NULL
 ,'20038'
 ,'1'
 ,1
 ,False
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.603 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.634 | General Service|:: CompanyIndex:53 SpName: spCRM_GetPreferencesatCRM 
 86
 ,'20038'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.650 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.681 | General Service|:: CompanyIndex:53 SpName: SPCRM_GetFeedbackDetails 
 115
 ,'20038'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.681 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.744 | General Service|:: CompanyIndex:53 SpName: SPCRM_GetProductValueMapping 
 86
 ,'20038'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.744 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.790 | General Service|:: CompanyIndex:53 SpName: spCOM_GetCostCenterScreenDetails 
 65
 ,20038
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.790 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.806 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT CostCenterColID,QuickAddOrder FROM ADM_CostCenterDef with(nolock) WHERE CostCenterID=65 AND ShowInQuickAdd=1  ORDER BY QuickAddOrder
                    SELECT CostCenterColID,SysColumnName FROM ADM_CostCenterDef with(nolock) WHERE CostCenterID=144 and LocalReference=65 AND ShowInQuickAdd=1'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.822 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.853 | General Service|:: CompanyIndex:53 SpName: spCOM_GetDimensionTabGridData 
 86
 ,65
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:56.853 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:57.728 | General Service|:: CompanyIndex:53 SpName: spCRM_GetLead 
 39
 ,20038
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:57.743 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:58.103 | General Service|:: CompanyIndex:53 SpName: spCRM_GetCustomerDetails 
 20
 ,20038
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:58.103 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:58.181 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 ' SELECT * FROM CRM_ASSIGNMENT WITH(NOLOCK) WHERE CCID=86 AND CCNODEID=39 AND ISFROMACTIVITY IS NOT NULL     SELECT a.* FROM COM_FILES a WITH(NOLOCK) join CRM_Activities b WITH(NOLOCK) on a.FEATUREPK=b.ActivityID WHERE a.FEATUREID=144 and b.CostCenterID=86 and b.NodeID=39   exec spCRM_GetAssignedListForActivities 86,39 ,0 '
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:58.181 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:58.212 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT FEATUREID,Name FROM ADM_FEATURES WHERE ((FeatureID > 50000) AND IsEnabled=1 AND FeatureID not in(50013) )'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:58.212 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:58.243 | General Service|:: CompanyIndex:53 SpName: spCOM_GetCostCenterScreenDetails 
 65
 ,20038
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:58.259 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:58.275 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT CostCenterColID,QuickAddOrder FROM ADM_CostCenterDef with(nolock) WHERE CostCenterID=65 AND ShowInQuickAdd=1  ORDER BY QuickAddOrder
                    SELECT CostCenterColID,SysColumnName FROM ADM_CostCenterDef with(nolock) WHERE CostCenterID=144 and LocalReference=65 AND ShowInQuickAdd=1'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:58.290 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:58.384 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 ' declare @UserID int,@RoleID int        set @UserID=20038 set @RoleID=1    
        SELECT R.ReportID,Q.ReportName,Q.ReportField,Q.ReportFieldName,Q.DocumentField,Q.DocumentFieldName,A.SysColumnName,Q.Shortcut,Q.DisplayAsPopup,Q.GroupLevel,Q.Width ,Q.Height,Q.mapxml,Q.MapType
        FROM ADM_RevenUReports R  with(nolock)
        inner join ADM_DocumentReports Q WITH(NOLOCK) on Q.DocumentReportID=R.ReportID
        left join ADM_CostCenterDef A WITH(NOLOCK) on A.CostCenterColID=Q.DocumentField 
        left join [ADM_DocReportUserRoleMap] DR WITH(NOLOCK) on DR.DocumentViewID=Q.DocumentViewID and DR.CostCenterID=Q.CostCenterID
        where  Q.CostCenterID=86 and (DR.UserID=@UserID OR DR.RoleID=@RoleID OR GroupID IN (SELECT GroupID FROM COM_Groups WITH(NOLOCK) WHERE UserID=@UserID OR RoleID=@RoleID))
        GROUP BY  Q.ReportID, R.ReportID,Q.ReportName,Q.ReportField,Q.ReportFieldName,Q.DocumentField,Q.DocumentFieldName,A.SysColumnName,Q.Shortcut,Q.DisplayAsPopup,Q.GroupLevel ,Q.Width,Q.Height,Q.mapxml,Q.MapType 
        order by Q.ReportID '
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:58.384 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:58.603 | General Service|:: CompanyIndex:53 SpName: spADM_GetCostCenterListViewData 
 275
 ,'a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,28
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'20038'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:58.618 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:58.665 | General Service|:: CompanyIndex:53 SpName: spADM_GetCostCenterListViewData 
 405
 ,'a.CustomerName,a.CustomerCode'
 ,''
 ,''
 ,'CustomerName'
 ,''
 ,8
 ,False
 ,''
 ,20
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'20038'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:58.665 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:58.728 | General Service|:: CompanyIndex:53 SpName: spADM_GetCostCenterListViewData 
 274
 ,'a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,10
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'20038'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:58.728 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:58.759 | General Service|:: CompanyIndex:53 SpName: spADM_GetCostCenterListViewData 
 370
 ,'a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,19
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'20038'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:58.759 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:58.806 | General Service|:: CompanyIndex:53 SpName: spADM_GetCostCenterListViewData 
 308
 ,'a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,1
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'20038'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:58.821 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:58.853 | General Service|:: CompanyIndex:53 SpName: spADM_GetCostCenterListViewData 
 500002
 ,'a.Name'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,9
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'20038'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:41:58.868 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:42:00.680 | General Service|:: CompanyIndex:53 SpName: spCOM_GetWorkFlowScreenDetails 
 NULL
 ,NULL
 ,'20038'
 ,'1'
 ,1
 ,True
[System: 192.168.1.99] DEBUG | 07-03-2025 13:42:00.696 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:42:00.712 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select Name,value from [com_Costcenterpreferences] with(nolock) where CostCenterID=86'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:42:00.712 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:42:00.727 | General Service|:: CompanyIndex:53 SpName: spCRM_GetAssignedList 
 86
 ,39
 ,0
 ,'20038'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:42:00.743 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:42:07.078 | General Service|:: CompanyIndex:53 SpName: spCOM_GetWorkFlowScreenDetails 
 NULL
 ,NULL
 ,'20038'
 ,'1'
 ,1
 ,True
[System: 192.168.1.99] DEBUG | 07-03-2025 13:42:07.078 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:42:07.093 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select Name,value from [com_Costcenterpreferences] with(nolock) where CostCenterID=86'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:42:07.093 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:42:07.125 | General Service|:: CompanyIndex:53 SpName: spCRM_GetAssignedList 
 86
 ,39
 ,0
 ,'20038'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:42:07.125 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:42:12.078 | General Service|:: CompanyIndex:53 SpName: spCRM_SetCRMAssignment 
 86
 ,39
 ,0
 ,0
 ,0
 ,'1'
 ,''
 ,''
 ,''
 ,'admin'
 ,'Walter'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:42:12.094 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:42:14.932 | General Service|:: CompanyIndex:53 SpName: spCOM_GetWorkFlowScreenDetails 
 NULL
 ,NULL
 ,'20038'
 ,'1'
 ,1
 ,True
[System: 192.168.1.99] DEBUG | 07-03-2025 13:42:14.947 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:42:14.963 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select Name,value from [com_Costcenterpreferences] with(nolock) where CostCenterID=86'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:42:14.963 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:42:14.978 | General Service|:: CompanyIndex:53 SpName: spCRM_GetAssignedList 
 86
 ,39
 ,0
 ,'20038'
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:42:14.978 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:42:45.435 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:42:45.435 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:43:45.285 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:43:45.301 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:44:45.481 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:44:45.512 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:45:45.296 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:45:45.296 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:46:43.123 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 07-03-2025 13:46:43.123 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:46:45.294 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:46:45.294 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:47:45.253 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:47:45.268 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:48:45.286 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:48:45.286 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:49:45.297 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:49:45.297 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:50:45.274 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:50:45.290 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 13:51:04.268 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''62e16687-a9c4-48f3-a1c6-9d5e8d9a2c30''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 13:51:04.283 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTIyNzYzLCJleHAiOjE3NTE1NTE1NjMsImlhdCI6MTc1MTUyMjc2M30.hQKsiAIL-TVZwRMhFg7ZoeOYwQfblInm6Ttugh3dgIk'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:51:43.133 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 07-03-2025 13:51:43.133 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:51:45.294 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:51:45.294 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:52:45.285 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:52:45.285 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:53:45.293 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:53:45.293 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:54:45.285 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:54:45.300 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:55:45.264 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:55:45.279 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:56:43.088 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''7c135192-5717-4fae-b267-bde3ccc2dd4d''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 13:56:43.088 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:56:43.120 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 07-03-2025 13:56:43.120 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:56:45.276 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:56:45.276 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:57:45.280 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:57:45.295 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:58:45.275 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:58:45.275 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:59:45.265 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 13:59:45.265 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:00:45.251 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:00:45.251 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:01:43.119 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 07-03-2025 14:01:43.119 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:01:45.282 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:01:45.282 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:02:45.264 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:02:45.264 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:03:45.286 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:03:45.286 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:04:45.275 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:04:45.275 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:05:45.278 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:05:45.278 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 14:06:04.258 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''62e16687-a9c4-48f3-a1c6-9d5e8d9a2c30''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 14:06:04.274 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTIyNzYzLCJleHAiOjE3NTE1NTE1NjMsImlhdCI6MTc1MTUyMjc2M30.hQKsiAIL-TVZwRMhFg7ZoeOYwQfblInm6Ttugh3dgIk'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:06:43.124 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 07-03-2025 14:06:43.140 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:06:45.270 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:06:45.286 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:07:45.266 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:07:45.281 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:08:45.260 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:08:45.276 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:09:45.265 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:09:45.265 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:10:45.271 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:10:45.271 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:11:43.093 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''7c135192-5717-4fae-b267-bde3ccc2dd4d''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 14:11:43.093 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:11:43.109 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 07-03-2025 14:11:43.124 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:11:45.274 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:11:45.274 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:12:45.244 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:12:45.244 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:13:45.269 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:13:45.269 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:14:45.272 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:14:45.288 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:15:45.249 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:15:45.249 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:16:43.091 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 07-03-2025 14:16:43.107 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:16:45.263 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:16:45.263 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:17:45.265 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:17:45.265 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:18:45.236 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:18:45.236 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:19:45.253 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:19:45.253 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:20:45.249 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:20:45.249 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 14:21:04.266 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''62e16687-a9c4-48f3-a1c6-9d5e8d9a2c30''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 14:21:04.282 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTIyNzYzLCJleHAiOjE3NTE1NTE1NjMsImlhdCI6MTc1MTUyMjc2M30.hQKsiAIL-TVZwRMhFg7ZoeOYwQfblInm6Ttugh3dgIk'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:21:43.102 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 07-03-2025 14:21:43.102 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:21:45.233 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:21:45.233 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:22:45.254 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:22:45.254 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:23:45.256 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:23:45.256 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:24:45.244 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:24:45.244 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:25:45.238 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:25:45.238 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:26:43.073 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''7c135192-5717-4fae-b267-bde3ccc2dd4d''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 14:26:43.073 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:26:43.089 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 07-03-2025 14:26:43.089 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:26:45.233 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:26:45.249 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:27:45.242 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:27:45.242 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:28:45.233 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:28:45.233 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:29:45.230 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:29:45.230 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:30:45.244 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:30:45.244 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:31:43.080 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 07-03-2025 14:31:43.080 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:31:45.227 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:31:45.227 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:32:45.239 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:32:45.239 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:33:45.229 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:33:45.229 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:34:45.226 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:34:45.226 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:35:45.227 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:35:45.242 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 14:36:04.267 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''62e16687-a9c4-48f3-a1c6-9d5e8d9a2c30''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 14:36:04.282 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTIyNzYzLCJleHAiOjE3NTE1NTE1NjMsImlhdCI6MTc1MTUyMjc2M30.hQKsiAIL-TVZwRMhFg7ZoeOYwQfblInm6Ttugh3dgIk'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:36:43.075 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 07-03-2025 14:36:43.075 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:36:45.234 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:36:45.234 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:37:45.707 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:37:45.707 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:38:46.716 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:38:46.716 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:39:47.705 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:39:47.705 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:40:48.714 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:40:48.714 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:41:43.677 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''7c135192-5717-4fae-b267-bde3ccc2dd4d''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 07-03-2025 14:41:43.677 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:41:49.671 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 07-03-2025 14:41:49.671 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:41:49.718 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:41:49.734 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:42:50.725 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:42:50.725 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:43:51.715 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:43:51.715 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:44:52.716 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:44:52.716 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:45:53.711 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=20038
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,20038
 ,1
[System: 192.168.1.99] DEBUG | 07-03-2025 14:45:53.711 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IndhbHRlciwyMDAzOCw1MywxIiwibmJmIjoxNzUxNTMwMzAyLCJleHAiOjE3NTE1NTkxMDIsImlhdCI6MTc1MTUzMDMwMn0.bq7pwQ9k7RmGzheJ7ATUjNfxSexor3Zwvwbsa-cA30c'''
 ,1
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 14:51:04.249 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''62e16687-a9c4-48f3-a1c6-9d5e8d9a2c30''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 14:51:04.265 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTIyNzYzLCJleHAiOjE3NTE1NTE1NjMsImlhdCI6MTc1MTUyMjc2M30.hQKsiAIL-TVZwRMhFg7ZoeOYwQfblInm6Ttugh3dgIk'''
 ,1
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 15:06:04.240 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''62e16687-a9c4-48f3-a1c6-9d5e8d9a2c30''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 15:06:04.255 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTIyNzYzLCJleHAiOjE3NTE1NTE1NjMsImlhdCI6MTc1MTUyMjc2M30.hQKsiAIL-TVZwRMhFg7ZoeOYwQfblInm6Ttugh3dgIk'''
 ,1
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 15:21:04.243 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''62e16687-a9c4-48f3-a1c6-9d5e8d9a2c30''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 15:21:04.243 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTIyNzYzLCJleHAiOjE3NTE1NTE1NjMsImlhdCI6MTc1MTUyMjc2M30.hQKsiAIL-TVZwRMhFg7ZoeOYwQfblInm6Ttugh3dgIk'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:03.403 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:03.450 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.76'
 ,'192.168.1.76'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:07.838 | General Service|:: CompanyIndex:7 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.0.2'
 ,0
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:07.916 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,7
 ,'192.168.1.76'
 ,'192.168.1.76'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:07.932 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,7
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:07.947 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:07.947 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTM2Mzg3LCJleHAiOjE3NTE1NjUxODcsImlhdCI6MTc1MTUzNjM4N30.DlY9KiP8IixRrJ9Sm5aa7wTzczOJdvf85RE8dvhT1lo'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:07.979 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''4699d07b-842a-4880-8ecc-3edd0831042a''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.76'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,7,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:07.994 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTM2Mzg3LCJleHAiOjE3NTE1NjUxODcsImlhdCI6MTc1MTUzNjM4N30.DlY9KiP8IixRrJ9Sm5aa7wTzczOJdvf85RE8dvhT1lo'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:08.010 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:08.010 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTM2Mzg3LCJleHAiOjE3NTE1NjUxODcsImlhdCI6MTc1MTUzNjM4N30.DlY9KiP8IixRrJ9Sm5aa7wTzczOJdvf85RE8dvhT1lo'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:09.561 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:09.561 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTM2Mzg3LCJleHAiOjE3NTE1NjUxODcsImlhdCI6MTc1MTUzNjM4N30.DlY9KiP8IixRrJ9Sm5aa7wTzczOJdvf85RE8dvhT1lo'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:09.857 | General Service|:: CompanyIndex:7 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:09.857 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTM2Mzg3LCJleHAiOjE3NTE1NjUxODcsImlhdCI6MTc1MTUzNjM4N30.DlY9KiP8IixRrJ9Sm5aa7wTzczOJdvf85RE8dvhT1lo'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:10.139 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:10.139 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTM2Mzg3LCJleHAiOjE3NTE1NjUxODcsImlhdCI6MTc1MTUzNjM4N30.DlY9KiP8IixRrJ9Sm5aa7wTzczOJdvf85RE8dvhT1lo'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:10.170 | General Service|:: CompanyIndex:7 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:10.170 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTM2Mzg3LCJleHAiOjE3NTE1NjUxODcsImlhdCI6MTc1MTUzNjM4N30.DlY9KiP8IixRrJ9Sm5aa7wTzczOJdvf85RE8dvhT1lo'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:10.186 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:10.186 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTM2Mzg3LCJleHAiOjE3NTE1NjUxODcsImlhdCI6MTc1MTUzNjM4N30.DlY9KiP8IixRrJ9Sm5aa7wTzczOJdvf85RE8dvhT1lo'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:10.264 | General Service|:: CompanyIndex:7 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:10.264 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTM2Mzg3LCJleHAiOjE3NTE1NjUxODcsImlhdCI6MTc1MTUzNjM4N30.DlY9KiP8IixRrJ9Sm5aa7wTzczOJdvf85RE8dvhT1lo'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:10.404 | General Service|:: CompanyIndex:7 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:10.404 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTM2Mzg3LCJleHAiOjE3NTE1NjUxODcsImlhdCI6MTc1MTUzNjM4N30.DlY9KiP8IixRrJ9Sm5aa7wTzczOJdvf85RE8dvhT1lo'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:10.561 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:10.561 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTM2Mzg3LCJleHAiOjE3NTE1NjUxODcsImlhdCI6MTc1MTUzNjM4N30.DlY9KiP8IixRrJ9Sm5aa7wTzczOJdvf85RE8dvhT1lo'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:10.623 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:10.623 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTM2Mzg3LCJleHAiOjE3NTE1NjUxODcsImlhdCI6MTc1MTUzNjM4N30.DlY9KiP8IixRrJ9Sm5aa7wTzczOJdvf85RE8dvhT1lo'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:10.654 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''03 Jul 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:10.654 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTM2Mzg3LCJleHAiOjE3NTE1NjUxODcsImlhdCI6MTc1MTUzNjM4N30.DlY9KiP8IixRrJ9Sm5aa7wTzczOJdvf85RE8dvhT1lo'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:10.670 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:10.670 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTM2Mzg3LCJleHAiOjE3NTE1NjUxODcsImlhdCI6MTc1MTUzNjM4N30.DlY9KiP8IixRrJ9Sm5aa7wTzczOJdvf85RE8dvhT1lo'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:10.951 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:23:10.951 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTM2Mzg3LCJleHAiOjE3NTE1NjUxODcsImlhdCI6MTc1MTUzNjM4N30.DlY9KiP8IixRrJ9Sm5aa7wTzczOJdvf85RE8dvhT1lo'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:24:10.962 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:24:10.962 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTM2Mzg3LCJleHAiOjE3NTE1NjUxODcsImlhdCI6MTc1MTUzNjM4N30.DlY9KiP8IixRrJ9Sm5aa7wTzczOJdvf85RE8dvhT1lo'''
 ,1
 ,1
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:13.467 | General Service|:: CompanyIndex:0 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTI4LDEiLCJuYmYiOjE3NTEzNjY4MzYsImV4cCI6MTc1MTM5NTYzNiwiaWF0IjoxNzUxMzY2ODM2fQ.HCwKJKQG2oJZ9jcWUb9ndsdhXyM__iMg5OXKcH1v6VI'''
 ,1
 ,1|Could not find stored procedure 'spADM_GetDataSet'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:14.642 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'ADMIN'
 ,1
 ,0
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:14.767 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'ADMIN'
 ,0
 ,'192.168.1.79'
 ,'192.168.1.79'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:25:14.954 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:25:14.970 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTM2Mzg3LCJleHAiOjE3NTE1NjUxODcsImlhdCI6MTc1MTUzNjM4N30.DlY9KiP8IixRrJ9Sm5aa7wTzczOJdvf85RE8dvhT1lo'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:19.785 | General Service|:: CompanyIndex:12 SpName: spADM_GetClientUserDetails 
 'ADMIN'
 ,1
 ,'26.0.2'
 ,0
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:19.816 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'ADMIN'
 ,12
 ,'192.168.1.79'
 ,'192.168.1.79'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:19.832 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,12
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:19.848 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:19.848 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:19.879 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''8cb6b8b5-f4bb-4d00-8c47-e3682ac59f10''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.79'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,12,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:19.879 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:19.910 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:19.910 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:22.113 | General Service|:: CompanyIndex:12 SpName: spCOM_GetDivisions 
 0
 ,1
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:22.113 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:22.128 | General Service|:: CompanyIndex:12 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:22.128 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:22.285 | General Service|:: CompanyIndex:12 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:22.285 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:22.457 | General Service|:: CompanyIndex:12 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:22.457 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:22.472 | General Service|:: CompanyIndex:12 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:22.472 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:22.488 | General Service|:: CompanyIndex:12 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:22.488 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:22.566 | General Service|:: CompanyIndex:12 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:22.566 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:22.675 | General Service|:: CompanyIndex:12 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:22.675 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:22.753 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:22.769 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:22.800 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:22.800 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:22.894 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''03 Jul 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:22.909 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:23.081 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:23.097 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:39.692 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'ADMIN'
 ,1
 ,0
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:39.739 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'ADMIN'
 ,0
 ,'192.168.1.79'
 ,'192.168.1.79'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:41.573 | General Service|:: CompanyIndex:1 SpName: spADM_GetClientUserDetails 
 'ADMIN'
 ,1
 ,'26.0.3'
 ,0
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:41.605 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'ADMIN'
 ,1
 ,'192.168.1.79'
 ,'192.168.1.79'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:41.605 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:41.636 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:41.636 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:41.636 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:41.652 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:41.652 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:41.652 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:41.683 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''62ac9e59-b6b3-4702-a001-f3c7a7a98f87''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.79'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,1,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:41.683 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:41.683 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:41.683 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:41.683 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:41.683 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:41.745 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:41.745 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:41.745 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:41.745 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:41.745 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:41.745 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:41.777 | General Service|:: CompanyIndex:1 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:41.777 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:41.777 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:41.777 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:41.777 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:41.777 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.073 | General Service|:: CompanyIndex:1 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.073 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.073 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:42.073 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:42.073 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:42.073 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.282 | General Service|:: CompanyIndex:1 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.282 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.282 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:42.282 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:42.282 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:42.282 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.329 | General Service|:: CompanyIndex:1 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.329 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.329 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:42.329 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:42.329 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:42.329 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.360 | General Service|:: CompanyIndex:1 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.360 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.360 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:42.375 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:42.375 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:42.375 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.500 | General Service|:: CompanyIndex:1 SpName: spCOM_GetFavorites 
 'GETLIST1'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.500 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.500 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:42.500 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:42.500 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:42.500 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.594 | General Service|:: CompanyIndex:1 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.610 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.610 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:42.610 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:42.610 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:42.610 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.688 | General Service|:: CompanyIndex:1 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.688 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.688 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:42.688 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:42.688 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:42.688 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.875 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.875 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.875 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:42.875 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:42.875 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:42.875 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.938 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
 message=Invalid object name 'PAY_PayrollPreferences'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.938 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:42.938 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:42.938 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:42.938 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1|Invalid object name 'PAY_PayrollPreferences'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.938 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:42.938 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:42.938 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:42.938 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:42.938 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:43.175 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''03 Jul 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:43.191 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:43.191 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:43.191 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:43.191 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:43.191 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:43.425 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:43.425 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:43.425 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:43.425 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:43.425 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:43.425 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:43.550 | General Service|:: CompanyIndex:1 SpName: spCOM_GetFavorites 
 'GETLIST1'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:43.566 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:43.566 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:43.566 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:43.566 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:43.566 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:43.597 | General Service|:: CompanyIndex:1 SpName: spCOM_GetFavorites 
 'VIEW'
 ,1
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:43.613 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:43.613 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:43.613 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:43.613 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:43.613 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:47.356 | General Service|:: CompanyIndex:1 SpName: spDOC_GetDocumentDefinition 
 40024
 ,'1'
 ,NULL
 ,''
 ,1
 ,'admin'
 ,1
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:47.372 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:47.372 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:47.372 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:47.372 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:47.372 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:47.419 | General Service|:: CompanyIndex:1 SpName: spDoc_GetCurrencyExchangeRate 
 1
 ,'03-Jul-2025'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:47.419 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:47.419 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:47.419 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:47.419 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:47.419 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:47.481 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'SELECT Code FROM COM_Location WITH(NOLOCK) WHERE NodeID=1'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:47.497 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:47.497 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:47.497 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:47.497 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:47.497 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:47.560 | General Service|:: CompanyIndex:1 SpName: spDOC_GetDueDate 
 3
 ,1
 ,0
 ,0
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:47.560 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:47.560 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:47.560 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:47.560 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:47.560 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:47.591 | General Service|:: CompanyIndex:1 SpName: spDOC_GetCurrentCodeNumber 
 40024
 ,'ARED/25/'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:47.606 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:47.606 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:47.606 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:47.606 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:47.606 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:47.966 | General Service|:: CompanyIndex:1 SpName: spDOC_GetLinkReferenceData 
 10371
 ,40024
 ,3
 ,'03/Jul/2025'
 ,3
 ,'<XML><Row CostCenterID="50061" NODEID="11" /></XML>'
 ,False
 ,'0'
 ,'0'
 ,'0'
 ,NULL
 ,'0'
 ,'0'
 ,'0'
 ,''
 ,'1'
 ,1
 ,'1'
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:47.966 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:47.966 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:47.966 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:47.966 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:47.966 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:48.044 | General Service|:: CompanyIndex:1 SpName: spADM_GetListViewDataByIDs 
 '<XML><Row CCID="2"  TypeID="10"  DBColumnID="10233"  NodeID="2" /><Row CCID="2"  TypeID="100"  DBColumnID="10233"  NodeID="2" /><Row CCID="2"  TypeID="10"  DBColumnID="10371"  NodeID="3" /><Row CCID="2"  TypeID="100"  DBColumnID="10371"  NodeID="3" /><Row CCID="50058"  TypeID="1"  DBColumnID="7140"  NodeID="1" /><Row CCID="50059"  TypeID="1"  DBColumnID="7210"  NodeID="1" /><Row CCID="50062"  TypeID="1"  DBColumnID="7420"  NodeID="1" /><Row CCID="50061"  TypeID="11"  DBColumnID="7350"  NodeID="11" /></XML>'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:48.044 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:48.044 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:48.044 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:48.044 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:48.044 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:48.091 | General Service|:: CompanyIndex:1 SpName: spADM_GetListViewDataByIDs 
 '<XML><Row CCID="2"  TypeID="10"  DBColumnID="10233"  NodeID="2" /><Row CCID="2"  TypeID="100"  DBColumnID="10233"  NodeID="2" /><Row CCID="2"  TypeID="10"  DBColumnID="10371"  NodeID="3" /><Row CCID="2"  TypeID="100"  DBColumnID="10371"  NodeID="3" /><Row CCID="50058"  TypeID="1"  DBColumnID="7140"  NodeID="1" /><Row CCID="50059"  TypeID="1"  DBColumnID="7210"  NodeID="1" /><Row CCID="50062"  TypeID="1"  DBColumnID="7420"  NodeID="1" /><Row CCID="50061"  TypeID="11"  DBColumnID="7350"  NodeID="11" /></XML>'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:48.091 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:48.091 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:48.091 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:48.091 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:48.091 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:48.122 | General Service|:: CompanyIndex:1 SpName: spDOC_GetLinkReferenceData 
 10371
 ,40024
 ,3
 ,'03/Jul/2025'
 ,3
 ,'<XML><Row CostCenterID="50058" NODEID="1" /><Row CostCenterID="50059" NODEID="1" /><Row CostCenterID="50062" NODEID="1" /><Row CostCenterID="50061" NODEID="11" /></XML>'
 ,False
 ,'0'
 ,'0'
 ,'0'
 ,NULL
 ,'0'
 ,'0'
 ,'0'
 ,''
 ,'1'
 ,1
 ,'1'
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:48.122 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:48.122 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:48.122 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:48.122 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:48.122 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:48.153 | General Service|:: CompanyIndex:1 SpName: spADM_GetListViewDataByIDs 
 '<XML><Row CCID="2"  TypeID="10"  DBColumnID="10233"  NodeID="2" /><Row CCID="2"  TypeID="100"  DBColumnID="10233"  NodeID="2" /><Row CCID="2"  TypeID="10"  DBColumnID="10371"  NodeID="3" /><Row CCID="2"  TypeID="100"  DBColumnID="10371"  NodeID="3" /><Row CCID="50058"  TypeID="1"  DBColumnID="7140"  NodeID="1" /><Row CCID="50059"  TypeID="1"  DBColumnID="7210"  NodeID="1" /><Row CCID="50062"  TypeID="1"  DBColumnID="7420"  NodeID="1" /><Row CCID="50061"  TypeID="11"  DBColumnID="7350"  NodeID="11" /></XML>'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:48.153 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:25:48.153 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:25:48.153 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:25:48.153 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:25:48.153 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:03.594 | General Service|:: CompanyIndex:1 SpName: spADM_GetCostCenterListViewData 
 278
 ,'a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:03.610 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:03.610 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:03.610 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:03.610 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:03.610 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:05.313 | General Service|:: CompanyIndex:1 SpName: spADM_GetCostCenterListViewData 
 278
 ,'a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:05.328 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:05.328 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:05.328 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:05.328 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:05.328 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.76] DEBUG | 07-03-2025 15:26:10.812 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:26:10.812 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTM2Mzg3LCJleHAiOjE3NTE1NjUxODcsImlhdCI6MTc1MTUzNjM4N30.DlY9KiP8IixRrJ9Sm5aa7wTzczOJdvf85RE8dvhT1lo'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.406 | General Service|:: CompanyIndex:1 SpName: spDOC_GetDocumentDefinition 
 40009
 ,'1'
 ,NULL
 ,''
 ,1
 ,'admin'
 ,1
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.406 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.406 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:12.406 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:12.406 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:12.406 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.437 | General Service|:: CompanyIndex:1 SpName: spDoc_GetCurrencyExchangeRate 
 1
 ,'03-Jul-2025'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.437 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.437 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:12.437 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:12.437 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:12.437 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.452 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'SELECT Code FROM COM_Location WITH(NOLOCK) WHERE NodeID=1'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.452 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.452 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:12.452 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:12.452 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:12.452 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.452 | General Service|:: CompanyIndex:1 SpName: spDOC_GetDueDate 
 483
 ,1
 ,0
 ,0
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.468 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.468 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:12.468 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:12.468 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:12.468 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.468 | General Service|:: CompanyIndex:1 SpName: spDOC_GetCurrentCodeNumber 
 40009
 ,'ARED/25/'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.468 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.468 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:12.468 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:12.468 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:12.468 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.515 | General Service|:: CompanyIndex:1 SpName: spDOC_GetLinkReferenceData 
 4233
 ,40009
 ,483
 ,'03/Jul/2025'
 ,483
 ,'<XML><Row CostCenterID="50061" NODEID="11" /></XML>'
 ,False
 ,'0'
 ,'0'
 ,'0'
 ,NULL
 ,'0'
 ,'0'
 ,'0'
 ,''
 ,'1'
 ,1
 ,'1'
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.515 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.515 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:12.515 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:12.515 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:12.515 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.546 | General Service|:: CompanyIndex:1 SpName: spADM_GetListViewDataByIDs 
 '<XML><Row CCID="2"  TypeID="10"  DBColumnID="7073"  NodeID="3" /><Row CCID="2"  TypeID="100"  DBColumnID="7073"  NodeID="3" /><Row CCID="2"  TypeID="10"  DBColumnID="4233"  NodeID="483" /><Row CCID="2"  TypeID="100"  DBColumnID="4233"  NodeID="483" /><Row CCID="50061"  TypeID="11"  DBColumnID="7335"  NodeID="11" /></XML>'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.546 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.546 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:12.546 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:12.546 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:12.546 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.562 | General Service|:: CompanyIndex:1 SpName: spADM_GetListViewDataByIDs 
 '<XML><Row CCID="2"  TypeID="10"  DBColumnID="7073"  NodeID="3" /><Row CCID="2"  TypeID="100"  DBColumnID="7073"  NodeID="3" /><Row CCID="2"  TypeID="10"  DBColumnID="4233"  NodeID="483" /><Row CCID="2"  TypeID="100"  DBColumnID="4233"  NodeID="483" /><Row CCID="50061"  TypeID="11"  DBColumnID="7335"  NodeID="11" /></XML>'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.562 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.562 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:12.562 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:12.562 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:12.562 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.578 | General Service|:: CompanyIndex:1 SpName: spDOC_GetLinkReferenceData 
 4233
 ,40009
 ,483
 ,'03/Jul/2025'
 ,483
 ,'<XML><Row CostCenterID="50061" NODEID="11" /></XML>'
 ,False
 ,'0'
 ,'0'
 ,'0'
 ,NULL
 ,'0'
 ,'0'
 ,'0'
 ,''
 ,'1'
 ,1
 ,'1'
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.578 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.578 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:12.578 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:12.578 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:12.578 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.593 | General Service|:: CompanyIndex:1 SpName: spADM_GetListViewDataByIDs 
 '<XML><Row CCID="2"  TypeID="10"  DBColumnID="7073"  NodeID="3" /><Row CCID="2"  TypeID="100"  DBColumnID="7073"  NodeID="3" /><Row CCID="2"  TypeID="10"  DBColumnID="4233"  NodeID="483" /><Row CCID="2"  TypeID="100"  DBColumnID="4233"  NodeID="483" /><Row CCID="50061"  TypeID="11"  DBColumnID="7335"  NodeID="11" /></XML>'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.593 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:12.593 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:12.593 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:12.593 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:12.593 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:23.869 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:23.869 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:28.274 | General Service|:: CompanyIndex:1 SpName: spDOC_GetDocumentDefinition 
 40003
 ,'1'
 ,NULL
 ,''
 ,1
 ,'admin'
 ,1
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:28.274 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:28.274 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:28.274 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:28.274 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:28.274 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:28.290 | General Service|:: CompanyIndex:1 SpName: spDoc_GetCurrencyExchangeRate 
 1
 ,'03-Jul-2025'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:28.306 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:28.306 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:28.306 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:28.306 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:28.306 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:28.306 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'SELECT Code FROM COM_Location WITH(NOLOCK) WHERE NodeID=1'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:28.321 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:28.321 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:28.321 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:28.321 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:28.321 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:28.321 | General Service|:: CompanyIndex:1 SpName: spDOC_GetCurrentCodeNumber 
 40003
 ,'ARED/25/'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:28.337 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:28.337 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:28.337 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:28.337 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:28.337 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:28.353 | General Service|:: CompanyIndex:1 SpName: spADM_GetListViewDataByIDs 
 '<XML><Row CCID="50002"  TypeID="1"  DBColumnID="4514"  NodeID="1" /></XML>'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:28.368 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:28.368 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:28.368 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:28.368 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:28.368 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:28.384 | General Service|:: CompanyIndex:1 SpName: spADM_GetListViewDataByIDs 
 '<XML><Row CCID="50002"  TypeID="1"  DBColumnID="4514"  NodeID="1" /></XML>'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:28.384 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:28.384 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:28.384 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:28.384 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:28.384 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:28.415 | General Service|:: CompanyIndex:1 SpName: spADM_GetListViewDataByIDs 
 '<XML><Row CCID="50002"  TypeID="1"  DBColumnID="4514"  NodeID="1" /></XML>'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:28.415 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:28.415 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:28.415 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:28.415 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:28.415 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:32.336 | General Service|:: CompanyIndex:1 SpName: spADM_GetCostCenterListViewData 
 35
 ,'a.ProductName,a.ProductCode'
 ,''
 ,''
 ,'ProductName'
 ,''
 ,8
 ,False
 ,'1'
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,' dcCCNID2=1 and '
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:32.336 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:32.336 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:32.336 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:32.336 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:32.336 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:34.321 | General Service|:: CompanyIndex:1 SpName: spDOC_GetProductTypeDetails 
 '42910'
 ,''
 ,0
 ,'<XML><Row CostCenterID="50002" NODEID="1" /><Row CostCenterID="12" NODEID="1" /></XML>'
 ,40003
 ,'03/Jul/2025'
 ,0
 ,1
 ,False
 ,'0'
 ,'1'
 ,'1'
 ,1
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,''
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:34.321 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:34.321 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:34.321 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:34.321 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:34.321 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:34.353 | General Service|:: CompanyIndex:1 SpName: spADM_GetCostCenterListViewData 
 35
 ,'a.ProductName,a.ProductCode'
 ,''
 ,''
 ,'ProductName'
 ,''
 ,8
 ,False
 ,'1'
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,' dcCCNID2=1 and '
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:34.353 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:34.353 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:34.353 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:34.353 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:34.353 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:35.993 | General Service|:: CompanyIndex:1 SpName: spDOC_GetProductTypeDetails 
 '42904'
 ,''
 ,0
 ,'<XML><Row CostCenterID="50002" NODEID="1" /><Row CostCenterID="12" NODEID="1" /></XML>'
 ,40003
 ,'03/Jul/2025'
 ,0
 ,1
 ,False
 ,'0'
 ,'1'
 ,'1'
 ,1
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,''
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:36.009 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:36.009 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:36.009 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:36.009 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:36.009 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:36.024 | General Service|:: CompanyIndex:1 SpName: spADM_GetCostCenterListViewData 
 35
 ,'a.ProductName,a.ProductCode'
 ,''
 ,''
 ,'ProductName'
 ,''
 ,8
 ,False
 ,'1'
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,' dcCCNID2=1 and '
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:36.024 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:36.024 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:36.024 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:36.040 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:36.040 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:38.168 | General Service|:: CompanyIndex:1 SpName: spDOC_GetProductTypeDetails 
 '42918'
 ,''
 ,0
 ,'<XML><Row CostCenterID="50002" NODEID="1" /><Row CostCenterID="12" NODEID="1" /></XML>'
 ,40003
 ,'03/Jul/2025'
 ,0
 ,1
 ,False
 ,'0'
 ,'1'
 ,'1'
 ,1
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,''
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:38.183 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:38.183 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:38.183 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:38.183 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:38.183 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:40.246 | General Service|:: CompanyIndex:1 SpName: spCom_GetCostCenterQuickViewDefn 
 3
 ,'42918'
 ,40003
 ,1
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:40.246 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:40.246 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:40.246 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:40.246 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:40.246 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:43.261 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:43.261 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:43.261 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:43.261 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:43.261 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:43.261 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:58.890 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 6
 ,'62ac9e59-b6b3-4702-a001-f3c7a7a98f87'
 ,''
 ,''
 ,''
 ,''
 ,0
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:58.890 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:58.890 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:58.890 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:58.890 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:58.890 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:58.906 | General Service|:: CompanyIndex:1 SpName: sp_SetTokenHistoryParameters :
 0
 ,'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'
 ,''
 ,NULL
 ,1
 ,1|Could not find stored procedure 'sp_SetTokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:58.906 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:26:58.906 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 07-03-2025 15:26:58.906 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 07-03-2025 15:26:58.921 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 07-03-2025 15:26:58.921 | General Service|:: CompanyIndex:1 SpName: spADM_GetDataSetParameters :
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMSwxIiwibmJmIjoxNzUxNTM2NTQxLCJleHAiOjE3NTE1NjUzNDEsImlhdCI6MTc1MTUzNjU0MX0.a1PWlmNRaPu6a-Hiu1v-h-ZeRHTZs_at2VxOKuFY2IM'''
 ,1
 ,1|Invalid object name 'COM_TokenHistory'.
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:00.515 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'ADMIN'
 ,1
 ,0
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:00.562 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'ADMIN'
 ,0
 ,'192.168.1.79'
 ,'192.168.1.79'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:07.091 | General Service|:: CompanyIndex:7 SpName: spADM_GetClientUserDetails 
 'ADMIN'
 ,1
 ,'26.0.3'
 ,0
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:07.154 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'ADMIN'
 ,7
 ,'192.168.1.79'
 ,'192.168.1.79'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:07.170 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,7
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:07.170 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:07.170 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:07.217 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''37fe2f45-02fb-4d91-8b81-af4f198f290a''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.79'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,7,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:07.217 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:07.232 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:07.232 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:07.997 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:07.997 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:08.294 | General Service|:: CompanyIndex:7 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:08.294 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:08.560 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:08.560 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:08.575 | General Service|:: CompanyIndex:7 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:08.575 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:08.591 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:08.591 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:08.622 | General Service|:: CompanyIndex:7 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:08.622 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:08.732 | General Service|:: CompanyIndex:7 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:08.732 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:08.857 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:08.857 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:08.904 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:08.904 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:08.919 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''03 Jul 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:08.935 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:08.950 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:08.950 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:09.091 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:09.107 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:09.450 | General Service|:: CompanyIndex:7 SpName: spADM_GetDashBoard 
 1
 ,39
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:09.450 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:09.544 | General Service|:: CompanyIndex:7 SpName: spCOM_GetFavorites 
 'VIEW'
 ,25495
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:09.560 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:27:11.012 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 07-03-2025 15:27:11.012 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTM2Mzg3LCJleHAiOjE3NTE1NjUxODcsImlhdCI6MTc1MTUzNjM4N30.DlY9KiP8IixRrJ9Sm5aa7wTzczOJdvf85RE8dvhT1lo'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:11.856 | General Service|:: CompanyIndex:7 SpName: spDOC_GetDocumentDefinition 
 40025
 ,NULL
 ,NULL
 ,''
 ,1
 ,'admin'
 ,1
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:11.856 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:11.918 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterListViewData 
 268
 ,'a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:11.918 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:11.934 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterListViewData 
 268
 ,'a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:11.934 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:12.090 | General Service|:: CompanyIndex:7 SpName: spDOC_GetLinkReferenceData 
 10376
 ,40025
 ,3
 ,'03/Jul/2025'
 ,3
 ,'<XML><Row CostCenterID="50058" NODEID="1" /><Row CostCenterID="50059" NODEID="1" /><Row CostCenterID="50061" NODEID="1" /><Row CostCenterID="50062" NODEID="1" /></XML>'
 ,False
 ,'0'
 ,'0'
 ,'0'
 ,NULL
 ,'0'
 ,'0'
 ,'0'
 ,''
 ,'1'
 ,1
 ,'1'
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:12.106 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:12.137 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterListViewData 
 268
 ,'a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:12.137 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:13.059 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterListViewData 
 500087
 ,'a.Name, CC1.Name as CC1Name , CC2.Name as CC2Name , CC3.Name as CC3Name '
 ,''
 ,' LEFT JOIN COM_CC50009 CC1  WITH(NOLOCK)  on  CC1.NodeID=CC.CCNID9  LEFT JOIN COM_CC50010 CC2  WITH(NOLOCK)  on  CC2.NodeID=CC.CCNID10  LEFT JOIN COM_CC50011 CC3  WITH(NOLOCK)  on  CC3.NodeID=CC.CCNID11 '
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:13.059 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:13.200 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterListViewData 
 285
 ,'a.Code,a.ccAlpha10, CC2.Name as CC2Name , CC3.Name as CC3Name , CC4.Name as CC4Name '
 ,''
 ,' LEFT JOIN COM_CC50009 CC2  WITH(NOLOCK)  on  CC2.NodeID=CC.CCNID9  LEFT JOIN COM_CC50010 CC3  WITH(NOLOCK)  on  CC3.NodeID=CC.CCNID10  LEFT JOIN COM_CC50011 CC4  WITH(NOLOCK)  on  CC4.NodeID=CC.CCNID11 '
 ,'Code'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:13.200 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:13.231 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterListViewData 
 275
 ,'a.Name,a.Code, SCC2.ResourceData as StatusID'
 ,''
 ,' LEFT JOIN COM_Status CC2 with(nolock) ON CC2.StatusID=a.StatusID LEFT JOIN COM_LanguageResources SCC2 with(nolock) ON SCC2.ResourceID=CC2.ResourceID AND SCC2.LanguageID=1'
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:13.231 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:13.356 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterListViewData 
 276
 ,'a.Name,a.Code, CC2.Name as CC2Name '
 ,''
 ,' LEFT JOIN COM_CC50070 CC2  WITH(NOLOCK)  on  CC2.NodeID=CC.CCNID70 '
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:13.356 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:13.403 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterListViewData 
 277
 ,'a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:13.403 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:13.434 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterListViewData 
 500069
 ,'a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:13.434 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:13.465 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterListViewData 
 500072
 ,'a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:13.481 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:13.575 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterListViewData 
 500075
 ,'a.Name,a.Code'
 ,''
 ,''
 ,'Name'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:13.575 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:13.699 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterListViewData 
 35
 ,'a.ProductName,a.ProductCode'
 ,' (SELECT round(isnull(sum(UOMConvertedQty*case when vouchertype=1 and statusid in(371,441) then 0 else  VoucherType end),0),2) FROM INV_DocDetails i  WITH(NOLOCK)    join COM_DocCCData d  WITH(NOLOCK) on i.InvDocDetailsID=d.InvDocDetailsID  	WHERE ProductID= a.ProductID  AND IsQtyIgnored=0 and i.StatusID in(371,441,369) AND  (VoucherType=1 OR VoucherType=-1)  and convert(datetime,DocDate)<=''03/Jul/2025'')  as [QOH]'
 ,''
 ,'ProductName'
 ,''
 ,8
 ,False
 ,''
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:13.731 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:16.527 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT Code FROM COM_Location WITH(NOLOCK) WHERE NodeID=7'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:16.527 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:16.558 | General Service|:: CompanyIndex:7 SpName: spDOC_GetDocumentPrefix 
 40025
 ,7
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:16.574 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:16.605 | General Service|:: CompanyIndex:7 SpName: spDOC_GetCurrentCodeNumber 
 40025
 ,'L01-25/'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:16.605 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:16.668 | General Service|:: CompanyIndex:7 SpName: spDOC_GetDueDate 
 3
 ,7
 ,0
 ,0
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:16.683 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:16.683 | General Service|:: CompanyIndex:7 SpName: spDOC_GetCurrentCodeNumber 
 40025
 ,'L01-25/'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:16.699 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:16.730 | General Service|:: CompanyIndex:7 SpName: spDOC_GetLinkReferenceData 
 10376
 ,40025
 ,3
 ,'03/Jul/2025'
 ,3
 ,'<XML><Row CostCenterID="50058" NODEID="1" /><Row CostCenterID="50059" NODEID="1" /><Row CostCenterID="50061" NODEID="1" /><Row CostCenterID="50062" NODEID="1" /><Row CostCenterID="50002" NODEID="7" /></XML>'
 ,False
 ,'0'
 ,'0'
 ,'0'
 ,NULL
 ,'0'
 ,'0'
 ,'0'
 ,''
 ,'1'
 ,1
 ,'1'
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:16.730 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:16.761 | General Service|:: CompanyIndex:7 SpName: spADM_GetListViewDataByIDs 
 '<XML><Row CCID="2"  TypeID="10"  DBColumnID="10376"  NodeID="3" /><Row CCID="2"  TypeID="100"  DBColumnID="10376"  NodeID="3" /><Row CCID="2"  TypeID="10"  DBColumnID="10514"  NodeID="2" /><Row CCID="2"  TypeID="100"  DBColumnID="10514"  NodeID="2" /><Row CCID="50058"  TypeID="1"  DBColumnID="7141"  NodeID="1" /><Row CCID="50059"  TypeID="1"  DBColumnID="7211"  NodeID="1" /><Row CCID="50061"  TypeID="10"  DBColumnID="7351"  NodeID="1" /><Row CCID="50062"  TypeID="1"  DBColumnID="7421"  NodeID="1" /><Row CCID="50002"  TypeID="1"  DBColumnID="10464"  NodeID="7" /><Row CCID="50058"  TypeID="1"  DBColumnID="583685"  NodeID="1" /></XML>'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:16.761 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:16.792 | General Service|:: CompanyIndex:7 SpName: spADM_GetListViewDataByIDs 
 '<XML><Row CCID="2"  TypeID="10"  DBColumnID="10376"  NodeID="3" /><Row CCID="2"  TypeID="100"  DBColumnID="10376"  NodeID="3" /><Row CCID="2"  TypeID="10"  DBColumnID="10514"  NodeID="2" /><Row CCID="2"  TypeID="100"  DBColumnID="10514"  NodeID="2" /><Row CCID="50058"  TypeID="1"  DBColumnID="7141"  NodeID="1" /><Row CCID="50059"  TypeID="1"  DBColumnID="7211"  NodeID="1" /><Row CCID="50061"  TypeID="10"  DBColumnID="7351"  NodeID="1" /><Row CCID="50062"  TypeID="1"  DBColumnID="7421"  NodeID="1" /><Row CCID="50002"  TypeID="1"  DBColumnID="10464"  NodeID="7" /><Row CCID="50058"  TypeID="1"  DBColumnID="583685"  NodeID="1" /></XML>'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:16.792 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:18.589 | General Service|:: CompanyIndex:7 SpName: spDOC_GetLinkReferenceData 
 10464
 ,40025
 ,7
 ,'03/Jul/2025'
 ,3
 ,'<XML><Row CostCenterID="50058" NODEID="1" /><Row CostCenterID="50059" NODEID="1" /><Row CostCenterID="50061" NODEID="1" /><Row CostCenterID="50062" NODEID="1" /><Row CostCenterID="50002" NODEID="7" /></XML>'
 ,False
 ,'0'
 ,'0'
 ,'0'
 ,NULL
 ,'0'
 ,'0'
 ,'0'
 ,''
 ,'1'
 ,1
 ,'1'
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:18.604 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:22.057 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterListViewData 
 35
 ,'a.ProductName,a.ProductCode'
 ,' (SELECT round(isnull(sum(UOMConvertedQty*case when vouchertype=1 and statusid in(371,441) then 0 else  VoucherType end),0),2) FROM INV_DocDetails i  WITH(NOLOCK)    join COM_DocCCData d  WITH(NOLOCK) on i.InvDocDetailsID=d.InvDocDetailsID  	WHERE ProductID= a.ProductID  AND IsQtyIgnored=0 and i.StatusID in(371,441,369) AND  (VoucherType=1 OR VoucherType=-1)  and convert(datetime,DocDate)<=''03/Jul/2025'')  as [QOH]'
 ,''
 ,'ProductName'
 ,''
 ,8
 ,False
 ,'1'
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:22.057 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:23.775 | General Service|:: CompanyIndex:7 SpName: spDOC_GetProductTypeDetails 
 '11947'
 ,''
 ,0
 ,'<XML><Row CostCenterID="50058" NODEID="1" /><Row CostCenterID="50059" NODEID="1" /><Row CostCenterID="50061" NODEID="1" /><Row CostCenterID="50062" NODEID="1" /><Row CostCenterID="50002" NODEID="7" /><Row CostCenterID="12" NODEID="1" /><Row CostCenterID="2" NODEID="3" /></XML>'
 ,40025
 ,'03/Jul/2025'
 ,3
 ,1
 ,True
 ,'0'
 ,'1'
 ,'1'
 ,1
 ,False
 ,False
 ,False
 ,False
 ,True
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,''
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:23.775 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:23.806 | General Service|:: CompanyIndex:7 SpName: spDOC_GetLinkReferenceData 
 25014
 ,40025
 ,11947
 ,'03/Jul/2025'
 ,3
 ,'<XML><Row CostCenterID="50058" NODEID="1" /><Row CostCenterID="50059" NODEID="1" /><Row CostCenterID="50061" NODEID="1" /><Row CostCenterID="50062" NODEID="1" /><Row CostCenterID="50002" NODEID="7" /></XML>'
 ,False
 ,'0'
 ,'0'
 ,'0'
 ,NULL
 ,'0'
 ,'0'
 ,'0'
 ,''
 ,'1'
 ,1
 ,'1'
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:23.806 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:23.822 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:23.822 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:23.853 | General Service|:: CompanyIndex:7 SpName: spDOC_GetLinkReferenceData 
 10379
 ,40025
 ,11947
 ,'03/Jul/2025'
 ,3
 ,'<XML><Row CostCenterID="50058" NODEID="1" /><Row CostCenterID="50059" NODEID="1" /><Row CostCenterID="50061" NODEID="1" /><Row CostCenterID="50062" NODEID="1" /><Row CostCenterID="50002" NODEID="7" /><Row CostCenterID="50060" NODEID="3" /><Row CostCenterID="50071" NODEID="1" /></XML>'
 ,False
 ,'0'
 ,'0'
 ,'0'
 ,NULL
 ,'0'
 ,'0'
 ,'0'
 ,''
 ,'1'
 ,1
 ,'1'
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:23.853 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:23.947 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterListViewData 
 35
 ,'a.ProductName,a.ProductCode'
 ,' (SELECT round(isnull(sum(UOMConvertedQty*case when vouchertype=1 and statusid in(371,441) then 0 else  VoucherType end),0),2) FROM INV_DocDetails i  WITH(NOLOCK)    join COM_DocCCData d  WITH(NOLOCK) on i.InvDocDetailsID=d.InvDocDetailsID  	WHERE ProductID= a.ProductID  AND IsQtyIgnored=0 and i.StatusID in(371,441,369) AND  (VoucherType=1 OR VoucherType=-1)  and convert(datetime,DocDate)<=''03/Jul/2025'')  as [QOH]'
 ,''
 ,'ProductName'
 ,''
 ,8
 ,False
 ,'1'
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:23.947 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:25.525 | General Service|:: CompanyIndex:7 SpName: spDOC_GetProductTypeDetails 
 '11947'
 ,''
 ,0
 ,'<XML><Row CostCenterID="50058" NODEID="1" /><Row CostCenterID="50059" NODEID="1" /><Row CostCenterID="50061" NODEID="1" /><Row CostCenterID="50062" NODEID="1" /><Row CostCenterID="50002" NODEID="7" /><Row CostCenterID="12" NODEID="1" /><Row CostCenterID="2" NODEID="3" /></XML>'
 ,40025
 ,'03/Jul/2025'
 ,3
 ,1
 ,True
 ,'0'
 ,'1'
 ,'1'
 ,1
 ,False
 ,False
 ,False
 ,False
 ,True
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,''
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:25.525 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:25.540 | General Service|:: CompanyIndex:7 SpName: spDOC_GetLinkReferenceData 
 25014
 ,40025
 ,11947
 ,'03/Jul/2025'
 ,3
 ,'<XML><Row CostCenterID="50058" NODEID="1" /><Row CostCenterID="50059" NODEID="1" /><Row CostCenterID="50061" NODEID="1" /><Row CostCenterID="50062" NODEID="1" /><Row CostCenterID="50002" NODEID="7" /></XML>'
 ,False
 ,'0'
 ,'0'
 ,'0'
 ,NULL
 ,'0'
 ,'0'
 ,'0'
 ,''
 ,'1'
 ,1
 ,'1'
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:25.540 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:25.572 | General Service|:: CompanyIndex:7 SpName: spDOC_GetLinkReferenceData 
 10379
 ,40025
 ,11947
 ,'03/Jul/2025'
 ,3
 ,'<XML><Row CostCenterID="50058" NODEID="1" /><Row CostCenterID="50059" NODEID="1" /><Row CostCenterID="50061" NODEID="1" /><Row CostCenterID="50062" NODEID="1" /><Row CostCenterID="50002" NODEID="7" /><Row CostCenterID="50060" NODEID="3" /><Row CostCenterID="50071" NODEID="1" /></XML>'
 ,False
 ,'0'
 ,'0'
 ,'0'
 ,NULL
 ,'0'
 ,'0'
 ,'0'
 ,''
 ,'1'
 ,1
 ,'1'
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:25.572 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:25.665 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterListViewData 
 35
 ,'a.ProductName,a.ProductCode'
 ,' (SELECT round(isnull(sum(UOMConvertedQty*case when vouchertype=1 and statusid in(371,441) then 0 else  VoucherType end),0),2) FROM INV_DocDetails i  WITH(NOLOCK)    join COM_DocCCData d  WITH(NOLOCK) on i.InvDocDetailsID=d.InvDocDetailsID  	WHERE ProductID= a.ProductID  AND IsQtyIgnored=0 and i.StatusID in(371,441,369) AND  (VoucherType=1 OR VoucherType=-1)  and convert(datetime,DocDate)<=''03/Jul/2025'')  as [QOH]'
 ,''
 ,'ProductName'
 ,''
 ,8
 ,False
 ,'1'
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:25.665 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:28.040 | General Service|:: CompanyIndex:7 SpName: spDOC_GetProductTypeDetails 
 '11947'
 ,''
 ,0
 ,'<XML><Row CostCenterID="50058" NODEID="1" /><Row CostCenterID="50059" NODEID="1" /><Row CostCenterID="50061" NODEID="1" /><Row CostCenterID="50062" NODEID="1" /><Row CostCenterID="50002" NODEID="7" /><Row CostCenterID="12" NODEID="1" /><Row CostCenterID="2" NODEID="3" /></XML>'
 ,40025
 ,'03/Jul/2025'
 ,3
 ,1
 ,True
 ,'0'
 ,'1'
 ,'1'
 ,1
 ,False
 ,False
 ,False
 ,False
 ,True
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,''
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:28.055 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:28.071 | General Service|:: CompanyIndex:7 SpName: spDOC_GetLinkReferenceData 
 25014
 ,40025
 ,11947
 ,'03/Jul/2025'
 ,3
 ,'<XML><Row CostCenterID="50058" NODEID="1" /><Row CostCenterID="50059" NODEID="1" /><Row CostCenterID="50061" NODEID="1" /><Row CostCenterID="50062" NODEID="1" /><Row CostCenterID="50002" NODEID="7" /></XML>'
 ,False
 ,'0'
 ,'0'
 ,'0'
 ,NULL
 ,'0'
 ,'0'
 ,'0'
 ,''
 ,'1'
 ,1
 ,'1'
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:28.071 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:28.087 | General Service|:: CompanyIndex:7 SpName: spDOC_GetLinkReferenceData 
 10379
 ,40025
 ,11947
 ,'03/Jul/2025'
 ,3
 ,'<XML><Row CostCenterID="50058" NODEID="1" /><Row CostCenterID="50059" NODEID="1" /><Row CostCenterID="50061" NODEID="1" /><Row CostCenterID="50062" NODEID="1" /><Row CostCenterID="50002" NODEID="7" /><Row CostCenterID="50060" NODEID="3" /><Row CostCenterID="50071" NODEID="1" /></XML>'
 ,False
 ,'0'
 ,'0'
 ,'0'
 ,NULL
 ,'0'
 ,'0'
 ,'0'
 ,''
 ,'1'
 ,1
 ,'1'
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:28.102 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:29.743 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterListViewData 
 35
 ,'a.ProductName,a.ProductCode'
 ,' (SELECT round(isnull(sum(UOMConvertedQty*case when vouchertype=1 and statusid in(371,441) then 0 else  VoucherType end),0),2) FROM INV_DocDetails i  WITH(NOLOCK)    join COM_DocCCData d  WITH(NOLOCK) on i.InvDocDetailsID=d.InvDocDetailsID  	WHERE ProductID= a.ProductID  AND IsQtyIgnored=0 and i.StatusID in(371,441,369) AND  (VoucherType=1 OR VoucherType=-1)  and convert(datetime,DocDate)<=''03/Jul/2025'')  as [QOH]'
 ,''
 ,'ProductName'
 ,''
 ,8
 ,False
 ,'1'
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:29.743 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:32.320 | General Service|:: CompanyIndex:7 SpName: spDOC_GetProductTypeDetails 
 '11627'
 ,''
 ,0
 ,'<XML><Row CostCenterID="50058" NODEID="1" /><Row CostCenterID="50059" NODEID="1" /><Row CostCenterID="50061" NODEID="1" /><Row CostCenterID="50062" NODEID="1" /><Row CostCenterID="50002" NODEID="7" /><Row CostCenterID="12" NODEID="1" /><Row CostCenterID="2" NODEID="3" /></XML>'
 ,40025
 ,'03/Jul/2025'
 ,3
 ,1
 ,True
 ,'0'
 ,'1'
 ,'1'
 ,1
 ,False
 ,False
 ,False
 ,False
 ,True
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,''
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:32.320 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:32.336 | General Service|:: CompanyIndex:7 SpName: spDOC_GetLinkReferenceData 
 25014
 ,40025
 ,11627
 ,'03/Jul/2025'
 ,3
 ,'<XML><Row CostCenterID="50058" NODEID="1" /><Row CostCenterID="50059" NODEID="1" /><Row CostCenterID="50061" NODEID="1" /><Row CostCenterID="50062" NODEID="1" /><Row CostCenterID="50002" NODEID="7" /></XML>'
 ,False
 ,'0'
 ,'0'
 ,'0'
 ,NULL
 ,'0'
 ,'0'
 ,'0'
 ,''
 ,'1'
 ,1
 ,'1'
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:32.336 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:32.367 | General Service|:: CompanyIndex:7 SpName: spDOC_GetLinkReferenceData 
 10379
 ,40025
 ,11627
 ,'03/Jul/2025'
 ,3
 ,'<XML><Row CostCenterID="50058" NODEID="1" /><Row CostCenterID="50059" NODEID="1" /><Row CostCenterID="50061" NODEID="1" /><Row CostCenterID="50062" NODEID="1" /><Row CostCenterID="50002" NODEID="7" /><Row CostCenterID="50060" NODEID="3" /><Row CostCenterID="50071" NODEID="1" /></XML>'
 ,False
 ,'0'
 ,'0'
 ,'0'
 ,NULL
 ,'0'
 ,'0'
 ,'0'
 ,''
 ,'1'
 ,1
 ,'1'
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:32.382 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:32.445 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterListViewData 
 35
 ,'a.ProductName,a.ProductCode'
 ,' (SELECT round(isnull(sum(UOMConvertedQty*case when vouchertype=1 and statusid in(371,441) then 0 else  VoucherType end),0),2) FROM INV_DocDetails i  WITH(NOLOCK)    join COM_DocCCData d  WITH(NOLOCK) on i.InvDocDetailsID=d.InvDocDetailsID  	WHERE ProductID= a.ProductID  AND IsQtyIgnored=0 and i.StatusID in(371,441,369) AND  (VoucherType=1 OR VoucherType=-1)  and convert(datetime,DocDate)<=''03/Jul/2025'')  as [QOH]'
 ,''
 ,'ProductName'
 ,''
 ,8
 ,False
 ,'1'
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:32.461 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:34.132 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterListViewData 
 35
 ,'a.ProductName,a.ProductCode'
 ,' (SELECT round(isnull(sum(UOMConvertedQty*case when vouchertype=1 and statusid in(371,441) then 0 else  VoucherType end),0),2) FROM INV_DocDetails i  WITH(NOLOCK)    join COM_DocCCData d  WITH(NOLOCK) on i.InvDocDetailsID=d.InvDocDetailsID  	WHERE ProductID= a.ProductID  AND IsQtyIgnored=0 and i.StatusID in(371,441,369) AND  (VoucherType=1 OR VoucherType=-1)  and convert(datetime,DocDate)<=''03/Jul/2025'')  as [QOH]'
 ,''
 ,'ProductName'
 ,''
 ,8
 ,False
 ,'1'
 ,''
 ,''
 ,''
 ,''
 ,0
 ,False
 ,''
 ,''
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:34.148 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:36.819 | General Service|:: CompanyIndex:7 SpName: spDOC_GetProductTypeDetails 
 '11948'
 ,''
 ,0
 ,'<XML><Row CostCenterID="50058" NODEID="1" /><Row CostCenterID="50059" NODEID="1" /><Row CostCenterID="50061" NODEID="1" /><Row CostCenterID="50062" NODEID="1" /><Row CostCenterID="50002" NODEID="7" /><Row CostCenterID="12" NODEID="1" /><Row CostCenterID="2" NODEID="3" /></XML>'
 ,40025
 ,'03/Jul/2025'
 ,3
 ,1
 ,True
 ,'0'
 ,'1'
 ,'1'
 ,1
 ,False
 ,False
 ,False
 ,False
 ,True
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,''
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:36.819 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:36.835 | General Service|:: CompanyIndex:7 SpName: spDOC_GetLinkReferenceData 
 25014
 ,40025
 ,11948
 ,'03/Jul/2025'
 ,3
 ,'<XML><Row CostCenterID="50058" NODEID="1" /><Row CostCenterID="50059" NODEID="1" /><Row CostCenterID="50061" NODEID="1" /><Row CostCenterID="50062" NODEID="1" /><Row CostCenterID="50002" NODEID="7" /></XML>'
 ,False
 ,'0'
 ,'0'
 ,'0'
 ,NULL
 ,'0'
 ,'0'
 ,'0'
 ,''
 ,'1'
 ,1
 ,'1'
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:36.850 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:36.866 | General Service|:: CompanyIndex:7 SpName: spDOC_GetLinkReferenceData 
 10379
 ,40025
 ,11948
 ,'03/Jul/2025'
 ,3
 ,'<XML><Row CostCenterID="50058" NODEID="1" /><Row CostCenterID="50059" NODEID="1" /><Row CostCenterID="50061" NODEID="1" /><Row CostCenterID="50062" NODEID="1" /><Row CostCenterID="50002" NODEID="7" /><Row CostCenterID="50060" NODEID="3" /><Row CostCenterID="50071" NODEID="1" /></XML>'
 ,False
 ,'0'
 ,'0'
 ,'0'
 ,NULL
 ,'0'
 ,'0'
 ,'0'
 ,''
 ,'1'
 ,1
 ,'1'
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:36.866 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:38.897 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterQuickViewDefn 
 3
 ,'11627'
 ,40025
 ,1
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:27:38.897 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:28:03.483 | General Service|:: CompanyIndex:7 SpName: spDOC_GetProductTypeDetails 
 '11948'
 ,''
 ,1
 ,'<XML><Row CostCenterID="50058" NODEID="1" /><Row CostCenterID="50059" NODEID="1" /><Row CostCenterID="50061" NODEID="1" /><Row CostCenterID="50062" NODEID="1" /><Row CostCenterID="50002" NODEID="7" /><Row CostCenterID="50060" NODEID="3" /><Row CostCenterID="50071" NODEID="1" /><Row CostCenterID="50047" NODEID="10" /><Row CostCenterID="50048" NODEID="29" /><Row CostCenterID="12" NODEID="1" /><Row CostCenterID="2" NODEID="3" /></XML>'
 ,40025
 ,'03/Jul/2025'
 ,3
 ,1
 ,True
 ,'0'
 ,'1'
 ,'1'
 ,1
 ,False
 ,False
 ,False
 ,False
 ,True
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,''
[System: 192.168.1.79] DEBUG | 07-03-2025 15:28:03.483 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:28:09.245 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:28:09.245 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:28:12.185 | General Service|:: CompanyIndex:7 SpName: spDOC_GetProductTypeDetails 
 '11948'
 ,''
 ,1
 ,'<XML><Row CostCenterID="50058" NODEID="1" /><Row CostCenterID="50059" NODEID="1" /><Row CostCenterID="50061" NODEID="1" /><Row CostCenterID="50062" NODEID="1" /><Row CostCenterID="50002" NODEID="7" /><Row CostCenterID="50060" NODEID="3" /><Row CostCenterID="50071" NODEID="1" /><Row CostCenterID="50047" NODEID="10" /><Row CostCenterID="50048" NODEID="29" /><Row CostCenterID="12" NODEID="1" /><Row CostCenterID="2" NODEID="3" /></XML>'
 ,40025
 ,'03/Jul/2025'
 ,3
 ,5
 ,True
 ,'0'
 ,'1'
 ,'1'
 ,1
 ,False
 ,False
 ,False
 ,False
 ,True
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,''
[System: 192.168.1.79] DEBUG | 07-03-2025 15:28:12.185 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:28:23.971 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:28:23.971 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:28:30.797 | General Service|:: CompanyIndex:7 SpName: spDOC_GetProductTypeDetails 
 '11948'
 ,''
 ,1
 ,'<XML><Row CostCenterID="50058" NODEID="1" /><Row CostCenterID="50059" NODEID="1" /><Row CostCenterID="50061" NODEID="1" /><Row CostCenterID="50062" NODEID="1" /><Row CostCenterID="50002" NODEID="7" /><Row CostCenterID="50060" NODEID="3" /><Row CostCenterID="50071" NODEID="1" /><Row CostCenterID="50047" NODEID="10" /><Row CostCenterID="50048" NODEID="29" /><Row CostCenterID="12" NODEID="1" /><Row CostCenterID="2" NODEID="3" /></XML>'
 ,40025
 ,'03/Jul/2025'
 ,3
 ,10
 ,True
 ,0
 ,'1'
 ,'1'
 ,1
 ,False
 ,False
 ,False
 ,False
 ,True
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,False
 ,''
[System: 192.168.1.79] DEBUG | 07-03-2025 15:28:30.797 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:29:09.132 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:29:09.132 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:29:23.816 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:29:23.832 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:30:09.087 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:30:09.087 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:30:22.816 | General Service|:: CompanyIndex:12 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.79] DEBUG | 07-03-2025 15:30:22.816 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:30:23.816 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:30:23.832 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:31:09.071 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:31:09.086 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:31:24.804 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:31:24.804 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:32:08.024 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.79] DEBUG | 07-03-2025 15:32:08.024 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:32:09.149 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:32:09.149 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:32:25.818 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:32:25.833 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:33:09.120 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:33:09.120 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:33:26.805 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:33:26.820 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:34:09.085 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:34:09.101 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:34:27.820 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:34:27.820 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:35:09.488 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:35:09.879 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:35:23.457 | General Service|:: CompanyIndex:12 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.79] DEBUG | 07-03-2025 15:35:24.160 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:35:30.242 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:35:30.257 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 15:36:04.255 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''62e16687-a9c4-48f3-a1c6-9d5e8d9a2c30''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 15:36:04.255 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTIyNzYzLCJleHAiOjE3NTE1NTE1NjMsImlhdCI6MTc1MTUyMjc2M30.hQKsiAIL-TVZwRMhFg7ZoeOYwQfblInm6Ttugh3dgIk'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:36:09.082 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:36:09.097 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:36:29.825 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:36:29.840 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:37:07.993 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.79] DEBUG | 07-03-2025 15:37:08.009 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:37:09.087 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:37:09.087 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:37:30.823 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:37:30.823 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:38:09.080 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:38:09.080 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:38:31.815 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:38:31.815 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:39:09.089 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:39:09.089 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 07-03-2025 15:39:20.252 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 07-03-2025 15:39:20.330 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:39:32.828 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:39:32.828 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:40:09.071 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:40:09.071 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:40:20.805 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''8cb6b8b5-f4bb-4d00-8c47-e3682ac59f10''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.79] DEBUG | 07-03-2025 15:40:20.821 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:40:22.790 | General Service|:: CompanyIndex:12 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.79] DEBUG | 07-03-2025 15:40:22.790 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:40:33.818 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:40:33.818 | General Service|:: CompanyIndex:12 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsMTIsMSIsIm5iZiI6MTc1MTUzNjUxOSwiZXhwIjoxNzUxNTY1MzE5LCJpYXQiOjE3NTE1MzY1MTl9.BNDHywx3UHcTyRGO67BGMNtCBdATAvK6AxX1uurarSg'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:41:09.087 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 07-03-2025 15:41:09.087 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFETUlOLDEsNywxIiwibmJmIjoxNzUxNTM2NjI3LCJleHAiOjE3NTE1NjU0MjcsImlhdCI6MTc1MTUzNjYyN30.cZVXuWEVHHfXbsRsbJ2bPajwjlb3UtkUjVRAugf5g4k'''
 ,1
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 15:51:04.215 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''62e16687-a9c4-48f3-a1c6-9d5e8d9a2c30''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 15:51:04.230 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTIyNzYzLCJleHAiOjE3NTE1NTE1NjMsImlhdCI6MTc1MTUyMjc2M30.hQKsiAIL-TVZwRMhFg7ZoeOYwQfblInm6Ttugh3dgIk'''
 ,1
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 16:06:04.216 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''62e16687-a9c4-48f3-a1c6-9d5e8d9a2c30''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 16:06:04.232 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTIyNzYzLCJleHAiOjE3NTE1NTE1NjMsImlhdCI6MTc1MTUyMjc2M30.hQKsiAIL-TVZwRMhFg7ZoeOYwQfblInm6Ttugh3dgIk'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 07-03-2025 16:09:56.062 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.56] DEBUG | 07-03-2025 16:09:56.140 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 16:21:04.206 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''62e16687-a9c4-48f3-a1c6-9d5e8d9a2c30''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 16:21:04.222 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTIyNzYzLCJleHAiOjE3NTE1NTE1NjMsImlhdCI6MTc1MTUyMjc2M30.hQKsiAIL-TVZwRMhFg7ZoeOYwQfblInm6Ttugh3dgIk'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:29.301 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'd'
 ,1
 ,0
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:35.999 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:36.046 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.77'
 ,'192.168.1.77'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:50.534 | General Service|:: CompanyIndex:53 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.0.3'
 ,0
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:50.643 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,53
 ,'192.168.1.77'
 ,'192.168.1.77'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:50.643 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,53
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:50.643 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:50.659 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:50.690 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''6e37f0ee-e986-45a9-b49c-42d6cde57c12''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.77'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,53,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:50.690 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:50.721 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:50.721 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:50.753 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:50.753 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:51.034 | General Service|:: CompanyIndex:53 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:51.034 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:51.299 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:51.315 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:51.331 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:51.331 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:51.346 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:51.346 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:51.440 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:51.440 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:51.440 | General Service|:: CompanyIndex:53 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:51.471 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:51.534 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:51.549 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:51.706 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:51.706 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:51.752 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:51.768 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:51.862 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''03 Jul 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:51.862 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.081 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.081 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.408 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 1
 ,41
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.408 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.440 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.440 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.455 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.455 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.455 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.455 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.455 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.455 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.455 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.471 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.471 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.471 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.471 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.487 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.487 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.487 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.487 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.487 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.487 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.487 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.487 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.487 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.487 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.487 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.487 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.487 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.487 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.502 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.502 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.502 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.502 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.518 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.518 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.518 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.533 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.533 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.533 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.533 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.549 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.549 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.565 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.565 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.565 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.565 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.580 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.580 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.580 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.596 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.674 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:52.674 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.018 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.018 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.158 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.158 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.189 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.189 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.221 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.221 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.236 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.252 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.268 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.268 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.299 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.299 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.299 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.299 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.299 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.314 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.330 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.330 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.330 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.330 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.346 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.346 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.346 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.346 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.361 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.361 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.361 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.361 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.377 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.377 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.377 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.377 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.377 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.377 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.377 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.377 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.392 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.392 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.392 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.392 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.408 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.408 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.424 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.424 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.471 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:22:54.471 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:23:52.422 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:23:52.422 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 16:23:54.203 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 16:23:54.266 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 16:23:54.313 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 1
 ,'admin'
 ,0
 ,'192.168.1.54'
 ,'192.168.1.54'
 ,''
 ,'MobileWeb'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:24:52.191 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:24:52.191 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:25:52.184 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:25:52.184 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:26:52.195 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:26:52.210 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:27:51.214 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 07-03-2025 16:27:51.214 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:27:52.182 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:27:52.182 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:28:53.180 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:28:53.195 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:29:54.203 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:29:54.203 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:30:55.193 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:30:55.193 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:31:56.193 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:31:56.193 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:32:51.150 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 07-03-2025 16:32:51.150 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:32:57.184 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:32:57.200 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:33:58.181 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:33:58.197 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:34:59.188 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:34:59.188 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:36:00.189 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:36:00.204 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 16:36:04.212 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''62e16687-a9c4-48f3-a1c6-9d5e8d9a2c30''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 16:36:04.228 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTIyNzYzLCJleHAiOjE3NTE1NTE1NjMsImlhdCI6MTc1MTUyMjc2M30.hQKsiAIL-TVZwRMhFg7ZoeOYwQfblInm6Ttugh3dgIk'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:37:01.182 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:37:01.182 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:37:51.217 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''6e37f0ee-e986-45a9-b49c-42d6cde57c12''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.77] DEBUG | 07-03-2025 16:37:51.217 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 07-03-2025 16:37:51.217 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:37:51.233 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:38:02.352 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:38:02.352 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:39:03.203 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:39:03.203 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:40:04.185 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:40:04.201 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:41:05.200 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:41:05.200 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:42:06.193 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:42:06.209 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:42:51.156 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 07-03-2025 16:42:51.171 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:43:07.207 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:43:07.207 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:44:08.203 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:44:08.203 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:45:09.193 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:45:09.208 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:46:10.226 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:46:10.226 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:47:11.198 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:47:11.213 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:48:12.168 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 07-03-2025 16:48:12.168 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:48:12.215 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:48:12.230 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:49:13.204 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:49:13.204 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:50:14.193 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:50:14.193 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 16:51:04.186 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''62e16687-a9c4-48f3-a1c6-9d5e8d9a2c30''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 16:51:04.202 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzUxNTIyNzYzLCJleHAiOjE3NTE1NTE1NjMsImlhdCI6MTc1MTUyMjc2M30.hQKsiAIL-TVZwRMhFg7ZoeOYwQfblInm6Ttugh3dgIk'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:51:15.197 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:51:15.197 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:52:16.203 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:52:16.203 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:52:51.164 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''6e37f0ee-e986-45a9-b49c-42d6cde57c12''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.77] DEBUG | 07-03-2025 16:52:51.180 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:53:17.174 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 07-03-2025 16:53:17.174 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:53:17.221 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:53:17.236 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:54:18.208 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:54:18.208 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:55:19.196 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:55:19.212 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:56:20.211 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:56:20.211 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:57:21.216 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:57:21.216 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:58:22.184 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 07-03-2025 16:58:22.184 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:58:22.231 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:58:22.247 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.54] DEBUG | 07-03-2025 16:58:26.980 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.54] DEBUG | 07-03-2025 16:58:27.043 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.54'
 ,'192.168.1.54'
 ,''
 ,'MobileWeb'
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:59:23.211 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 16:59:23.211 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:00:24.212 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:00:24.212 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:01:25.221 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:01:25.221 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:02:26.219 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:02:26.219 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:03:27.187 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 07-03-2025 17:03:27.187 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:03:27.265 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:03:27.265 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:04:28.227 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:04:28.227 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:05:29.217 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:05:29.232 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:06:30.219 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:06:30.219 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:07:30.363 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:07:30.363 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:07:52.481 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''6e37f0ee-e986-45a9-b49c-42d6cde57c12''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.77] DEBUG | 07-03-2025 17:07:52.481 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:08:30.182 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 07-03-2025 17:08:30.182 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:08:30.245 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:08:30.245 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:09:30.216 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:09:30.232 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:10:30.664 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:10:31.070 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:11:30.230 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:11:30.230 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:12:30.225 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:12:30.225 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:13:30.182 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 07-03-2025 17:13:30.182 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:13:30.229 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:13:30.229 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:14:30.222 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:14:30.237 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:15:30.229 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:15:30.229 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:16:30.226 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:16:30.242 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:17:30.233 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:17:30.233 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:18:30.199 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 07-03-2025 17:18:30.199 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:18:30.261 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:18:30.261 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:19:30.236 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:19:30.236 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:20:30.240 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:20:30.240 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:21:30.240 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:21:30.240 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:22:30.237 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:22:30.237 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:22:51.299 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''6e37f0ee-e986-45a9-b49c-42d6cde57c12''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.77] DEBUG | 07-03-2025 17:22:51.315 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:23:30.203 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 07-03-2025 17:23:30.203 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:23:30.266 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:23:30.266 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:24:30.230 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:24:30.245 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:25:30.239 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:25:30.239 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:26:30.236 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:26:30.236 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:27:30.231 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:27:30.246 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:28:30.205 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 07-03-2025 17:28:30.205 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:28:30.267 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:28:30.267 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:29:30.246 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:29:30.246 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:30:30.252 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:30:30.252 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:31:30.243 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:31:30.243 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:32:30.238 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:32:30.254 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:33:30.211 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 07-03-2025 17:33:30.211 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:33:30.273 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:33:30.273 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:34:30.241 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:34:30.257 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:35:30.260 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:35:30.260 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:36:30.253 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:36:30.253 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:37:30.247 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:37:30.262 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:38:30.220 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 07-03-2025 17:38:30.235 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:38:30.298 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:38:30.298 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:38:30.345 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''6e37f0ee-e986-45a9-b49c-42d6cde57c12''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.77] DEBUG | 07-03-2025 17:38:30.360 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:39:30.248 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:39:30.263 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:40:30.279 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:40:30.279 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:41:30.258 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:41:30.258 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:42:30.250 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:42:30.266 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:43:30.222 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 07-03-2025 17:43:30.222 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:43:30.269 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:43:30.284 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:44:30.253 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:44:30.253 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:45:30.249 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:45:30.265 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:46:30.246 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:46:30.262 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:47:30.250 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:47:30.250 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:48:30.226 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 07-03-2025 17:48:30.226 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:48:30.288 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:48:30.288 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:49:30.270 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:49:30.270 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:50:30.260 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:50:30.275 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:51:30.255 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:51:30.271 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:52:30.251 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:52:30.267 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:53:30.244 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 07-03-2025 17:53:30.244 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:53:30.291 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:53:30.307 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:53:31.276 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''6e37f0ee-e986-45a9-b49c-42d6cde57c12''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.77] DEBUG | 07-03-2025 17:53:31.276 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:54:30.268 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:54:30.268 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:55:30.284 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:55:30.284 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:56:30.268 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:56:30.268 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:57:30.266 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:57:30.266 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:58:30.241 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 07-03-2025 17:58:30.241 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:58:30.289 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:58:30.304 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:59:30.266 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 17:59:30.282 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 18:00:30.277 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 18:00:30.277 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 18:01:30.271 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 18:01:30.271 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 18:02:30.279 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 18:02:30.279 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 18:03:30.231 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 07-03-2025 18:03:30.246 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 18:03:30.309 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 18:03:30.324 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 18:04:30.270 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 18:04:30.270 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 18:05:30.290 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 18:05:30.290 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 18:06:30.293 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 18:06:30.293 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 18:07:30.265 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 18:07:30.265 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 18:08:30.252 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 07-03-2025 18:08:30.252 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 18:08:30.252 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''6e37f0ee-e986-45a9-b49c-42d6cde57c12''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.77] DEBUG | 07-03-2025 18:08:30.252 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 18:08:30.346 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 07-03-2025 18:08:30.346 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1MTUzOTk3MCwiZXhwIjoxNzUxNTY4NzcwLCJpYXQiOjE3NTE1Mzk5NzB9.WvE4sMmojwLl6czp93OUl69ClMrnDBGsXZKlHoa4-Mg'''
 ,1
 ,1
